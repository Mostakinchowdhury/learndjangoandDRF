# Django + DRF ржлрзБрж▓ рж╣рзНржпрж╛ржирзНржб ржирзЛржб

ржЖржорж┐ ржкрзНрж░рзЛржЧрзНрж░рж╛ржорж┐ржВ рж╕ржмржЪрзЗрзЯрзЗ ржмрзЗрж╕рзНржЯ ржЙржкрж╛рзЯрзЗ рж╢рж┐ржЦрждрзЗ ржЪрж╛ржЗ ржЖрж░ ржХрзЛржиржХрж┐ржЫрзБ ржжрзАрж░рзНржШржжрж┐ржи ржзрж░рзЗ ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржЙржкрж╛рзЯ ржПржмржВ ржХрзЛржиржХрж┐ржЫрзБ
ржмрзЗрж╕рзНржЯ ржУрзЯрзЗрждрзЗ рж╢рзЗржЦрж╛рж░ ржкрзНрж░рж╕рзЗрж╕ рж╣рж▓рзЛ рж╕рзЗржЗ ржЯржкрж┐ржХ ржнрж╛рж▓рзЛ ржХрж░рзЗ ржкрзЬрж╛ рж╣рзНржпрж╛ржирзНржб ржирзЛржб ржХрж░рж╛ ржПржмржВ рждрж╛ ржмрзЗрж╢рж┐ ржмрзЗрж╢рж┐ ржХрж░рзЗ ржкрзНрж░рзНржпрж╛ржХрзНржЯрж┐рж╕
ржХрж░рж╛ред рждрж╛ржЗ ржЖржорж┐ django рж╢рж┐ржЦрждрзЗрж╕рж┐ ржПржмржВ рждрж╛ ржжрзАрж░рзНржШржжрж┐ржи ржзрж░рзЗ ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп рж╣рзНржпрж╛ржирзНржбржирзЛржЯ ржХрж░рж╕рж┐ ржпрж╛рждрзЗ ржнржмрж┐рзОрж╖рждрзЗ ржЖржорж┐
django ржПржмржВ DRF рж░рж┐ржнрж╛ржЗрж╕ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ред ржЖржорж┐ ржЖрж╢рж╛ ржХрж░рж╕рж┐ ржпржжрж┐ ржХрзЗржЙ django + DRF ржЬрж╛ржирзЗржи ржХрж┐ржирзНрждрзБ ржЕржирзЗржХржжрж┐ржи ржзрж░рзЗ
ржкрзНрж░рзНржпрж╛ржХрзНржЯрж┐рж╕рзЗ ржирж╛ ржХрж░рж╛рж░ ржХрж╛рж░ржгрзЗ ржЖржкржирж┐ ржЕржирзЗржХ ржХрж┐ржЫрзБ ржнрзБрж▓рзЗ ржпрж╛ржи рждрж╛рж╣рж▓рзЗ ржПржЗ рж╣рзНржпрж╛ржирзНржбржирзЛржЯ ржЯрж┐ ржкрж░рзЗ ржЖржкржирж┐ рж░рж┐ржнрж╛ржЗрж╕ ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи
ржПрж░ ржлрж▓ ржЖржкржирж╛рж░ ржЖржмрж╛рж░ рж╕ржмржХрж┐ржЫрзБ ржЖрзЯрждрзНрждрзЗ ржЖрж╕ржмрзЗ ржЗржирж╢рж╛ржЖрж▓рзНрж▓рж╛рж╣ред

## Authors

- [@Mostakin IBN Mohir Ali](https://github.com/Mostakinchowdhury)

## Day 1: Django Introduction & Setup

django рж╣рж▓рзЛ ржкрж╛ржЗржержи рж▓рзНржпрж╛ржВржЧрзБрзЯрзЗржЬ ржПрж░ ржлрзНрж░рзЗржоржУрзЯрж╛рж░рзНржХ ржпрж╛ ржжрж┐рзЯрзЗ ржЖржорж░рж╛ ржУрзЯрзЗржм ржПржкрзНрж▓рж┐ржХрзЗрж╢ржи ржПрж░ ржмрзНржпрж╛ржХржПржирзНржб ржирж┐рзЯрзЗ ржХрж╛ржЬ ржХрж░рждрзЗ
ржкрж╛рж░рж┐ред Django MVT ржкрзНржпрж╛ржЯрж╛рж░рзНржирзЗ ржХрж╛ржЬ ржХрж░рж╛ред M=Model ,v=view ржПржирзНржб T=template. ржЖржорж╛ржжрзЗрж░ржХрзЗ django ржХржоржкрзНрж▓рж┐ржЯ рж╕рзЗржЯржЖржк
ржХрж░рж╛рж░ ржЬржирзНржп ржХрж┐ржЫрзБ step ржлрж▓рзЛ ржХрж░рж╛рж░ рж▓рж╛ржЧржмрзЗ ржирж┐ржЪрзЗ рждрж╛ ржПржХ ржПржХ ржХрж░рзЗ ржХрж░рзЗ ржЖржорж┐ Explain ржХрж░ржЫрж┐ ред

#### Step 1

Django рж╕рзЗржЯржЖржк ржХрж░рж╛рж░ ржЬржирзНржп ржкрзНрж░ржержорзЗ ржЖржорж╛ржжрзЗрж░ ржПржХржЯрж╛ ржкрж╛ржЗржержи ржнрж╛рж░рзНржЪрзБрзЯрж╛рж▓ ржПржиржнрж╛рзЯрж░ржиржорзЗржирзНржЯ Make ржХрж░рждрзЗ рж╣ржмрзЗред ржнрж╛рж░рзНржЪрзБрзЯрж╛рж▓
ржПржиржнрж╛рзЯрж░ржиржорзЗржирзНржЯ make ржХрж░рж╛рж░ ржЬржирзНржп ржирж┐ржЪрзЗ ржХржорж╛ржирзНржб рждрж╛ cmd рждрзЗ run ржХрж░рждрзЗ рж╣ржмрзЗред

```bash
  python -m venv environment_name

```

- ржПржиржнрж╛рзЯрж░ржиржорзЗржирзНржЯ ржЯрж┐ржХрзЗ ржПржХржЯрж┐ржн ржХрж░рж╛рж░ ржЬржирзНржп ржирж┐ржЪрзЗ ржХржорж╛ржирзНржб рждрж╛ рж░рж╛ржи ржХрж░рждрзЗ рж╣ржмрзЗ

```bash
   environment_name\scripts\activate
```

#### Step 2

ржПржЗ step ржП ржЖржорж╛ржжрзЗрж░ django ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржб ржжрж┐рзЯрзЗ ржЗржирж╕рзНржЯрж▓ ржХрж░рзЗ ржирж┐рждрзЗ рж╣ржмрзЗред

```bash
  pip install django

```

- django relatate рж╕ржм subcomand ржжрзЗржЦрж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржб ржЯрж╛ рж░рж╛ржи ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржПржЗ ржХржорж╛ржирзНржб ржЯрж╛ рж░рж╛ржи ржХрж░рж▓рзЗ
  ржЖржорж╛ржжрзЗрж░ django relatate рж╕ржм sub command ржПрж░ ржПржХржЯрж╛ list ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЛ ржПржЗ ржХржорзНржпрж╛ржирзНржб ржЧрзБрж▓рж╛ ржжрж┐рзЯрзЗржЗ ржорзВрж▓ржд django
  ржПрж░ рж╕ржм ржХрж╛ржЬ ржХрж░рждрзЗ рж╣рзЯред

```bash
  django-admin

```

- output рж╣рж┐рж╕рж╛ржмрзЗ ржЯрж╛рж░рзНржорж┐ржирж╛рж▓ ржП ржПржЗ рж▓рж┐рж╕рзНржЯ ржЯрж╛ ржкрж╛ржмрзЛ

```bash
    check
    compilemessages
    createcachetable
    dbshell
    diffsettings
    dumpdata
    flush
    inspectdb
    loaddata
    makemessages
    makemigrations
    migrate
    optimizemigration
    runserver
    sendtestemail
    shell
    showmigrations
    sqlflush
    sqlmigrate
    sqlsequencereset
    squashmigrations
    startapp
    startproject
    test
    testserver
```

#### Step 3

ржПржмрж╛рж░ django ржжрж┐рзЯрзЗ ржЖржорж╛ржжрзЗрж░ ржПржХржЯрж╛ project make ржХрж░рждрзЗ рж╣ржмрзЗ ржпрзЗржЗ ржкрзНрж░ржЬрзЗржХрзНржЯ ржП ржЕржирзЗржХржЧрзБрж▓рж╛ ржПржк ржерж╛ржХржмрзЗред ржкрзНрж░ржЬрзЗржХрзНржЯ
ржмрж╛ржирж╛ржирзЛрж░ ржЬржирзНржп django ржПрж░ sub command ржерзЗржХрзЗ startproject ржХржорж╛ржирзНржб ржЯрж╛ рж░рж╛ржи ржХрж░рждрзЗ рж╣ржмрзЗред

```bash
  django-admin startproject project-folder-name

```

- project-folder-name ржирж╛ ржжрж┐рзЯрзЗ ржпржжрж┐ рж╢рзБржзрзБ ржПржХржЯрж╛ . (ржбржЯ) ржжрзЗрзЯ рждрж╛рж╣рж▓рзЗ ржкрзНрж░ржЬрзЗржХрзНржЯ ржПрж░ ржЬржирзНржп ржХрзЛржи ржлрзЛрж▓рзНржбрж╛рж░ ржХрзНрж░рж┐ржЯрзЗ ржирж╛
  рж╣рзЯрзЗ root ржлрзЛрж▓рзНржбрж╛рж░ ржПрж░ ржкрзНрж░ржЬрзЗржХрзНржЯ bundle ржбрж╛ржЙржирж▓рзЛржб рж╣ржмрзЗред

#### Step 3

рж▓рж╛рж╕рзНржЯ рж╕рзНржЯрзЗржк ржЯрж╛рждрзЗ ржЖржорж░рж╛ ржЖржорж╛ржжрзЗрж░ django ржПрж░ ржмрж┐рж▓рзНржб ржЗржи рж╕рж╛рж░рзНржнрж╛рж░ ржЯрж╛ржХрзЗ рж░рж╛ржи ржХрж░ржмрзЗ ржПрж░ ржЬржирзНржп ржЖржорж╛ржжрзЗрж░ ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржб ржЯрж╛
рж▓рж┐ржЦрждрзЗ рж╣ржмрзЗ ржХржорж╛ржирзНржб promt ржПред

- ржпржжрж┐ ржЖржорж░рж╛ . ржирж╛ ржжрж┐рзЯрзЗ ржирждрзБржи projects ржПрж░ ржЬржирзНржп ржлрзЛрж▓рзНржбрж╛рж░ Create ржХрж░рж┐ рждрж╛рж╣рж▓рзЗ ржЖржЧрзЗ рж╕рзЗржЗ ржлрзЛрж▓рзНржбрж╛рж░ ржП ржпрзЗрждрзЗ рж╣ржмрзЗ

```bash
   cd project-folder-name

```

- ржПрж░ржкрж░ ржЖржорж╛ржжрзЗрж░ рж╕рж╛рж░рзНржнрж╛рж░ рж░рж╛ржи ржХрж░рж╛рж░ ржЬржирзНржп ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржб рждрж╛ рж░рж╛ржи ржХрж░рждрзЗ рж╣ржмрзЗ ржЖрж░ ржпржжрж┐ . ржжрж┐рзЯрж╛ project create ржХрж░рж┐
  ржирждрзБржи ржлрзЛрж▓рзНржбрж╛рж░ ржирж╛ ржмрж╛ржирж╛ржЗ рждрж╛рж╣рж▓рзЗ ржЖржорж╛ржжрзЗрж░ cd ржХрж░рзЗ ржХрзЛржи ржлрзЛрж▓рзНржбрж╛рж░ ржП ржпрзЗрждрзЗ рж╣ржЗржмрзЗ ржирж╛ред

```bash
   python manage.py runserver

```

- Now you are create a blank django project successfully

## Startapp Basic view render

- App create ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж╛ржжрзЗрж░ ржирж┐ржЪрзЗрж░ ржХржорзНржпрж╛ржирзНржб ржЯрж╛ рж░рж╛ржи ржХрж░рждрзЗ рж╣ржмрзЗред

  ```bash
  python manage.py startapp app-name

  ```

- ржПрж░ржкрж░ project ржПрж░ ржорзЗржЗржи setting.py ржПрж░ ржнрж┐рждрж░ installed_apps ржП ржЧрж┐рзЯрзЗ apps ржЯрж╛ржХрзЗ add ржХрж░рзЗ ржжрж┐рждрзЗ рж╣ржмрзЗред

```python

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    "Your-app-name",
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]
```

- ржПрж░ржкрж░ main ржПрж░ urls.py рждрзЗ ржЧрж┐рзЯрзЗ ржПржк ржПрж░ urls.py ржХрзЗ include ржХрж░рждрзЗ рж╣ржмрзЗ

```python
from django.contrib import admin
from django.urls import path,include
urlpatterns = [
    path('admin/', admin.site.urls),
    path('',include("yourappname.urls"))
]

```

- ржПржЦржи ржЖржорж╛ржжрзЗрж░ ржПржк ржПрж░ urls.py ржП ржЧрж┐рзЯрзЗ app_name рж╕рзЗржЯ ржХрж░рждрзЗ рж╣ржмрзЗ ржПржмржВ рж╕рзЗржЗ рж╕рж╛ржерзЗ views.py ржП ржЧрж┐рзЯрзЗ ржнрж┐ржЙ create ржХрж░рждрзЗ
  рж╣ржмрзЗ рждрж╛ urls.py рждрзЗ urls mapping ржХрж░рзЗ ржкрж╛рже рж╕рзЗржЯ ржХрж░рзЗ ржжрж┐рждрзЗ рж╣ржмрзЗ

app/urls.py

```python
from django.urls import path
from . import views
app_name="home"
urlpatterns = [
    path('',views.viewname)
]
```

app/views.py

```python
from django.shortcuts import render

def viewname(request):
  return render(request,"appname/htmlfilename.html")
```

- ржПржЦржи ржЖржорж╛ржжрзЗрж░ simple ржЯрзЗржорзНржкрж▓рзЗржЯ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп рж▓рж╛рж╕рзНржЯ ржПржХржЯрж╛ рж╕рзНржЯрзЗржк рж░рзЯрзЗржЫрзЗ рждрж╛ рж╣рж▓рзЛ ржЯрзЗржорзНржкрж▓рзЗржЯрзЗ create ржХрж░рж╛ред
  ржЯрзЗржоржкрзНрж▓рзЗржЯ create ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж╛ржжрзЗрж░ app ржлрзЛрж▓рзНржбрж╛рж░ ржП template ржирж╛ржорзЗ ржПржХржЯрж╛ ржлрзЛрж▓рзНржбрж╛рж░ create ржХрж░рждрзЗ рж╣ржмрзЗ ржПржмржВ рж╕рзЗржЗ
  ржлрзЛрж▓рзНржбрж╛рж░ ржПрж░ ржнрж┐рждрж░ ржПржк ржПрж░ ржирж╛ржорзЗрж░ рж╕рж╛ржерзЗ ржорж┐рж▓ рж░рзЗржЦрзЗ ржЖрж░ ржУ ржПржХржЯрж╛ ржлрзЛрж▓рзНржбрж╛рж░ crete ржХрж░рждрзЗ рж╣ржмрзЗ finally рж╕рзЗржЗ ржлрзЛрж▓рзНржбрж╛рж░ ржП
  html ржлрж╛ржЗрж▓ ржмрж╛ template ржЧрзБрж▓рж╛ create ржХрж░рзЗ рж░рж╛ржЦрждрзЗ рж╣ржмрзЗред html ржлрж╛ржЗрж▓ ржПрж░ ржкрж╛рже ржЕржмрж╢рзНржпржЗ
  appname/templates/appname/htmlfilename.html рж╣ржмрзЗ

app/templates/appname/htmlfilename.html

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple django themplate</title>
  </head>
  <body>
    <h1>Hi i am new to django welcome to django</h1>
  </body>
</html>
```

[ Now You are succesfully compleate "Startapp Basic view render" topic by following 5 step]

## Day 2: Templates, Static Files & URL Routing

- Base Template ржУ Template Inheritance

- Static Files (CSS, JS, Images)

- url, name, {% url %} tag

#### <рзз> Base Template ржУ Template Inheritance :

ржЖржЧрзЗрж░ ржжрж┐ржирзЗ ржЖржорж░рж╛ ржкрзЬрзЗржЫрж┐ ржпрзЗ ржЯрзЗржорзНржкрж▓рзЗржЯ ржмрж╛ html ржлрж╛ржЗрж▓ ржПрж░ path ржЕржмрж╢рзНржпржЗ app/template/app-name/htmlfilename.html
рж╣рждрзЗржЗ рж╣ржмрзЗред рж╕рзЗржнрж╛ржмрзЗ ржЖржорж░рж╛ html file ржмрж╛ django template banate ржкрж╛рж░рж┐ред django рждрзЗ html ржлрж╛ржЗрж▓ ржЧрзБрж▓рж╛ ржЖржорж░рж╛
ржбрзНржпрж╛ржЩрзНржЧ ржЯрзЗржорзНржкрж▓рзЗржЯ рж╣рж┐рж╕рж╛ржмрзЗ craete ржХрж░рж┐ рждрж╛ ржЖржорж░рж╛ ржЬрж╛ржирж┐редdjango templat ржП ржЕржирзЗржХ ржХрж┐ржЫрзБ ржмрж┐рж▓рзНржб ржЗржи syntex ржерж╛ржХрзЗ ржпрж╛
ржмрзЗрж╕рж┐ржХ html ржП ржерж╛ржХрзЗ ржирж╛ рждрж╛рж░ moddhe ржПржХржЯрж╛ ржУрзЯрж╛ржи ржЕржл ржЯрж┐ ржмрзЗрж╕рзНржЯ рж╕рж┐ржирзНржЯрзЗржХрзНрж╕ рж╣ржЪрзНржЫрзЗ template ржЗржирж╣рзЗрж░рж┐ржЯ ржПржмржВ ржЯрзЗржорзНржкрж▓рзЗржЯ
include ржЯрзЗржорзНржкрж▓рзЗржЯ ржЗржирж╣рзЗрж░рж┐ржЯ рж╣рж▓рзЛ ржХрзНрж▓рж╛рж╕ ржЗржирж╣рзЗрж░рж┐ржЯ ржПрж░ ржорждрзЛ ржЬрзЗржХ ржЗржирж╣рзЗрж░рж┐ржЯ ржХрж░ржмрзЗ рждрж╛рж░ рж╕ржмржХрж┐ржЫрзБ ржУржЦрж╛ржирзЗ ржкрж╛ржмрзЛ + ржЖржорж░рж╛ ржирж┐ржЪрзЗ
ржерзЗржХрзЗ ржЖрж░рзЛ ржХрж┐ржЫрзБ ржПрж▓рж┐ржорзЗржирзНржЯ ржЯрзНржпрж╛ржЧ use ржХрж░ржмрзЛред {% extends %} ржорзВрж▓ржд parent template ржерзЗржХрзЗ structure/inheritance
ржирзЗрзЯред ржПржЯрж╛ ржмрж▓рзЗ: "ржЖржорж┐ ржПржЗ template-ржПрж░ ржнрж┐рждрж░ ржмрж╕рзЗ ржирж┐ржЬрзЗрж░ content ржжрзЗржЦрж╛ржмрзЛред"

ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм?

ржпржЦржи рждрзБржорж┐ ржПржХржЯрж┐ base layout ржмрж╛ржирж┐рзЯрзЗ ржмрж┐ржнрж┐ржирзНржи ржкрзЗржЗржЬрзЗ ржПржХржЗ header, footer, navbar ржЗрждрзНржпрж╛ржжрж┐ рж░рж╛ржЦрждрзЗ ржЪрж╛ржУред

extendbase.html

```html
<!DOCTYPE html>
<html>
  <head>
    <title>{% block title %}My Website{% endblock %}</title>
  </head>
  <body>
    <header>Navbar</header>

    {% block content %} {% endblock %}

    <footer>Copyright ┬й</footer>
  </body>
</html>
```

home.html

```html
{% extends "base.html" %} {% block title %}Home Page{% endblock %} {% block content %}
<h1>Welcome to Home Page</h1>
{% endblock %}
```

include рж╣рж▓рзЛ php ржПрж░ ржЗржиржХрзНрж▓рзБржб ржПрж░ ржорждрзЛ ржмрж╛ sass ржПрж░ import ржПрж░ ржорждрзЛ {% include %} ржжрж┐рзЯрзЗ ржЕржирзНржп ржПржХржЯрж┐ ржЫрзЛржЯ template
ржлрж╛ржЗрж▓ржХрзЗ ржмрж░рзНрждржорж╛ржи ржлрж╛ржЗрж▓рзЗ ржЯрзБржХрж░рж╛ ржЕржВрж╢ рж╣рж┐рж╕рзЗржмрзЗ ржмрж╕рж╛ржирзЛ рж╣рзЯредржпржЦржи рждрзБржорж┐ ржПржХржЯрзБржХрж░рзЛ ржХрзЛржб (ржпрзЗржоржи: navbar, sidebar,
product_card) ржПржХрж╛ржзрж┐ржХ ржлрж╛ржЗрж▓рзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржУред рждржЦржи include use ржХрж░ржмрзЛред

navbar.html

```html
<nav>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/about/">About</a></li>
  </ul>
</nav>
```

base.html

```html
<body>
  {% include "navbar.html" %} {% block content %}{% endblock %} {% include "footer.html" %}
</body>
```

include vs extend

| ржмрж┐рж╖рзЯ                       | `{% extends %}`                     | `{% include %}`                       |
| -------------------------- | ----------------------------------- | ------------------------------------- |
| ЁЯУЪ ржЙржжрзНржжрзЗрж╢рзНржп                | Template inherit (layout structure) | Template reuse (ржЫрзЛржЯ ржЕржВрж╢ ржЯрзБржХрж░рж╛)        |
| ЁЯПЧя╕П ржХрж╛ржЬ                     | base template ржерзЗржХрзЗ layout ржирзЗрзЯ       | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЕржВрж╢ ржЕржирзНржп template-ржП ржмрж╕рж╛рзЯ    |
| ЁЯУж ржмрзНржпржмрж╣рж╛рж░                 | page structure рждрзИрж░рж┐ ржХрж░рждрзЗ            | reusable section (navbar, card) ржмрж╕рж╛рждрзЗ |
| ЁЯУД base tag рж▓рж╛ржЧрзЗ           | рж╣рзНржпрж╛ржБ                               | ржирж╛                                    |
| ЁЯза Block system ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ | рж╣рзНржпрж╛ржБ (`{% block %}` ржжрж┐рзЯрзЗ)          | ржирж╛ (just ржмрж╕рж╛рзЯ)                        |

#### <рзи> Static Files (CSS, JS, Images)

Django-рждрзЗ Static Folder ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржорзВрж▓ ржХрж╛рж░ржгЁЯФ╣

тЬЕ Path ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ рж╕рж╣ржЬ ржУ ржирж┐рж░рж╛ржкржж рждрзБржорж┐ ржпржжрж┐ рж╕рж░рж╛рж╕рж░рж┐ ржПржоржи рж▓рж┐ржЦрзЛ:

```html
<link rel="stylesheet" href="css/style.css" />
```

рждрж╛рж╣рж▓рзЗ Django ржмрзБржЭржмрзЗржЗ ржирж╛ тАФ ржПржЗ ржлрж╛ржЗрж▓ ржХрзЛржерж╛рзЯ ржЖржЫрзЗред

ржХрж┐ржирзНрждрзБ рждрзБржорж┐ ржпржжрж┐ рж▓рж┐ржЦрзЛ:

```html
<link rel="stylesheet" href="{% static 'css/style.css' %}" />
```

Django ржирж┐ржЬрзЗржЗ ржмрзБржЭрзЗ ржпрж╛ржмрзЗ тАФ ржлрж╛ржЗрж▓ржЯрж╛ ржХрзЛржерж╛рзЯ ржЖржЫрзЗ, ржХрж┐ржнрж╛ржмрзЗ serve ржХрж░рждрзЗ рж╣ржмрзЗ, ржПржмржВ ржбрж┐ржкрзНрж▓рзЯржорзЗржирзНржЯрзЗ ржХрзАржнрж╛ржмрзЗ handle
ржХрж░рждрзЗ рж╣ржмрзЗред

тЬЕ ржбрж┐ржкрзНрж▓рзЯржорзЗржирзНржЯрзЗ ржХрж╛ржЬ ржХрж░рзЗ

рж╕рзЛржЬрж╛ ржХржерж╛рзЯ, Django production mode (live server) ржП рждрзЛржорж╛рж░ static file serve ржХрж░ржмрзЗ ржирж╛ ржпржжрж┐ рждрзБржорж┐
{% static %} ржмрзНржпржмрж╣рж╛рж░ ржирж╛ ржХрж░рзЛред

ржбрж┐ржкрзНрж▓рзЯржорзЗржирзНржЯрзЗ Django ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржб ржжрж┐рзЯрзЗ static ржлрж╛ржЗрж▓ ржПржХ ржЬрж╛рзЯржЧрж╛рзЯ ржирж┐рзЯрзЗ ржирзЗрзЯ:

```
python manage.py collectstatic
```

ржПржЯрж╛ рждржЦржи рж╕ржм static ржлрж╛ржЗрж▓ STATIC_ROOT ржП рж░рж╛ржЦрзЗ тАФ ржпрж╛рждрзЗ nginx/gunicorn serve ржХрж░рждрзЗ ржкрж╛рж░рзЗред

тЬЕ Multiple app ржПрж░ ржоржзрзНржпрзЗ ржлрж╛ржЗрж▓ conflict ржерзЗржХрзЗ рж░ржХрзНрж╖рж╛ ржХрж░рзЗ ржзрж░рзЛ рждрзЛржорж╛рж░ рзиржЯрж╛ app:

blog

shop

ржжрзБржЯрзЛрждрзЗржЗ style.css ржЖржЫрзЗред рждрзБржорж┐ ржпржжрж┐ static folder use ржирж╛ ржХрж░рзЛ, рждрж╛рж╣рж▓рзЗ ржХрзЛржиржЯрж╛ ржХрзЛржиржЯрж╛рж░ ржлрж╛ржЗрж▓ тАФ Django ржЬрж╛ржиржмрзЗ ржирж╛ред

ржХрж┐ржирзНрждрзБ рждрзБржорж┐ ржпржжрж┐ app-ржнрж┐рждрзНрждрж┐ржХ static рж░рж╛ржЦрзЛ: blog/static/blog/style.css shop/static/shop/style.css рждрж╛рж╣рж▓рзЗ
Django ржкрж░рж┐рж╖рзНржХрж╛рж░ ржмрзБржЭрждрзЗ ржкрж╛рж░ржмрзЗ ржХрзЛржиржЯрж╛ ржХрж╛рж░ред

blog рж╣рж▓рзЛ app ржЖрж░ ржПрж░ ржнрж┐рждрж░ static ржЯрж╛ рж╣рж▓рзЛ app static ржЖрж░ ржкрзНрж░ржЬрзЗржХрзНржЯ ржПрж░ ржнрж┐рждрж░ static ржЯрж╛ рж╣рж▓рзЛ project рж╕рзНржЯрзНржпрж╛ржЯрж┐ржХ
ржПржЯрж╛ ржЧрзНрж▓рзЛржмрж╛рж▓ whole app ржПрж░ ржЬржирзНржп ржХрж░ржмрзЗред

тЬЕ Django-рждрзЗ Static File ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржЬржирзНржп ржХрж░ржгрзАрзЯ ЁЯФ╢ Step 1: settings.py ржП Static ржПрж░ config

python settings.py

```
STATIC_URL = '/static/'
```

ржЙржирзНржиржд ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржЬржирзНржп (optional ржХрж┐ржирзНрждрзБ ржнрж╛рж▓рзЛ)

```
STATICFILES_DIRS = [
   BASE_DIR / "static",
]
```

ЁЯФ╢ Step 2: Project ржлрзЛрж▓рзНржбрж╛рж░рзЗ static/ ржирж╛ржорзЗрж░ ржлрзЛрж▓рзНржбрж╛рж░ ржмрж╛ржирж╛ржУ

```
your_project/
тФЬтФАтФА manage.py
тФЬтФАтФА your_app/
тФЬтФАтФА static/
тФВ   тФЬтФАтФА css/
тФВ   тФЬтФАтФА js/
тФВ   тФЬтФАтФА images/
```

ЁЯСЙ ржПржЗ ржлрзЛрж▓рзНржбрж╛рж░рзЗрж░ ржнрж┐рждрж░рзЗ CSS/JS/Image рж░рж╛ржЦрзЛ

ЁЯФ╢ Step 3: Template ржлрж╛ржЗрж▓рзЗрж░ рж╢рзБрж░рзБрждрзЗ {% load static %} ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ

```
{% load static %}
```

ЁЯФ╢ Step 4: Static Files рж▓рж┐ржВржХ ржХрж░рзЛ {% static %} ржЯрзНржпрж╛ржЧ ржжрж┐рзЯрзЗ тЬЕ CSS ржлрж╛ржЗрж▓:

```html
<link rel="stylesheet" href="{% static 'css/style.css' %}" />
```

тЬЕ JS ржлрж╛ржЗрж▓:

```html
<script src="{% static 'js/main.js' %}"></script>
```

тЬЕ Image ржлрж╛ржЗрж▓:

```html
<img src="{% static 'images/banner.jpg' %}" alt="Banner" />
```

ржлрзБрж▓ html

```html
{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <title>My Website</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
  </head>
  <body>
    <h1>Welcome</h1>
    <img src="{% static 'images/logo.png' %}" alt="Logo" />

    <script src="{% static 'js/app.js' %}"></script>
  </body>
</html>
```

structure

```
project/
тФЬтФАтФА static/
тФВ   тФФтФАтФА css/
тФВ       тФФтФАтФА global.css
тФЬтФАтФА blog/
тФВ   тФФтФАтФА static/
тФВ       тФФтФАтФА blog/
тФВ           тФФтФАтФА blog.css
```

blog/template/blog/htmlname.html

```html
{% load static %}
<link rel="stylesheet" href="{% static 'css/global.css' %}" />
<link rel="stylesheet" href="{% static 'blog/blog.css' %}" />
```

тЭЧ ржпржжрж┐ static ржХрж╛ржЬ ржирж╛ ржХрж░рзЗ:

тЬЕ рзз. settings.py ржП STATICFILES_DIRS ржЖржЫрзЗ ржХрж┐ржирж╛ ржжрзЗржЦрзЛ

тЬЕ рзи. template ржлрж╛ржЗрж▓рзЗ {% load static %} ржжрзЗрзЯрж╛ рж╣рзЯрзЗржЫрзЗ ржХрж┐ржирж╛

тЬЕ рзй. ржлрж╛ржЗрж▓ path ржнрзБрж▓ ржЖржЫрзЗ ржХрж┐ржирж╛ (рж╕ржм ржЫрзЛржЯ рж╣рж╛рждрзЗрж░ рж╣рж▓рзЗ ржнрж╛рж▓рзЛ рж╣рзЯ)

тЬЕ рзк. Django server ржЪрж╛рж▓рзБ ржЖржЫрзЗ ржХрж┐ржирж╛ python manage.py runserver

#### Some FAQ FOR STATIC FOLDER

| ржкрзНрж░рж╢рзНржи                          | ржЙрждрзНрждрж░                                                        |
| ------------------------------- | ------------------------------------------------------------ |
| Static folder ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ? | Django static file serve ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржУ ржбрж┐ржкрзНрж▓рзЯржорзЗржирзНржЯрзЗ рж╕ржВржЧрзНрж░рж╣ ржХрж░рзЗ |
| рж╕рж░рж╛рж╕рж░рж┐ path ржжрж┐рж▓рзЗржЗ рж╣рзЯ ржирж╛?        | рж╣рзЯ ржирж╛ тАФ Django serve ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛                           |
| ржХржЦржи app-static рж░рж╛ржЦржмрзЛ?           | ржпржЦржи file рж╢рзБржзрзБржорж╛рждрзНрж░ ржУржЗ app ржПрж░ ржоржзрзНржпрзЗ ржмрзНржпржмрж╣рзГржд                   |
| ржХржЦржи project-static рж░рж╛ржЦржмрзЛ?       | ржпржЦржи file global/base layout ржП ржмрзНржпржмрж╣рзГржд рж╣рзЯ                     |
| Static file auto serve рж╣рзЯ ржХржЦржи?  | development mode ржП, debug=True рж╣рж▓рзЗ                           |

                        |

### <рзй> url, name, {% url %} tag

ЁЯза рзз. url ржХрж┐? url ржЕрж░рзНрже рж╣ржЪрзНржЫрзЗ тАФ Django-ржПрж░ рж░рж╛ржЙржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржоред ржПржЗ рж░рж╛ржЙржЯ ржжрж┐рзЯрзЗ Django ржмрзЛржЭрзЗ ржХрзЛржи view ржлрж╛ржВрж╢ржи ржХрзЛржи
path ржмрж╛ address ржП ржЪрж▓ржмрзЗред

ЁЯза рзи. name ржХрж┐? Django-рждрзЗ url pattern-ржП name ржжрж┐рж▓рзЗ рждрзБржорж┐ ржР URL ржЯрж╛ ржЯрзЗржоржкрзНрж▓рзЗржЯ, рж░рж┐ржбрж╛ржЗрж░рзЗржХрзНржЯ ржмрж╛ рж░рж┐ржнрж╛рж░рзНрж╕ ржХрж░рж╛рж░
рж╕ржорзЯ ржирж╛ржо ржжрж┐рзЯрзЗ access ржХрж░рждрзЗ ржкрж╛рж░рзЛред

ЁЯСЙ рж╕рж╣ржЬржнрж╛ржмрзЗ ржмрж▓рж▓рзЗ: name рж╣рж▓рзЛ url ржПрж░ nickname ржпрзЗржЯрж╛ ржжрж┐рзЯрзЗ {% url %} ржЯрзНржпрж╛ржЧ, reverse(), redirect() ржЗрждрзНржпрж╛ржжрж┐рждрзЗ
ржХрж╛ржЬ ржХрж░рж╛ ржпрж╛рзЯред

ЁЯФЦ рзй. {% url %} template tag ЁЯСЙ ржЯрзЗржоржкрзНрж▓рзЗржЯрзЗрж░ ржнрзЗрждрж░рзЗ href ржмрж╛ рж▓рж┐ржВржХрзЗрж░ ржнрж┐рждрж░рзЗ name ржжрж┐рзЯрзЗ URL generate ржХрж░рждрзЗ
ржмрзНржпржмрж╣рзГржд рж╣рзЯред

```
{% url 'url_name' %}
```

тЬЕ step рзз

```python
# myapp/urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('', views.home, name='home'),
    path('about/', views.about, name='about_page'),
    path('contact/<int:id>/', views.contact, name='contact_page'),
]
```

тЬЕ step рзи

```python
# myapp/views.py

from django.http import HttpResponse

def home(request):
    return HttpResponse("This is Home Page")

def about(request):
    return HttpResponse("About Page")

def contact(request, id):
    return HttpResponse(f"Contact Page of ID: {id}")
```

тЬЕ step рзй Template file (HTML)

```html
{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <title>Navigation</title>
  </head>
  <body>
    <!-- Static URL (not recommended) -->
    <a href="/about/">About</a>

    <!-- Dynamic URL (recommended) -->
    <a href="{% url 'about_page' %}">About</a>

    <!-- URL with dynamic parameter -->
    <a href="{% url 'contact_page' 5 %}">Contact ID 5</a>
  </body>
</html>
```

ЁЯУЭ Syntax:

| ржХрж╛ржЬ                | Syntax                                             |
| ------------------ | -------------------------------------------------- |
| рж╕рж┐ржорзНржкрж▓ URL         | `{% url 'name' %}`                                 |
| ржнрзЗрж░рж┐рзЯрзЗржмрж▓ рж╕рж╣        | `{% url 'name' variable %}`                        |
| ржПржХрж╛ржзрж┐ржХ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ | `{% url 'name' param1 param2 %}`                   |
| with keyword args  | `{% url 'name' id=5 %}` _(if view accepts kwargs)_ |

тЬЕ ржХрзЗржи {% url %} ржЯрзНржпрж╛ржЧ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм?

| ржХрж╛рж░ржг               | ржмрзНржпрж╛ржЦрзНржпрж╛                                       |
| ------------------ | ---------------------------------------------- |
| тЬЕ Maintainability | URL path ржмржжрж▓ рж╣рж▓рзЗржУ template ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣рзЯ ржирж╛ |
| тЬЕ DRY Principle   | ржПржХ ржЬрж╛рзЯржЧрж╛рзЯ ржирж╛ржо ржжрж┐рж▓рзЗ рж╕ржм ржЬрж╛рзЯржЧрж╛рзЯ ржХрж╛ржЬ рж╣рзЯ            |
| тЬЕ Error free      | Hardcoded path рж▓рж┐ржЦрж▓рзЗ ржнрзБрж▓ рж╣ржУрзЯрж╛рж░ рж╕ржорзНржнрж╛ржмржирж╛ ржмрзЗрж╢рж┐   |
| тЬЕ Dynamic Routing | ID / slug / username ржЗрждрзНржпрж╛ржжрж┐ рж╕рж╣ржЬрзЗ ржмрж╕рж╛ржирзЛ ржпрж╛рзЯ    |

ЁЯзк ржЙржжрж╛рж╣рж░ржг (Dynamic Routing)

```python

# urls.py
path('user/<int:id>/', views.user_profile, name='user_profile')
#views.py:
def user_profile(request, id):
    return HttpResponse(f"User ID: {id}")
```

```html
<!-- template.html: -->
<a href="{% url 'user_profile' 42 %}">User 42</a>
```

ЁЯФБ View ржерзЗржХрзЗ URL reverse ржХрж░рж╛рж░ ржЬржирзНржп:

```python
from django.urls import reverse
reverse('user_profile', args=[42])
```

тЬЕ Shortcut: redirect('name', args=[id])

```python
from django.shortcuts import redirect
return redirect('user_profile', id=5)
```

Common mistake

| ржнрзБрж▓                                  | ржХрж╛рж░ржг                                             |
| ------------------------------------ | ------------------------------------------------ |
| `{% url home %}` тЖТ тЭМ                | ржХрзЛржЯрзЗрж╢ржи ржЫрж╛рзЬрж╛ рж▓рзЗржЦрж╛ ржпрж╛ржмрзЗ ржирж╛                         |
| `{% url 'contact_page' %}` тЖТ тЬЕ      | Always use quotes                                |
| `{% url 'contact_page' id=5 %}` тЖТ тЬЕ | keyword argument ржжрж┐рж▓рзЗ ржЕржмрж╢рзНржпржЗ ржирж╛ржо ржУ ржорж╛ржи рж▓рж┐ржЦрждрзЗ рж╣ржмрзЗ |

ржлрж╛ржЗржирж╛рж▓ рж░рж┐ржнрж┐рж╢ржи

```python
URL Pattern:
path('route/', views.function, name='route_name')

Template Usage:
{% url 'route_name' %} тЖТ for simple URL
{% url 'route_name' id %} тЖТ for dynamic URL

```

Bonus Tip: include() + name-spacing or app_name

```python
# project/urls.py
from . import views
app_name="home"
urlpatterns = [
    path('blog/', include('blog.urls', namespace='blog')),
    path('blog/',views.navbar,name="nav"),
]

```

```html
{% url 'blog:post_detail' 1 %} {% url 'home:nav'%}
```

## тЬЕ Day 3: Models & Admin Panel

1.models.Model ржжрж┐рзЯрзЗ DB Table рждрзИрж░рж┐

2.makemigrations, migrate

3.Django Admin setup

4.Admin ржерзЗржХрзЗ ржбрж╛ржЯрж╛ Insert/Update/Delete

$ ржирж┐ржЪрзЗрж░ ржПржЗ рзл ржЯрж┐ step ржлрж▓рзЛ ржХрж░рж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржорж░рж╛ ржПржЗ рзк ржЯрж┐ ржЯржкрж┐ржХ ржЖрзЯрждрзНржд ржХрж░рждрзЗ ржкрж╛рж░ржмрзЛ ред ржПржЦрж╛ржирзЗ ржкрзНрж░рждрж┐ржЯрж╛ рж╕рзНржЯрзЗржк ржЦрзБржм
рж╕рзБржирзНржжрж░ ржХрж░рзЗ explain ржХрж░рж╛ рж╣рж▓рзЛред

ЁЯУМ Step 1: models.py ржлрж╛ржЗрж▓рзЗ Table (Model) Define ржХрж░рзБржи ЁЯСЙ myapp/models.py ржлрж╛ржЗрж▓рзЗ ржПржХржЯрж┐ ржХрзНрж▓рж╛рж╕ рждрзИрж░рж┐ ржХрж░рзБржи
ржпрзЗржЯрж╛ models.Model ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ ржХрж░рзЗ:

from django.db import models

```python
class Student(models.Model):
    name = models.CharField(max_length=100)
    age = models.IntegerField()
    email = models.EmailField(unique=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.name
```

| рж▓рж╛ржЗржи                          | ржмрзНржпрж╛ржЦрзНржпрж╛                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ----------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `class Student(models.Model)` | Student ржирж╛ржорзЗ ржЯрзЗржмрж┐рж▓ рж╣ржмрзЗ (ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ `myapp_student`)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `CharField`                   | рж╕рзНржЯрзНрж░рж┐ржВ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп (ржорзНржпрж╛ржХрзНрж╕ рж▓рзЗржирзНрже ржжрж┐рждрзЗ рж╣рзЯ)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `IntegerField`                | рж╕ржВржЦрзНржпрж╛ рж░рж╛ржЦрзЗ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `EmailField`                  | ржЗржорзЗржЗрж▓ ржлрж┐рж▓рзНржб, рж╕рж╛ржерзЗ unique=true ржорж╛ржирзЗ ржПржХржЗ ржЗржорзЗржЗрж▓ рзи ржмрж╛рж░ рж░рж╛ржЦрж╛ ржпрж╛ржмрзЗ ржирж╛                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `auto_now_add=True`           | ржПржХржмрж╛рж░ object рждрзИрж░рж┐ рж╣рж▓рзЗ ржЕржЯрзЛржорзЗржЯрж┐ржХ рж╕ржорзЯ ржпрзЛржЧ рж╣ржмрзЗ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `__str__()`                   | ржЕрзНржпрж╛ржбржорж┐ржи ржмрж╛ ржЯрзЗржоржкрзНрж▓рзЗржЯрзЗ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ ржирж╛ржоредржпржЦржи ржЖржорж░рж╛ sql ржП group by ржПржЯрж╛ ржжрж┐рзЯрж╛ ржЯрзЗржмрж┐рж▓ ржХрзЗ ржХрзЛржи colum ржПрж░ ржнрж┐рждрзНрждрж┐рждрзЗ group ржХрж░рж┐ рждржЦржи ржПржХрж╛ржзрж┐ржХ raw ржмрж╛ table ржЕржмржЬрзЗржХрзНржЯ ржПржХржЯрж╛ ржЕржмржЬрзЗржХрзНржЯ raw ржП ржХржиржнрж╛рж░рзНржЯ рж╣рзЯред рждржЦржи ржУржЗ merge raw te ржХрж┐ржирзНрждрзБ ржЖржорж░рж╛ ржкрзНрж░рждрж┐ржЯрж╛ mergekrito ржХрж▓рж╛ржо ржХрзЗ рж╣рж╛ржЗрж▓рж╛ржЗржЯ ржХрж░рж╛рж░ ржЬржирзНржп count(colum),max (colum ),average (colum) asb use ржХрж░рж┐ Jen ржПржХржЯрж╛ ржнрзНржпрж╛рж▓рзБ ржжрж┐рзЯрж╛ ржкрзБрж░рж╛ ржорж╛рж░рзНржЬ рж╣рзЯ ржХрж╛рж▓рж╛ржо рж╣рж╛ржЗрж▓рж╛ржЗржЯ рж╣рзЯ . рждрзЗржоржирж┐ ржпржЦржи ржПржХржЯрж╛ raw ржмрж╛ ржЕржмржЬрзЗржХрзНржЯ ржХрзЗ ржЖржорж░рж╛ mean ржХрж░рж┐ django рждрзЗ tokhon ржУржЗ ржЕржмржЬрзЗржХрзНржЯ ржПрж░ рж╕ржм ржХрж╛рж▓рж╛ржо ржПрж░ ржирж╛ржо рждрзЛ ржмрж▓рж╛ рж╕ржорзНржнржм рж╣рзЯ ржирж╛ ржУржЗ ржкрзБрж░рж╛ ржЕржмржЬрзЗржХрзНржЯ рждрж╛ржХрзЗ ржПржХржЯрж╛ colum ржжрж┐рзЯрж╛ ржорж┐ржи ржХрж░рждрзЗ рж╣рзЯ рж╕рзЛ ржУржЗ ржЯрзЗржмрж┐рж▓ ржЯрж╛ ржХрзЗ ржХрзЛржи colum ржПрж░ ржнрзНржпрж╛рж▓рзБ ржжрж┐рзЯрж╛ рж╣рж╛ржЗрж▓рж╛ржЗржЯ ржХрж░ржмрзЛ рждрж╛ ржПржЗ **str** ржбрж╛ржирзНржбрж╛рж░ ржорзЗржержб ржП рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рждрзЗ рж╣рзЯред |

#### ЁЯУМ Step 2: Model Change ржПрж░ ржкрж░ makemigrations ржЪрж╛рж▓рж╛ржи

```bash
python manage.py makemigrations
```

ЁЯФ╣ ржХрж╛рж░ржг: ржПржЯрж╛ Django ржХрзЗ ржмрж▓рзЗ, тАЬржЖржорж╛рж░ ржоржбрзЗрж▓рзЗ ржкрж░рж┐ржмрж░рзНрждржи ржПрж╕рзЗржЫрзЗ, ржПржЧрзБрж▓рзЛрж░ ржЬржирзНржп ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржлрж╛ржЗрж▓ ржмрж╛ржирж╛ржУредтАЭ

#### ЁЯУМ Step 3: ржбрзЗржЯрж╛ржмрзЗржЬрзЗ ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐рж░ ржЬржирзНржп migrate ржЪрж╛рж▓рж╛ржи

```bash
python manage.py migrate
```

ЁЯФ╣ ржХрж╛рж░ржг: ржПржЯрж╛ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржлрж╛ржЗрж▓ ржжрзЗржЦрзЗ ржЖрж╕рж▓ ржбрзЗржЯрж╛ржмрзЗржЗрж╕рзЗ ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ ржХрж░рзЗред database ржХрзЗ migrate ржорж╛ржирзЗ ржЖржкржЧрзНрж░рзЗржб ржХрж░рзЗред

#### ЁЯУМ Step 4: Admin Panel-ржП ржжрзЗржЦрждрзЗ ржЪрж╛ржЗрж▓рзЗ, Admin-ржП рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░ ржХрж░рзБржи

ЁЯСЙ myapp/admin.py:

```python
from django.contrib import admin
from .models import Student

admin.site.register(Student)

```

ЁЯФ╣ ржХрж╛рж░ржг: ржПржЯрж╛ ржХрж░рж▓рзЗ Django Admin panel-ржП Student ржоржбрзЗрж▓ржЯрж┐ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржи ржПржмржВ Create/Update ржорж╛ржирзЗ CRUD
ржЕржкрж╛рж░рзЗрж╢ржи ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░ржмрзЗржи django ржЕрзНржпрж╛ржбржорж┐ржи ржПрж░ ржорж╛ржзрзНржпржорзЗред

ЁЯУМ Step 5: рж╕рзБржкрж╛рж░ ржЗржЙржЬрж╛рж░ рждрзИрж░рж┐ ржХрж░рзБржи (admin panel ржЪрж╛рж▓рж╛ржирзЛрж░ ржЬржирзНржп)

```bash
python manage.py createsuperuser
```

ЁЯСЙ рждрж╛рж░ржкрж░ рж▓ржЧржЗржи ржХрж░рзБржи:

```arduino
http://127.0.0.1:8000/admin
```

ЁЯФ╣ ржХрж╛рж░ржг: Admin Panel ржЪрж╛рж▓рж╛рждрзЗ ржПржХржЬржи superuser рж▓рж╛ржЧрзЗредржЖрж░ ржПржнрж╛ржмрзЗ ржПржХржЬржи ржЕрзНржпрж╛ржбржорж┐ржи ржорж╛ржирзЗ super ржЗржЙрж╕рж╛рж░ create ржХрж░рждрзЗ
рж╣рзЯ ржпрзЗ ржХрж┐ржирж╛ ржкрзБрж░рж╛ ржУрзЯрзЗржм app ржЯрж╛ ржХржирзНржЯрзНрж░рзЛрж▓ ржХрж░ржмрзЗред ржПржЗ app ржПрж░ ржХрждрзГржкржХрзНрж╖ред

#### ЁЯза Django Admin Registration with modeladmin(custom configaretion)

ЁЯСЙ ржжрзБржЗржнрж╛ржмрзЗ Model Admin рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░ ржХрж░рж╛ ржпрж╛рзЯ:

##### ЁЯФ╖ рзз. admin.site.register() тАУ ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ? (Traditional way)

```python
from django.contrib import admin
from .models import Product

class ProductAdmin(admin.ModelAdmin):
    pass

admin.site.register(Product, ProductAdmin)
#admin.site.register(model, modeladmin=None)
```

тЮд Required ржУ Optional Part:

| Argument     | ржкрзНрж░рзЯрзЛржЬржирзАрзЯ?  | ржмрзНржпрж╛ржЦрзНржпрж╛                                                                                       |
| ------------ | ----------- | ---------------------------------------------------------------------------------------------- |
| `model`      | тЬЕ Required | ржХрзЛржи Model ржЯрж╛ржХрзЗ admin ржкрзНржпрж╛ржирзЗрж▓рзЗ рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░ ржХрж░ржЫрзЛ                                                   |
| `modeladmin` | тЭМ Optional | ржУржЗ ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп ржХрж╛рж╕рзНржЯржо `ModelAdmin` ржХрзНрж▓рж╛рж╕ ржжрж┐рж▓рзЗ ржПржЯрж╛ ржжрж┐рждрзЗ рж╣рзЯ, ржирж╛ ржжрж┐рж▓рзЗ default settings ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ |

тЮд ржХрж╛ржЬрзЗрж░ ржзрж░ржи: Django ржПрж░ Admin ржкрзНржпрж╛ржирзЗрж▓рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржПржХржЯрж╛ Model ржпрзБржХрзНржд ржХрж░рзЗред

ржпржжрж┐ modeladmin ржирж╛ ржжрж╛ржУ, рждрж╛рж╣рж▓рзЗ Django ModelAdmin ржПрж░ default behavior ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

ЁЯФ╖ рзи. @admin.register(Model) тАУ ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

```python
@admin.register(Model)
class MyModelAdmin(admin.ModelAdmin):
    ...
```

тЮд ржХрж╛ржЬрзЗрж░ ржзрж░ржи:

- ржПржЯрж┐ ржорзВрж▓ржд admin.site.register() ржПрж░ рж╢рж░рзНржЯржХрж╛ржЯред

- ржбрзЗржХрзЛрж░рзЗржЯрж░ рж╣рж┐рж╕рзЗржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ, ржоржбрзЗрж▓ ржПржмржВ ModelAdmin ржХрзНрж▓рж╛рж╕ржХрзЗ ржПржХрждрзНрж░ ржХрж░рзЗред admin.register(model) ржПржХржЯрж╛
  ржбрзЗржХрзЛрж░рзЗржЯрж░ function рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ рж╕рзЗржЗ decorator ржлрж╛ржЩрзНржХрж╢ржи ржЖржмрж╛рж░ modeladmin paramitar рж╣рж┐рж╕рж╛ржмрзЗ ржирзЗрзЯ ржПржмржВ ржУржЗ
  ржоржбрзЗрж▓ ржЕрзНржпрж╛ржбржорж┐ржи class ржЕржирзБржпрж╛рзЯрзА ржУржЗ ржоржбрзЗрж▓ ржПрж░ ржЬржирзНржп ржЕрзНржпрж╛ржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓ ржП ржХрж╛рж╕рзНржЯржо ржнрж┐ржЙ configer ржХрж░рзЗред

cleaner, DRY (Don't Repeat Yourself) style.

тЮд Example:

```python
from django.contrib import admin
from .models import Product

@admin.register(Product)
class ProductAdmin(admin.ModelAdmin):
    list_display = ('name', 'price')
```

тЬЕ ржПржЯрж╛ржУ admin.site.register(Product, ProductAdmin) ржПрж░ ржорждрзЛржЗ ржХрж╛ржЬ ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ ржПржХрж╕рж╛ржерзЗ рж▓рж┐ржЦрзЗ ржлрзЗрж▓рж╛ ржпрж╛рзЯред

ЁЯФБ admin.site.register() vs @admin.register() тАУ рждрзБрж▓ржирж╛: | ржмрж┐рж╖рзЯ | `admin.site.register()` |
`@admin.register()` | | ----------- | --------------------------------- |
---------------------------- | | ржкржжрзНржзрждрж┐ | Function call | Decorator | | ржХрзЛржбрзЗрж░ ржзрж░ржи | ржЖрж▓рж╛ржжрж╛ ржЖрж▓рж╛ржжрж╛
ржХрзНрж▓рж╛рж╕ ржУ рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рзЗрж╢ржи | ржПржХржЗ ржЬрж╛рзЯржЧрж╛рзЯ рж╕ржм | | ржкрж░рж┐ржЪрзНржЫржирзНржирждрж╛ | ржПржХржЯрзБ рж▓ржорзНржмрж╛ рж╣рзЯ | Clean & Compact | | ржкрзНрж░рзЯрзЛржЬржи |
ржпржЦржи dynamic ржнрж╛ржмрзЗ register ржХрж░рждрзЗ рж╣рзЯ | ржпржЦржи statically register ржХрж░ржЫрзЛ |

ЁЯЯй Suggestion:

ржпржжрж┐ ржЕржирзЗржХржЧрзБрж▓рзЛ ржоржбрзЗрж▓ ржПржХрж╕рж╛ржерзЗ рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░ ржХрж░рждрзЗ рж╣рзЯ ржмрж╛ ржЖрж▓рж╛ржжрж╛ ржЖрж▓рж╛ржжрж╛ ModelAdmin ржХрзНрж▓рж╛рж╕ рж▓рж╛ржЧржмрзЗ, рждрж╛рж╣рж▓рзЗ
admin.site.register() ржнрж╛рж▓рзЛред ржпржжрж┐ ржПржХржЯрж┐ ржоржбрзЗрж▓ ржУ ржПржХржЯрж┐ ModelAdmin рж╣рзЯ, рждрж╛рж╣рж▓рзЗ @admin.register() ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред

ЁЯзй ModelAdmin ржХрзНрж▓рж╛рж╕ ржХрзА ржХрж░рзЗ? ModelAdmin рж╣рж▓ Django Admin panel-ржПрж░ ржЬржирзНржп ржХрж╛рж╕рзНржЯржорж╛ржЗржЬрзЗрж╢ржи ржХрзНрж▓рж╛рж╕ред ржПржЯрж╛ ржжрж┐рзЯрзЗржЗ
рждрзБржорж┐ Admin interface ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рзЛред

ЁЯОп ржХрж╛ржЬрзЗрж░ рждрж╛рж▓рж┐ржХрж╛:

| Attribute                                 | ржХрж╛ржЬ                                   |
| ----------------------------------------- | ------------------------------------- |
| `list_display`                            | рж▓рж┐рж╕рзНржЯ ржкрзЗржЗржЬрзЗ ржлрж┐рж▓рзНржб ржжрзЗржЦрж╛рзЯ               |
| `list_display_links`                      | ржХрзЛржи ржлрж┐рж▓рзНржбрзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ edit ржкрзЗржЗржЬрзЗ ржпрж╛ржмрзЗ |
| `readonly_fields`                         | рж╢рзБржзрзБ ржжрзЗржЦрж╛ржмрзЗ, edit ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛         |
| `search_fields`                           | рж╕рж╛рж░рзНржЪржмрж╛рж░рзЗ ржХрзЛржи ржлрж┐рж▓рзНржб ржжрж┐рзЯрзЗ ржЦрзБржБржЬржмрзЗ       |
| `list_filter`                             | рж╕рж╛ржЗржбржмрж╛рж░рзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржЕржкрж╢ржи                 |
| `ordering`                                | ржХрзЛржи ржХрзНрж░ржорзЗ ржжрзЗржЦрж╛ржмрзЗ (ASC/DESC)           |
| `admin.site.register(model, admin_class)` | ржХрзНрж▓рж╛рж╕рж┐ржХ ржкржжрзНржзрждрж┐                        |
| `@admin.register(model)`                  | ржбрзЗржХрзЛрж░рзЗржЯрж░ ржкржжрзНржзрждрж┐ (cleaner)             |

ржЙржжрж╛рж╣рж░ржг:

```python
@admin.register(Product)
class ProductAdmin(admin.ModelAdmin):
    list_display = ('name', 'price', 'created_at', 'updated_at')
    list_display_links = ('name',)
    readonly_fields = ('created_at', 'updated_at')
    search_fields = ('name', 'description')
    list_filter = ('created_at',)
    ordering = ('-created_at',)
```

ЁЯТб ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржХрзМрж╢рж▓ (Shortcut Summary)

```pgsql
admin.site.register(Model, AdminClass)
тЮбя╕П рж╕рж╛ржзрж╛рж░ржг ржкржжрзНржзрждрж┐, ржмрзЬ ржкрзНрж░ржЬрзЗржХрзНржЯрзЗ ржмрзЗрж╢рж┐ ржжрж░ржХрж╛рж░ рж╣рзЯ

@admin.register(Model)
тЮбя╕П рж╢рж░рзНржЯржХрж╛ржЯ ржбрзЗржХрзЛрж░рзЗржЯрж░, ржЫрзЛржЯ ржХрзЛржбрзЗ clean рж▓рзЗржЦрж╛ ржпрж╛рзЯ

ModelAdmin
тЮбя╕П admin panel ржП ржХрж╛рж╕рзНржЯржорж╛ржЗржЬрзЗрж╢ржи ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ

ModelAdmin ржП ржпрзЗржЧрзБрж▓рзЛ ржоржирзЗ рж░рж╛ржЦржм:
тЬЕ list_display       тЖТ ржХрзЛржи ржлрж┐рж▓рзНржб рж▓рж┐рж╕рзНржЯрзЗ ржжрзЗржЦрж╛ржмрзЛ
тЬЕ list_display_links тЖТ ржХрзЛржиржЯрж╛ ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ edit e ржпрж╛ржмрзЗ
тЬЕ readonly_fields    тЖТ ржХрзЛржиржЯрж╛ edit ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛
тЬЕ search_fields      тЖТ ржХрзЛржи ржлрж┐рж▓рзНржб ржжрж┐рзЯрзЗ рж╕рж╛рж░рзНржЪ рж╣ржмрзЗ
тЬЕ list_filter        тЖТ ржХрзЛржи ржлрж┐рж▓рзНржбрзЗ ржлрж┐рж▓рзНржЯрж╛рж░
тЬЕ ordering           тЖТ ржХрзЛржи ржлрж┐рж▓рзНржбрзЗ рж╕рж╛ржЬрж╛ржмрзЗ
```

тЬЕ ржЕрждрж┐рж░рж┐ржХрзНржд ржХрж┐ржЫрзБ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржоржбрзЗрж▓ ржлрж┐рж▓рзНржб ржУ рждрж╛ржжрзЗрж░ ржХрж╛ржЬ:

| Field                              | ржХрж╛ржЬ                  |
| ---------------------------------- | -------------------- |
| `CharField(max_length=...)`        | ржЯрзЗржХрзНрж╕ржЯ рж░рж╛ржЦрзЗ          |
| `TextField()`                      | ржмрзЬ ржЯрзЗржХрзНрж╕ржЯ рж░рж╛ржЦрзЗ       |
| `IntegerField()`                   | рж╕ржВржЦрзНржпрж╛ рж░рж╛ржЦрзЗ          |
| `FloatField()`                     | ржжрж╢ржорж┐ржХ рж╕ржВржЦрзНржпрж╛         |
| `BooleanField()`                   | True/False           |
| `EmailField()`                     | ржЗржорзЗржЗрж▓ рж░рж╛ржЦрзЗ           |
| `DateTimeField(auto_now_add=True)` | рждрзИрж░рж┐ рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ       |
| `DateTimeField(auto_now=True)`     | ржкрзНрж░рждрж┐ржмрж╛рж░ ржЖржкржбрзЗржЯрзЗрж░ рж╕ржорзЯ |

ЁЯУБ ржлрзЛрж▓рзНржбрж╛рж░ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ (рж╕ржВржХрзНрж╖рзЗржкрзЗ)

```pgsql
myproject/
тФЬтФАтФА manage.py
тФЬтФАтФА myproject/
тФВ   тФФтФАтФА settings.py
тФЬтФАтФА myapp/
тФВ   тФЬтФАтФА models.py       тЖР ржоржбрзЗрж▓ ржлрж╛ржЗрж▓
тФВ   тФЬтФАтФА admin.py        тЖР ржЕрзНржпрж╛ржбржорж┐ржирзЗ рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░
тФВ   тФФтФАтФА migrations/
```

ЁЯза ржоржирзЗ рж░рж╛ржЦржмрзЗржи:

- models.Model ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐ Python ржХрзНрж▓рж╛рж╕ ржжрж┐рзЯрзЗ SQL ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

- ржкрзНрж░рждрж┐ржмрж╛рж░ ржоржбрзЗрж▓рзЗ ржкрж░рж┐ржмрж░рзНрждржи ржПрж▓рзЗ ржЖржмрж╛рж░ makemigrations ржПржмржВ migrate ржжрж┐рждрзЗ рж╣рзЯред

## тЬЕ Day 4: CRUD with ORM

1.Create/Read/Update/Delete (CRUD) operations

2.Django shell / ORM query practice

3.View ржерзЗржХрзЗ DB data fetch ржХрж░рж╛

4.Data form ржжрж┐рзЯрзЗ insert ржХрж░рж╛

ржЖржорж┐ ржПржЗ рж▓рзЗрж╕ржи ржЧрзБрж▓рж╛ ржХржоржкрзНрж▓рж┐ржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржХрж┐ржЫрзБ рж╕рзНржЯрзЗржк ржирж┐ржЪрзЗ ржПржХрзНрж╕ржкрзНрж▓рзЗржЗржи ржХрж░рж╕рж┐ ржпрзЗржЯрж╛ ржжрзЗржЦрзЗ ржЖржорж░рж╛ ржПржЗ рж▓рзЗрж╕ржи рждрж╛ ржХржоржкрзНрж▓рж┐ржЯ
ржХрж░рждрзЗ ржкрж╛рж░рж┐ред ржЙржкрж░рзЗрж░ ржПржЗ рзл ржЯрж┐ рж▓рзЗрж╕ржи ржЖржорж░рж╛ ржирж┐ржЪрзЗрж░ ржПржЗ рззрзж ржЯрж╛ рж╕рзНржЯрзЗржк ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЖржорж░рж╛ рж░рж┐ржнрж┐рж╢ржи ржжрж┐рждрзЗ ржкрж╛рж░ржмрзЛ
ржЗржирж╢рж╛ржЖрж▓рзНрж▓рж╛рж╣ред

ЁЯФ╣ STEP 1: Django ORM (Object Relational Mapper) ORM ржжрж┐рзЯрзЗ Python ржХрзЛржб рж▓рж┐ржЦрзЗржЗ ржбрзЗржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржЬ ржХрж░рж╛ ржпрж╛рзЯ, SQL
ржирж╛ рж▓рж┐ржЦрзЗржУред Shell ржЪрж╛рж▓рзБ ржХрж░рзЛ:

```bash
 python manage.py shell
```

ЁЯФ╣ STEP 2: Create (рждрзИрж░рж┐ ржХрж░рж╛)

```python
from app_name.models import Product

# 1. Create with create()
Product.objects.create(name='Mobile', price=5000)

# 2. Create with instance
p = Product(name='Laptop', price=80000)
p.save()

```

ЁЯФ╣ STEP 3: Read (ржбрзЗржЯрж╛ ржкрзЬрж╛)

```python
# рж╕ржм ржбрзЗржЯрж╛ ржкрзЬрж╛
Product.objects.all()

# Filter ржХрж░рж╛
Product.objects.filter(price__gt=5000)

# ржПржХржХ ржбрзЗржЯрж╛
Product.objects.get(id=1)

```

ЁЯФ╣ STEP 4: Update (ржЖржкржбрзЗржЯ ржХрж░рж╛)

```python
# ржкрзНрж░ржержорзЗ instance ржЖржирзЛ
p = Product.objects.get(id=1)
p.price = 6000
p.save()

```

ЁЯФ╣ STEP 5: Delete (ржорзБржЫрзЗ ржлрзЗрж▓рж╛)

```python
# ржкрзНрж░ржержорзЗ instance ржЖржирзЛ
p = Product.objects.get(id=1)
p.delete()

```

ЁЯФ╣ STEP 6: View ржерзЗржХрзЗ DB Data Fetch ржХрж░рж╛

```python
# views.py
from django.shortcuts import render
from .models import Product

def product_list(request):
   products = Product.objects.all()
   return render(request, 'products.html', {'products': products})


```

products.html ржЯрзЗржорзНржкрж▓рзЗржЯ ржП рж╕рзЗржЗ ржбрж╛ржЯрж╛ access ржХрж░рж╛ред

```html
<!-- products.html -->
{% for product in products %}
<p>{{ product.name }} - {{ product.price }}</p>
{% endfor %}
```

ЁЯФ╣ STEP 7: Form ржжрж┐рзЯрзЗ Data Insert ржХрж░рж╛ (without ModelForm)

```html
<!-- form.html -->
<form method="POST">
  {% csrf_token %}
  <input type="text" name="name" />
  <input type="number" name="price" />
  <button type="submit">Add Product</button>
</form>
```

```python
# views.py
from .models import Product
from django.shortcuts import render.redirect


def add_product(request):
    if request.method == 'POST':
        name = request.POST['name']
        price = request.POST['price']
        Product.objects.create(name=name, price=price)
        return redirect("formsucces")
    return render(request, 'form.html')

```

ЁЯФ╣ STEP 8: Form + Modelform ржжрж┐рзЯрзЗ Data Insert ржХрж░рж╛

```python
# forms.py

from django import forms
from .models import Product

class ProductForm(forms.ModelForm):
    class Meta:
        model = Product
        fields = ['name', 'price', 'description']
```

ЁЯСЙ ModelForm ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ input ржмрж╛ржирж╛рждрзЗ рж╣рзЯ ржирж╛ред Django ржирж┐ржЬрзЗржЗ ржлрж░рзНржо ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рзЗ ржирзЗрзЯред

```python
# views.py

from django.shortcuts import render, redirect
from .forms import ProductForm

def add_product(request):
    if request.method == 'POST':
        form = ProductForm(request.POST)
        if form.is_valid():
            form.save()
            return redirect('product_list')
    else:
        form = ProductForm()
    return render(request, 'add_product.html', {'form': form})
```

```html
<!-- templates/add_product.html -->

<h2>Add Product</h2>
<form method="POST">
  {% csrf_token %} {{ form.as_p }}
  <button type="submit">Add</button>
</form>
```

ЁЯУЭ {{ form.as_p }} ржорж╛ржирзЗ ржлрж░рзНржо ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ <p> ржЯрзНржпрж╛ржЧрзЗрж░ ржнрж┐рждрж░рзЗ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗред

ЁЯФ╣ STEP 8: Form + Modelform ржжрж┐рзЯрзЗ Data Update (Edit Product) ржХрж░рж╛

```python
# views.py

from .models import Product
from .forms import ProductForm

def edit_product(request, pk):
    product = Product.objects.get(id=pk)
    if request.method == 'POST':
        form = ProductForm(request.POST, instance=product)
        if form.is_valid():
            form.save()
            return redirect('product_list')
    else:
        form = ProductForm(instance=product)
    return render(request, 'edit_product.html', {'form': form})

```

```html
<!-- templates/edit_product.html -->

<h2>Edit Product</h2>
<form method="POST">
  {% csrf_token %} {{ form.as_p }}
  <button type="submit">Update</button>
</form>
```

ЁЯУМ instance=product ржжрж┐рж▓рзЗ form ржкрзНрж░рж┐-ржлрж┐рж▓ржб рж╣ржмрзЗ ржЖржЧрзЗрж░ ржбрзЗржЯрж╛ ржжрж┐рзЯрзЗред ЁЯУМ (request.POST, instance=product) ржжрж┐рж▓рзЗ
instance ржПрж░ ржбрж╛ржЯрж╛ ржорж╛ржирзЗ ржЖржЧрзЗрж░ ржбрж╛ржЯрж╛ request.POST ржжрзНржмрж╛рж░рж╛ replace ржХрж░ржмрзЗред

ЁЯФ╣Django ModelForm ржПрж░ рзкржЯрж┐ рж░рзВржк

| рж░рзВржк ржиржорзНржмрж░ | рж░рзВржк (Code)                                         | ржЙржжрзНржжрзЗрж╢рзНржп               | ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ                       | ржмрзНржпрж╛ржЦрзНржпрж╛ / ржЙржжрж╛рж╣рж░ржг                                              |
| --------- | -------------------------------------------------- | ---------------------- | ------------------------------------ | -------------------------------------------------------------- |
| 1         | `ProductForm()`                                    | Empty form             | ржлрж╛ржБржХрж╛ ржлрж░рзНржо ржжрзЗржЦрж╛рждрзЗ                    | ржирждрзБржи ржкрзНрж░рзЛржбрж╛ржХрзНржЯ add ржХрж░рж╛рж░ рж╕ржорзЯ, ржкрзНрж░ржержоржмрж╛рж░ ржлрж░рзНржо ржжрзЗржЦрж╛ржирзЛ рж╣рзЯ           |
| 2         | `ProductForm(data=request.POST)`                   | POST ржбрзЗржЯрж╛ ржирзЗржУрзЯрж╛        | ржлрж░рзНржо рж╕рж╛ржмржорж┐ржЯ рж╣ржУрзЯрж╛рж░ ржкрж░ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржХрж░рждрзЗ | ржЗржиржкрзБржЯ ржнрзНржпрж╛рж▓рж┐ржб рж╣рж▓рзЗ `form.save()` ржХрж░рж╛ рж╣рзЯ                         |
| 3         | `ProductForm(instance=product)`                    | ржкрзНрж░рж┐-ржлрж┐рж▓рзНржб ржлрж░рзНржо        | ржЖржЧрзЗрж░ ржбрзЗржЯрж╛ рж╕рж╣ ржлрж░рзНржо ржжрзЗржЦрж╛рждрзЗ             | Edit ржХрж░рж╛рж░ рж╕ржорзЯ ржЖржЧрзЗрж░ ржкрзНрж░рзЛржбрж╛ржХрзНржЯрзЗрж░ ржЗржиржлрзЛ ржжрж┐рзЯрзЗ ржлрж░рзНржо ржкрзВрж░ржг рж╣рзЯ          |
| 4         | `ProductForm(data=request.POST, instance=product)` | Update with validation | ржлрж░рзНржо рж╕рж╛ржмржорж┐ржЯ ржХрж░рзЗ ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ рж╕ржорзЯ  | ржкрзБрж░рж╛рждржи ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржирждрзБржи ржнрзНржпрж╛рж▓рзБ ржмрж╕рж┐рзЯрзЗ `save()` ржХрж░рж▓рзЗ ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ рж╣рзЯ |

ЁЯФ╕ STEP 10: Advanced Product List View

```python
# views.py

def product_list(request):
    products = Product.objects.all()
    return render(request, 'product_list.html', {'products': products})
```

```html
<!-- templates/product_list.html -->

<h2>Product List</h2>
<table border="1">
  <tr>
    <th>Name</th>
    <th>Price</th>
    <th>Description</th>
    <th>Actions</th>
  </tr>
  {% for p in products %}
  <tr>
    <td>{{ p.name }}</td>
    <td>{{ p.price }}</td>
    <td>{{ p.description }}</td>
    <td>
      <a href="{% url 'edit_product' p.id %}">Edit</a> |
      <a href="{% url 'delete_product' p.id %}">Delete</a>
    </td>
  </tr>
  {% endfor %}
</table>
```

тЬЕ рж░рж┐ржнрж┐рж╢ржи ржХрзМрж╢рж▓:

| Form рж░рзВржк                                  | Context (ржХрзЛржерж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ?)         |
| ----------------------------------------- | ----------------------------------- |
| `ProductForm()`                           | ржирждрзБржи ржлрж░рзНржо ржжрзЗржЦрж╛ржирзЛрж░ рж╕ржорзЯ               |
| `ProductForm(request.POST)`               | рж╕рж╛ржмржорж┐ржЯрзЗрж░ ржкрж░ ржЗржиржкрзБржЯ ржпрж╛ржЪрж╛ржЗ             |
| `ProductForm(instance=...)`               | ржЖржЧрзЗрж░ ржбрзЗржЯрж╛ ржкрзНрж░рж┐-ржлрж┐рж▓рзНржб ржХрж░рж╛рж░ рж╕ржорзЯ       |
| `ProductForm(request.POST, instance=...)` | рж╕рж╛ржмржорж┐ржЯ ржХрж░рзЗ ржЖржЧрзЗрж░ ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ рж╕ржорзЯ |

## тЬЕ Day 5: Model Relationship

- one-to-one(onetonefield)
- One-to-Many (ForeignKey)
- Many-to-Many(manytomanyfield)
- related_name, related_query_name
- Query set chaining (filter, exclude)

#### ЁЯФЧ рзз. One-to-One рж╕ржорзНржкрж░рзНржХ (OneToOneField)

- ржжрзБржЗржЯрж┐ ржоржбрзЗрж▓ ржпржЦржи ржПржХрзЗ ржЕржкрж░рзЗрж░ рж╕ржЩрзНржЧрзЗ ржПржХ-ржПржХ рж╕ржорзНржкрж░рзНржХ рждрзИрж░рж┐ ржХрж░рзЗред
- ржпржЦржи ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржПрж░ ржПржХржЯрж╛ Raw ржЕржирзНржп ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржПрж░ ржПржХржЯрж╛ raw ржПрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХржпрзБржХрзНрждред
- ржпрзЗржоржи: ржкрзНрж░рждрж┐ржЯрж┐ User ржПрж░ ржПржХржЯрж╛ржЗ Profile ржерж╛ржХржмрзЗредржЖржмрж╛рж░ ржпрзЗржоржи ржПржХржЯрж╛ ржЗржЙрж╕рж╛рж░ ржПрж░ ржПржХржЯрж╛ржЗ settings ржерж╛ржХрзЗ ржмрж╛ ржПржХржЯрж╛ржЗред
  ржПржЦрж╛ржирзЗ users ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржЖржмрж╛рж░ settings ржЖрж░ ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЖрж░ ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржмрзБржЭрж╛ржирзЛ рж╣рзЯрзЗржЫрзЗред

тЬЕ ржХрзЛржб ржЙржжрж╛рж╣рж░ржг:

```python
class User(models.Model):
    name = models.CharField(max_length=100)

class Profile(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    bio = models.TextField()
```

ЁЯФН on_delete=models.CASCADE ржорж╛ржирзЗ ржпржжрж┐ User ржорзБржЫрзЗ ржпрж╛рзЯ, рждрж╛рж░ Profile-ржУ ржорзБржЫрзЗ ржпрж╛ржмрзЗред

#### ЁЯФЧ рзи. One-to-Many рж╕ржорзНржкрж░рзНржХ (ForeignKey)

- ржПржХржЯрж┐ ржоржбрзЗрж▓ ржЕржирзЗржХ ржЧрзБрж▓рзЛ instance-ржХрзЗ рж░рж┐ржкрзНрж░рзЗржЬрзЗржирзНржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржЕржирзНржп ржПржХржЯрж┐ ржоржбрзЗрж▓рзЗрж░ ржоржзрзНржп ржжрж┐рзЯрзЗред
- ржпржЦржи ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржПрж░ ржПржХржЯрж╛ raw ржЕржирзНржп ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржПрж░ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ raw ржПрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХржпрзБржХрзНрждредржмрж▓рж╛ ржпрж╛рзЯ ржЕржирзЗржХ
  рждрж╛ ржкрж┐рждрж╛ ржкрзБрждрзНрж░рзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХрзЗрж░ ржорждрзЛ ржПржХ ржкрж┐рждрж╛рж░ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ рж╕ржирзНрждрж╛ржи ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗредржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржкрж┐рждрж╛ рж╣рж▓рзЛ
  ржпрзЗржЗ ржЯрзЗржмрж┐рж▓ ржХрзЗ foregnkey рж╣рж┐рж╕рж╛ржмрзЗ рж╕рзЗржЯ ржХрж░рж╕рж┐ ржЕржирзНржпржжрж┐ржХрзЗ ржкрзБрждрзНрж░ рж╣рж▓рзЗ ржпрзЗржЗ ржЯрзЗржмрж┐рж▓рзЗ foregnkey рж╕рзЗржЯ ржХрж░ржЫрж┐ред
- ржпрзЗржоржи: ржПржХржЯрж┐ Category-ржПрж░ ржоржзрзНржпрзЗ ржЕржирзЗржХржЧрзБрж▓рзЛ Product ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗредржЖржмрж╛рж░ ржПржХржЯрж╛ ржЗржЙрж╕рж╛рж░ ржПрж░ ржПржХрж╛ржзрж┐ржХ message ржерж╛ржХрждрзЗ
  ржкрж╛рж░рзЗред ржПржХржЯрж╛ ржЗржЙрж╕рж╛рж░ ржПржХржзрж┐ржХ ржЕрж░рзНржбрж╛рж░ ржжрж┐рждрзЗ ржкрж╛рж░рзЗредржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ user,category рж╣рж▓рзЛ ржкрж┐рждрж╛ ржЯрзЗржмрж┐рж▓ ржЖрж░
  message,order,product рж╣рж▓рзЛ ржкрзБрждрзНрж░ ржЯрзЗржмрж┐рж▓

тЬЕ ржХрзЛржб ржЙржжрж╛рж╣рж░ржг:

```python
class Category(models.Model):
    name = models.CharField(max_length=100)

class Product(models.Model):
    category = models.ForeignKey(Category, on_delete=models.CASCADE)
    title = models.CharField(max_length=100)
```

ЁЯФН ржПржЦрж╛ржирзЗ Product ржоржбрзЗрж▓рзЗ ForeignKey рж░рзЯрзЗржЫрзЗ Category-рж░ рж╕рж╛ржерзЗред ржПржХ ржХрзНржпрж╛ржЯрзЗржЧрж░рж┐рждрзЗ ржЕржирзЗржХ ржкрзНрж░рзЛржбрж╛ржХрзНржЯ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред

#### ЁЯФЧ рзй. Many-to-Many рж╕ржорзНржкрж░рзНржХ (ManyToManyField)

- ржжрзБржЗржЯрж┐ ржоржбрзЗрж▓рзЗрж░ ржоржзрзНржпрзЗ ржЕржирзЗржХ-ржерзЗржХрзЗ-ржЕржирзЗржХ рж╕ржорзНржкрж░рзНржХред
- ржпржЦржи ржПржХржЯрж┐ ржЯрзЗржмрж┐рж▓ ржПрж░ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ raw ржПрж░ рж╕рж╛ржерзЗ ржЖрж░рзЗржХржЯрж┐ ржЯрзЗржмрж┐рж▓ ржПрж░ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ raw рж╕ржорзНржкрж░рзНржХржпрзБржХрзНрждред ржЕржирзЗржХ ржЯрж╛
  ржЪрж╛ржЪрж╛ ржнрж╛рждрж┐ржЬрж╛рж░ рж╕ржорзНржкрж░рзНржХрзЗрж░ ржорждрзЛ ржПржХ ржЪрж╛ржЪрж╛рж░ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ ржнрж╛рждрж┐ржЬрж╛ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ ржЖржмрж╛рж░ ржПржХ ржнрж╛рждрж┐ржЬрж╛рж░ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ
  ржЪрж╛ржЪрж╛ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред

- ржпрзЗржоржи: ржПржХржЬржи Student ржЕржирзЗржХ ржПржХ ржмрж╛ Course ржХрж░рждрзЗ ржкрж╛рж░рзЗ, ржЖржмрж╛рж░ ржПржХржЯрж┐ Course-ржП ржПржХ ржмрж╛ ржЕржирзЗржХ Student ржерж╛ржХрждрзЗ
  ржкрж╛рж░рзЗредржПржХржЯрж┐ ржЯрзНржпрж╛ржЧ ржПржХ ржмрж╛ ржПржХржзрж┐ржХ ржкрзЛрж╕рзНржЯ ржП ржПржкрж▓рж╛ржЗ рж╣рждрзЗ ржкрж╛рж░рзЗ ржЖржмрж╛рж░ ржПржХржЯрж┐ ржкрзЛрж╕рзНржЯ ржП ржПржХрж╛ржзрж┐ржХ ржЯрзНржпрж╛ржЧ use рж╣рждрзЗ ржкрж╛рж░рзЗред

тЬЕ ржХрзЛржб ржЙржжрж╛рж╣рж░ржг:

```python
class Student(models.Model):
    name = models.CharField(max_length=100)

class Course(models.Model):
    title = models.CharField(max_length=100)
    students = models.ManyToManyField(Student)
```

#### ЁЯФД рзк. related_name ржУ related_query_name

related_name:

- ржПржЯрж┐ reverse relationship ржХрж░рж╛рж░ рж╕ржорзЯ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред

- ржпрзЗржЦрж╛ржи ржерзЗржХрзЗ relation рждрзИрж░рж┐ рж╣рзЯржирж┐, рж╕рзЗржЦрж╛ржи ржерзЗржХрзЗржУ access ржХрж░рждрзЗ ржжрзЗрзЯред
- ржорж╛ржирзЗ ржкрж░рж╕рзНржкрж░ рж╕ржорзНржкрж░рзНржХржпрзБржХрзНржд ржЯрзЗржмрж┐рж▓ ржЧрзБрж▓рж╛рж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржПржХржЯрж╛ ржЯрзЗржмрж┐рж▓ ржПрж░ raw ржПрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХржпрзБржХрзНржд ржЕржирзНржп ржЯрзЗржмрж┐рж▓
  raw ржПрж░ ржПржХрзНрж╕рзЗрж╕редralated name ржжрзНржмрж╛рж░рж╛ ржЖржорж░рж╛ reverse ржПржХрзНрж╕рзЗрж╕ ржПрж░ name рж╕рзЗржн ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржмрж╛ржЗ ржбрзЗржлрж▓рзНржЯ ржПржЯрж╛
  relatedtablename_sets ржерж╛ржХрзЗ рждрж╛ ржЖржорж░рж╛ ржЪрзЗржЮрзНржЬ ржХрж░рзЗ ржирж┐ржЬрзЗрж░ ржорждрзЛ рж░рж╛ржЦрждрзЗ ржкрж╛рж░рж┐ред
- ржПржЯрж╛ рж╣ржЪрзНржЫрзЗ Child Model ржерзЗржХрзЗ Parent Model ржХрзЗ access ржХрж░рж╛рж░ ржкрж░, Parent ржПрж░ reverse relation-ржП Child ржЧрзБрж▓рзЛ
  ржХрж┐рж╕рзЗрж░ ржорж╛ржзрзНржпржорзЗ access ржХрж░ржм рж╕рзЗржЯрж╛ define ржХрж░рзЗред

ЁЯФ╕ рж╕рж╣ржЬржнрж╛ржмрзЗ: Parent Model ржерзЗржХрзЗ Child-ржжрзЗрж░ access ржХрж░рж╛рж░ ржирж╛ржоред

тЬЕ ржЙржжрж╛рж╣рж░ржг:

```python
class Blog(models.Model):
    title = models.CharField(max_length=100)

class Comment(models.Model):
    blog = models.ForeignKey(Blog, on_delete=models.CASCADE, related_name='comments')
    content = models.TextField()
```

ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ blog ржЯрзЗржмрж┐рж▓ рж╣рждрзЗ ржХрж┐ name ржжрж┐рзЯрж╛ ржПрж░ Raw ржПрж░ ржорж╛ржирзЗ ржкрзНрж░рждрж┐ржЯрж╛ blog ржПрж░ comment ржПржХрзНрж╕рзЗрж╕ ржХрж░ржмрзЛ рждрж╛ рж░рж┐рж▓рзЗржЯрзЗржб
name ржжрж┐рзЯрж╛ ржмрж▓рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ ржЖржорж░рж╛ред

ЁЯФН ржмрзНржпржмрж╣рж╛рж░:

```python
blog = Blog.objects.get(id=1)
comments = blog.comments.all()  # related_name ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ
```

##### related_query_name:

- ржПржЯрж┐ QuerySet chaining-ржПрж░ рж╕ржорзЯ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржХрж╛ржЬрзЗ ржЖрж╕рзЗред тЬЕ ржЙржжрж╛рж╣рж░ржг:

```python
class Author(models.Model):
    name = models.CharField(max_length=100)

class Book(models.Model):
    author = models.ForeignKey(Author, on_delete=models.CASCADE, related_query_name='books_written')

```

ЁЯФН ржмрзНржпржмрж╣рж╛рж░:

```python
Author.objects.filter(books_written__title__icontains='python')
```

- ржорж╛ржирзЗ рж╣рж▓рзЛ ржкрзНржпрж╛рж░рзЗржирзНржЯ рж╣рждрзЗ ржбрж╛ржЗрж░рзЗржХрзНржЯ рждрж╛рж░ рж░рзЗрж▓рзЗржЯрзЗржЯ ржЪрж╛ржЗрж▓рзНржб raw ржЧрзБрж▓рж╛рж░ ржлрж┐рж▓рзНржб ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рждрзЗ ржкрж╛рж░рж┐
  related_query_name рж╣рж▓рзЛ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржПрж░ рж░рж┐рж▓рзЗржЯрзЗржб ржЪрж╛ржЗрж▓рзНржб ржЧрзБрж▓рж╛рж░ ржЕржмржЬрзЗржХрзНржЯ ржПрж░ ржУржкрж░ ржХрж┐ ржирж╛ржо ржжрж┐рзЯрж╛ query ржмрж╛
  ржЕржкрж╛рж░рзЗрж╢ржи ржЪрж╛рж▓рж╛ржмрзЛред ржЕрж░рзНржерж╛рзО ржПржЯрж╛ рж░рж┐рж▓рзЗржЯрзЗржб ржЪрж╛ржЗрж▓рзНржб ржЧрзБрж▓рж╛рж░ queryset,fieldsets ржХрзЗ ржмрзБржЭрж╛рзЯред ржпрж╛рж░ ржУржкрж░ ржмрж┐ржнрж┐ржирзНржи
  ржХрзЛрзЯрзЗрж░рж┐ ржЪрж▓рж╛ рж╣ржмрзЗред ржмрж▓рж╛ ржпрж╛рзЯ ржПржЯрж╛ parent.childset ржПрж░ shortform.
- ржПржЯрж╛ рж╣ржЪрзНржЫрзЗ ржпржЦржи рждрзБржорж┐ Parent Model ржХрзЗ filter ржХрж░ржмрзЗ рждрж╛рж░ Child Model ржПрж░ ржХрзЛржи attribute ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, рждржЦржи
  ржХрзЛржи ржирж╛ржорзЗ query ржЪрж▓ржмрзЗ тАФ рж╕рзЗржЯрж╛ define ржХрж░рзЗред

ЁЯФ╕ рж╕рж╣ржЬржнрж╛ржмрзЗ: Parent Model ржХрзЗ filter ржХрж░рж╛рж░ рж╕ржорзЯ, related Child field-ржХрзЗ ржХрзЛржи ржирж╛ржорзЗ ржЪрзЗржирж╛ржмрзЗ тАФ рж╕рзЗржЯрж╛ред child ржПрж░
field ржЕржирзБржпрж╛рзЯрзА ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржмрж╛ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржП ржХрзЛрзЯрзЗрж░рж┐ ржЪрж╛рж▓рж╛ржирзЛред Parent Model ржерзЗржХрзЗ Child-fields
ржЕржирзБржпрж╛рзЯрзА ржХрзЛрзЯрзЗрж░рж┐ ржЪрж╛рж▓рж╛рж░ ржирж╛ржоред

ЁЯФЧ рзл. QuerySet Chaining (ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп)

тЬЕ filter(): ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж┐ржЫрзБ ржбрзЗржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ:

```python
Product.objects.filter(price__gt=100)
```

тЬЕ exclude(): ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж┐ржЫрзБ ржмрж╛ржж ржжрж┐рждрзЗ:Filter ржПрж░ ржЙрж▓рзНржЯрзЛред ржлрж┐рж▓рзНржЯрж╛рж░ рж╢рж░рзНржд ржорж╛ржирж╛ ржЕржмржЬрзЗржХрзНржЯ ржЧрзБрж▓рж╛ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ ржЖрж░
exclude рж╢рж░рзНржд ржирж╛ ржорж╛ржирж╛ ржЕржмржЬрзЗржХрзНржЯ ржЧрзБрж▓рж╛ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ

```python
Product.objects.exclude(product_type='digital')
```

ЁЯза Bonus Tip:

- рж╕ржмрж╕ржорзЯ рж╕ржорзНржкрж░рзНржХрзЗрж░ ржзрж░ржи ржмрзБржЭрзЗ OneToOneField, ForeignKey ржмрж╛ ManyToManyField ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗред

- related_name ржжрж┐рзЯрзЗ reverse querying ржЖрж░ржУ readable ржПржмржВ manageable рж╣рзЯред

- related_query_name ржжрж┐рзЯрзЗ queryset chaining ржЕржирзЗржХ clean рж╣рзЯред

---

## тЬЕ Day 6: Django Forms & ModelForm

# ┬аDjango Form Handling Handnote тЬНя╕П

ржПржЗ ржирзЛржЯржЯрж┐ Django Form Handling ржирж┐ржпрж╝рзЗ ржЖржЬржХрзЗрж░ ржЖрж▓рзЛржЪржирж╛ ржЕржирзБржпрж╛ржпрж╝рзА рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ тАФ ржкрзНрж░рждрж┐ржЯрж┐ ржЯржкрж┐ржХ, function,
ржПржмржВ concept рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рзЗ future ржП рж░рж┐ржнрж┐рж╢ржирзЗрж░ ржЬржирзНржп рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛ рж╣рж▓рзЛред

---

### ЁЯОп 1. Form vs ModelForm

| Aspect                           | Form                                                          | ModelForm                                                 |
| -------------------------------- | ------------------------------------------------------------- | --------------------------------------------------------- |
| Data Source                      | Manual Field define                                           | Model ржерзЗржХрзЗ Field auto create                              |
| Use-case                         | Non-model data ржЕржержмрж╛ manual validation                         | Direct Model CRUD ржЬржирзНржп                                    |
| Advantage                        | ржмрзЗрж╢рж┐ control                                                  | auto fields, less code                                    |
| ЁЯОп ржЙржжрзНржжрзЗрж╢рзНржп                      | ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ ржлрж┐рж▓рзНржб ржмрж╛ржирж┐рзЯрзЗ ржлрж░рзНржо рждрзИрж░рж┐ ржХрж░рж╛                         | ржоржбрзЗрж▓ ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржлрж░рзНржо ржЕржЯрзЛ рждрзИрж░рж┐ ржХрж░рж╛                  |
| ЁЯз▒ Field ржХрж┐ржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣рзЯ          | ржкрзНрж░рждрзНржпрзЗржХржЯрж┐ Field ржирж┐ржЬрзЗ declare ржХрж░рждрзЗ рж╣рзЯ                         | Model ржПрж░ Field ржЧрзБрж▓рзЛ ржирж┐ржЬрзЗ ржирж┐ржЬрзЗ ржлрж░рзНржорзЗ ржпрзБржХрзНржд рж╣рзЯ              |
| ЁЯУЭ ржХрзЛржерж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ              | ржпржЦржи ржХрзЛржирзЛ ржоржбрзЗрж▓рзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржлрж░рзНржо ржирж╛, ржмрж░ржВ ржХрж╛рж╕рзНржЯржо ржЗржиржкрзБржЯ рж▓рж╛ржЧрзЗ | ржпржЦржи ржХрзЛржирзЛ ржоржбрзЗрж▓рзЗрж░ ржЗржиржкрзБржЯ/ржбрзЗржЯрж╛ CRUD ржПрж░ ржЬржирзНржп ржлрж░рзНржо рждрзИрж░рж┐ ржХрж░рждрзЗ рж╣рзЯ |
| ЁЯФз Validation                    | ржкрзНрж░рждрж┐ржЯрж┐ ржлрж┐рж▓рзНржб ржПрж░ ржЬржирзНржп ржирж┐ржЬрзЗ ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ validation ржжрж┐рждрзЗ рж╣рзЯ      | ржоржбрзЗрж▓ ржПрж░ validation ржЕржЯрзЛ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯ рж╣рзЯрзЗ ржпрж╛рзЯ                |
| ЁЯЫа ржХрж╛ржЬрзЗрж░ ржирж┐рзЯржирзНрждрзНрж░ржг                | рж╕ржм ржХрж┐ржЫрзБ ржирж┐ржЬрзЗрж░ ржоржд ржХрж░рзЗ ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рж╛ ржпрж╛рзЯ                        | ржЕржирзЗржХ ржХрж┐ржЫрзБ ржЕржЯрзЛ рж╣рзЯрзЗ ржпрж╛рзЯ, рждржмрзЗ ржЙржЗржЬрзЗржЯ ржУ рж▓рзЗржмрзЗрж▓ ржХрж╛рж╕рзНржЯржо ржХрж░рж╛ ржпрж╛рзЯ   |
| ЁЯзй ржХрзЛржбрзЗрж░ ржкрж░рж┐ржорж╛ржг                  | ржЕржирзЗржХ ржмрзЗрж╢рж┐ ржХрзЛржб рж▓рж┐ржЦрждрзЗ рж╣рзЯ                                        | ржЕржирзЗржХ ржХржо ржХрзЛржбрзЗ ржлрж░рзНржо рждрзИрж░рж┐ рж╣рзЯрзЗ ржпрж╛рзЯ                            |
| ЁЯзСтАНЁЯТ╗ Performance & Maintainability | ржХрзЛржб ржмрзЬ рж╣рзЯ, ржХрж┐ржирзНрждрзБ рж╕рзНржкрзЗрж╕рж┐ржлрж┐ржХ ржирж┐рзЯржирзНрждрзНрж░ржг ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ               | ржХрзЛржб ржЫрзЛржЯ рж╣рзЯ, ржХрж┐ржирзНрждрзБ рж╕ржм ржХрж┐ржЫрзБ ржЕржЯрзЛ ржорзНржпрж╛ржирзЗржЬ ржХрж░рзЗ                |

---

### ЁЯОп 2. Custom Validation

### ЁЯФ╣ Field level validation:

```python
# Tag name field ржПрж░ validation
class MyForm(forms.Form):
    tag = forms.CharField()

#    def clean_fieldname()  syntex ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржПржХржЯрж╛ ржлрж┐рж▓рзНржб ржПрж░ ржЬржирзНржп ржХрж╛рж╕рзНржЯржо ржмрж╛рж▓рж┐ржЯрзЗрж╢ржи
    def clean_tag(self):
        value = self.cleaned_data['tag']
        if 'badword' in value:
            raise forms.ValidationError("Don't use bad words")
        return value.stripe() # cleaned_data["field"] ржЖржкржбрзЗржЯ ржХрж░рж╛ рж╣рж▓рзЛ
"""
```

ЁЯФ╕clean_field ржорзЗржержб ржмрзНржпрж╛ржирж╛рж░ ржЙржжрзНржжрзЗрж╢ ржХрзЛржи ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржб ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рж╛ `cleaned_data["field"]` ржЖржкржбрзЗржЯ
ржХрж░рзЗ рж╕рзЗржЗ ржнрзНржпрж╛рж▓рзБ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛ django ржПржЯрж╛ржЗ ржзрж░рзЗ ржирзЗрзЯ ржПржЗ ржнрж╛ржмрзЗржЗ ржХрж╛ржЬ ржХрж░рзЗ ржЖрж░ return ржирж╛ ржжрж┐рж▓рзЗ
`dango ржнрж╛ржмрзЗ ржбрзЗржнрзЗрж▓ржкрж╛рж░ null рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржЫрзЗ` рждрж╛ржЗ рждрж╛рж░ рж╕рзЗржЗ ржлрж┐рж▓рзНржб ржПрж░ ржнрзНржпрж╛рж▓рзБ null ржХрж░рзЗ рж░рж╛ржЦрзЗ рждржЦржи рж╕рзЗржЗ ржнрзНржпрж╛рж▓рзБ ржмрж╛
ржлрж┐рж▓рзНржб ржЯрзЗржорзНржкрж▓рзЗржЯ ржнрж┐ржЙ ржХрзЛржерж╛рзЯ ржпрж╛ржмрзЗ ржирж╛ред ржХрж╛рж░ржг null ред

ЁЯФ╕ clean\_<fieldname>() Method

| ржмрзИрж╢рж┐рж╖рзНржЯрзНржп               | ржмрзНржпрж╛ржЦрзНржпрж╛                                                  |
| ----------------------- | --------------------------------------------------------- |
| ржХржЦржи ржЪрж▓рзЗ?                | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ validation ржПрж░ рж╕ржорзЯ                       |
| ржХрж┐ржнрж╛ржмрзЗ define ржХрж░рзЛ?      | `def clean_email(self):` ржПрж░ ржорждрзЛ ржХрж░рзЗ                       |
| ржХрзЛржи ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржЪрж▓рзЗ?   | рж╢рзБржзрзБржорж╛рждрзНрж░ ржУржЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп                       |
| return ржжрж┐рждрзЗ рж╣ржпрж╝?        | тЬФя╕П **рж╣рзНржпрж╛ржБ, ржжрж┐рждрзЗ рж╣ржмрзЗржЗ**                                   |
| return ржжрж┐рж▓рзЗ ржХрзА рж╣рзЯ?      | ржУржЗ ржлрж┐рж▓рзНржбрзЗрж░ `cleaned_data[field]` ржЖржкржбрзЗржЯ рж╣ржпрж╝                |
| return ржирж╛ ржжрж┐рж▓рзЗ ржХрзА рж╣рзЯ?   | Django ржзрж░рзЗ ржирзЗржпрж╝ `None` ржмрж╛ ржлрж┐рж▓рзНржб ржмрж╛ржж ржпрж╛ржпрж╝                  |
| ржХрж┐рж╕рзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ? | format ржарж┐ржХ ржХрж░рж╛, lowercase/uppercase, custom check ржЗрждрзНржпрж╛ржжрж┐ |

### ЁЯФ╣ Form level validation (clean method override):

```python
    def clean(self):
        data = super().clean()  # default validation ржХрж╛ржЬ ржХрж░рзЗ
        if data.get('password') != data.get('confirm_password'):
          #def clean_add_error(fieldname,error_msg)  syntex ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рж╕ ржПрж░ error dict ржП error ржЕрзНржпрж╛ржб ржХрж░рж╛рж░ ржЬржирзНржп
            self.add_error('confirm_password', "Password doesn't match")
```

ЁЯФ╕ `super().clean()` ржирж╛ ржжрж┐рж▓рзЗ built-in validation (required, type check) execute рж╣рждрзЛ ржирж╛ред

ЁЯФ╕ `this.clean()` ржжрж┐рж▓рзЗ рж╕рзЗ ржирж┐ржЬрзЗрж░ ржорж╛ржирзЗ ржпрзЗржЯрж╛ ржЪрж╛ржЗрж▓рзНржб ржП ржмрж╛ржирж╛ржЗржЫрж┐ рж╕рзЗржЯрж╛ ржХрж▓ recersive behave ржХрж░рждрзЛред ржХрж░рждрзЛ ржЖрж╕рж▓
ржмрж┐рж▓рзНржб ржЗржи ржХрзНрж▓рж┐ржи ржХрж▓ ржХрж░рждрзЛ ржирж╛ ржпрж╛рж░ ржлрж▓рзЗ clean_data ржирж╛ржорзЗ dict ржЯрж╛ржУ ржкрзЗрждрж╛ржо ржирж╛ ржпрзЗржЯрж╛ ржмрж╛ ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯрзЗ ржбрж╛ржЯрж╛ржЧрзБрж▓рж╛рж░
dict ржмрж╛ржирж╛ржЗрзЯрж╛ store ржХрж░рзЗредржЖрж░ ржХрж▓ ржирж╛ ржХрж░рж▓рзЗ `defauld validation` ржУ ржкрж╛ржЗрждрж╛ржо ржирж╛ clean_dict ржУ ржкрж╛ржЗрждрж╛ржо ржирж╛ред

ЁЯФ╕ custom clean method ржП рж╢рзБржзрзБ return ржХрж░рж▓рзЗ рж╣ржмрзЗ ржирж╛, ржЖржорж╛ржжрзЗрж░ add_error ржмрж╛ raise ValidationError ржжрж┐рзЯрзЗ ржнрзБрж▓
ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рждрзЗ рж╣ржмрзЗред

ЁЯФ╕ clean() ржорзЗржержб ржмрзНржпрж╛ржирж╛рж░ ржЙржжрзНржжрзЗрж╢ ржлрж░рзНржо ржПрж░ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржб ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рж╛ ржмрж╛ ржлрзБрж▓ ржлрж░рзНржо ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рж╛ ржПржмржВ
self.cleaned_data ржорзЛржбрж┐ржлрж╛ржЗ ржХрж░рж╛ ржпржЦржи ржЖржорж░рж╛ cleaned_data=super().clean() ржжрж┐рж▓рзЗ django ржПрж░ ржмрж┐рж▓рзНржб ржЗржи
cleared_data ржорзЛржбрж┐ржлрж╛ржЗ рж╣рзЯ ржХрж╛рж░ржг super().clean() cleaned_data dict рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗред рждржЦржи django clean()
ржПрж░ржерзЗржХрзЗ expectetion ржлрзБрж▓ржлрж┐рж▓ рж╣рзЯред ржЖрж░ ржПрж░ ржкрж░ ржЖрж░ ржУ ржпржжрж┐ ржорзЛржбрж┐ржлрж╛ржЗ ржХрж░рж┐ ржпрзЗржоржи cleaned_data["name"]=
cleaned_data["name"].upper() ржПржЯрж╛рж░ ржкрж░ ржЪрж╛ржЗрж▓рзЗ return cleaned_data ржжрж┐рж▓рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ ржирж╛ рж╣рж▓рзЗ django ржирж┐ржЬрзЗржЗ рждрж╛
ржХрж░рзЗ ржХрж╛рж░ржг ржПржЯрж╛ clean() ржорзЗржержб ржПрж░ behaveред рждрж╛ржЗ return ржжрзЗржУрзЯрж╛ ржЬрзБрж░рзБрж░рж┐ ржирж╛ optional

ЁЯФ╕ clean() Method

| ржмрзИрж╢рж┐рж╖рзНржЯрзНржп                          | ржмрзНржпрж╛ржЦрзНржпрж╛                                                              |
| ---------------------------------- | --------------------------------------------------------------------- |
| ржХржЦржи ржЪрж▓рзЗ?                           | рж╕ржм ржлрж┐рж▓рзНржбрзЗрж░ built-in ржУ field-level clean рж╢рзЗрж╖ рж╣ржУржпрж╝рж╛рж░ ржкрж░                 |
| рж╕ржм ржлрж┐рж▓рзНржбрзЗрж░ cleaned_data available? | тЬФя╕П рж╣рзНржпрж╛ржБ                                                              |
| return ржмрж╛ржзрзНржпрждрж╛ржорзВрж▓ржХ?                | тЭМ ржирж╛, return ржирж╛ ржХрж░рж▓рзЗржУ Django ржЖржЧрзЗрж░ `self.cleaned_data` ржЗржЙржЬ ржХрж░рзЗ        |
| return ржжрж┐рж▓рзЗ ржХрзА рж╣рзЯ?                 | ржкрзБрж░рзЛ `cleaned_data` override рж╣рзЯ                                       |
| ржХрж┐рж╕рзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ?            | multiple ржлрж┐рж▓рзНржб ржПржХрж╕рж╛ржерзЗ ржпрж╛ржЪрж╛ржЗ, cross-validation, ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржЗрждрзНржпрж╛ржжрж┐ |

ЁЯФ╕ Django ржПрж░ ржнрж┐рждрж░рзЗрж░ ржЖржЪрж░ржг (Internals): | Method | cleaned*data ржЖржЧрзЗ ржерзЗржХрзЗ ржерж╛ржХрзЗ? | ржХрзЛржи ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп
available? | return ржирж╛ ржжрж┐рж▓рзЗ ржХрж┐ рж╣рзЯ? | | ----------------- | ---------------------------- |
--------------------------- | ---------------------- | | `__init__()` | тЭМ ржирж╛ | ржХрж┐ржЫрзБржЗ ржерж╛ржХрзЗ ржирж╛ |
error рж╣рждрзЗ ржкрж╛рж░рзЗ | |
`clean*<field>()`| тЬФя╕П рж╢рзБржзрзБ ржУржЗ ржлрж┐рж▓рзНржб | ржЕржирзНржп ржлрж┐рж▓рзНржб ржирж╛ржУ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ | ржлрж┐рж▓рзНржб ржмрж╛ржж ржпрзЗрждрзЗ ржкрж╛рж░рзЗ | |`clean()` |
тЬФя╕П рж╕ржм ржлрж┐рж▓рзНржб | рж╕ржм ржлрж┐рж▓рзНржб | ржЖржЧрзЗрж░ cleaned_data ржзрж░рзЗ |

ЁЯФ╕ ржЙржжрж╛рж╣рж░ржг Diagram (Flow Summary):

```pgsql

тмЗя╕П User Input Form
        тмЗя╕П
is_valid() тЮбя╕П Form._clean_fields()
        тмЗя╕П
рзз. Field built-in validation
рзи. clean_<field>() тЮбя╕П return cleaned value
        тмЗя╕П
рзй. Form.clean() тЮбя╕П full cleaned_data modify/check
        тмЗя╕П
тЬФя╕П form.cleaned_data тЮбя╕П Final cleaned values

```

---

### ЁЯОп 3. Form Submission Handling (POST)

```python
if request.method == 'POST':
    form = MyForm(request.POST)
    if form.is_valid():
        # data = form.cleaned_data
        ... # process data
else:
    form = MyForm()

return render(request, 'form.html', {'form': form})
```

ЁЯФ╕ `form.is_valid()` false рж╣рж▓рзЗ cleaned_data ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ ржирж╛ред рждрж╛ржЗ form.errors ржжрзЗржЦрждрзЗ рж╣ржпрж╝ред

---

### ЁЯОп 4. `cleaned_data` vs `clean` method

| ржмрж┐рж╖рзЯ                | `cleaned_data`                               | `clean()` method (form-level validation)                     |
| ------------------- | -------------------------------------------- | ------------------------------------------------------------ |
| ЁЯУМ ржХрзА               | valid field ржЧрзБрж▓рзЛрж░ ржбрж┐ржХрж╢ржирж╛рж░рж┐                   | form ржПрж░ рж╕ржм ржлрж┐рж▓рзНржб ржПржХрж╕рж╛ржерзЗ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛рж░ ржЬржирзНржп method               |
| ЁЯФН ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ ржХржЦржи    | `form.is_valid()` рж╕ржлрж▓ рж╣рж▓рзЗ                    | `form.is_valid()` ржПрж░ рж╕ржорзЯржЗ call рж╣рзЯ                            |
| ЁЯУе ржХрзА рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ   | dictionary тЖТ `{field_name: value}`           | рж╕рж╛ржзрж╛рж░ржгржд `super().clean()` ржПрж░ result return ржХрж░рж╛ ржЙржЪрж┐ржд          |
| ЁЯУД Validation Scope | рж╢рзБржзрзБ field level validation ржПрж░ ржкрж░рзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ | ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛рж░ ржЬржирзНржп use рж╣рзЯ          |
| ЁЯТе Error Handling   | ржПржЦрж╛ржирзЗ error ржерж╛ржХрзЗ ржирж╛ (form.errors ржП ржерж╛ржХрзЗ)     | ржПржЦрж╛ржирзЗ error raise ржХрж░рждрзЗ рж╣рзЯ ржмрж╛ `self.add_error()` ржжрж┐рзЯрзЗ ржжрж┐рждрзЗ рж╣рзЯ |
| тЬЕ ржмрзНржпржмрж╣рж╛рж░ ржЙржжрж╛рж╣рж░ржг   | `form.cleaned_data['email']`                 | password ржПржмржВ confirm_password ржорж┐рж▓ ржЖржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рж╛           |

---

### ЁЯОп 5. `self.add_error()` vs `raise ValidationError`

| ржмрж┐рж╖рзЯ                     | `self.add_error()`                                                                                                    | `raise ValidationError()`                                                      |
| ------------------------ | --------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
| **ржкрзНрж░ржХрзГрждрж┐**              | Form ржмрж╛ ModelForm ржПрж░ method, validation error ржпрзБржХрзНржд ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ                                              | Exception ржпрж╛ validation error рж╣рж┐рж╕рзЗржмрзЗ ржЙржарж╛ржирзЛ рж╣рзЯ                                  |
| **ржмрзНржпржмрж╣рж╛рж░ ржХрзНрж╖рзЗрждрзНрж░**      | рж╕рж╛ржзрж╛рж░ржгржд `clean()` method ржмрж╛ `clean_<fieldname>()` method ржПрж░ ржоржзрзНржпрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржб ржмрж╛ ржкрзБрж░рзЛ ржлрж░рзНржорзЗ error ржпрзБржХрзНржд ржХрж░рж╛рж░ ржЬржирзНржп | field-level ржмрж╛ form-level validation ржП error ржШржЯрж▓рзЗ exception рж╣рж┐рж╕рзЗржмрзЗ ржЙржарж╛рждрзЗ рж╣рзЯ    |
| **ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░**          | рзиржЯрж┐ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ ржирзЗрзЯ: (field_name (string ржмрж╛ None), error_message)                                                     | рж╕рж╛ржзрж╛рж░ржгржд error message ржмрж╛ error list ржирзЗрзЯ                                        |
| **Error target**         | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ field ржПрж░ error рж╣рж┐рж╕рзЗржмрзЗ ржЕржержмрж╛ ржкрзБрж░рзЛ ржлрж░рзНржорзЗрж░ error рж╣рж┐рж╕рзЗржмрзЗ ржпрзБржХрзНржд ржХрж░рждрзЗ ржкрж╛рж░рзЗ (`field_name=None` ржжрж┐рж▓рзЗ ржлрж░рзНржо error)     | рж╕рж╛ржзрж╛рж░ржгржд ржкрзБрж░рзЛ form ржПрж░ validation error рж╣рж┐рж╕рж╛ржмрзЗ ржмрж┐ржмрзЗржЪрж┐ржд рж╣рзЯ                        |
| **Form validation flow** | error ржпрзЛржЧ ржХрж░рж▓рзЗржУ form ржПрж░ validation process ржЪрж▓рждрзЗ ржерж╛ржХрзЗ, ржЖржкржирж┐ ржПржХрж╛ржзрж┐ржХ error add ржХрж░рждрзЗ ржкрж╛рж░рзЗржи                                | ValidationError ржЙржарж╛ржирзЛ рж╣рж▓рзЗ validation рждрзОржХрзНрж╖ржгрж╛рзО ржерзЗржорзЗ ржпрж╛рзЯ, ржкрж░рзЗрж░ ржХрзЛржб execute рж╣рзЯ ржирж╛ |
| **Template ржП access**    | form.errors ржП ржпрзБржХрзНржд рж╣рзЯ, ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ errors рж╣рж┐рж╕рзЗржмрзЗ ржжрзЗржЦрж╛ ржпрж╛рзЯ                                                      | form.errors ржП ржЖрж╕рзЗ, рж╕рж╛ржзрж╛рж░ржгржд form-level error рж╣рж┐рж╕рзЗржмрзЗ ржжрзЗржЦрж╛ ржпрж╛рзЯ                    |
| **ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи?**   | ржПржХрж╛ржзрж┐ржХ field ржПрж░ ржЬржирзНржп error ржпрзЛржЧ ржХрж░рждрзЗ ржЪрж╛ржи, validation ржЪрж▓рж╛ржХрж╛рж▓рзАржи ржПржХрж╛ржзрж┐ржХ error ржжрзЗржЦрждрзЗ ржЪрж╛ржи                                   | ржПржХржХ critical error ржкрзЗрж▓рзЗ validation ржерж╛ржорж┐рзЯрзЗ ржжрж┐рждрзЗ ржЪрж╛ржи                             |

---

### ЁЯОп 6. `self.method()` vs `super().method()`

- `self.method()` тЖТ ржирж┐ржЬрзЗрж░ method ржЖржЧрзЗ ржЦрзБржБржЬржмрзЗ, ржирж╛ ржкрзЗрж▓рзЗ parent-ржП ржпрж╛ржмрзЗред
- `super().method()` тЖТ рж╕рж░рж╛рж╕рж░рж┐ parent-ржПрж░ method ржХрж▓ ржХрж░рзЗред

**Form ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ:**

```python
def clean(self):
    data = super().clean()  # super ржжрж┐рзЯрзЗ parent clean() call
```

---

### ЁЯОп 7. Form Widget Customize

ЁЯСЙЁЯП┐Modelform

```python
class ProductForm(forms.ModelForm):
    class Meta:
        model = Product
        fields = ['title', 'price']
        widgets = {
            'title': forms.TextInput(attrs={'class': 'form-control'}),
            'price': forms.NumberInput(attrs={'class': 'form-control'}),
        }
        labels = {
            'title': 'Product Name',
        }

```

ЁЯСЙ customform

```pthon
class MyForm(forms.Form):
    name = forms.CharField(labels='Product Name',widget=forms.TextInput(attrs={
        'class': 'form-control',
        'placeholder': 'Enter Name'
    }))
```

### ЁЯОп 8. BoundField ржПржмржВ `form['field']`

ЁЯФ╕ `form['field']` тЖТ BoundField object return ржХрж░рзЗред

ЁЯФ╕ BoundField object ржПрж░ `__str__` method ржЖржЫрзЗ ржпрж╛ template ржП `<input ...>` element render ржХрж░рзЗред

ЁЯФ╕ рждрж╛ржЗ template ржП `{{ form.field }}` ржмрж╛ `{{ form.field.errors }}` рж▓рж┐ржЦрж▓рзЗржЗ ржХрж╛ржЬ рж╣ржпрж╝ред

ЁЯФ╕ ржпржЦржи ржЯрзЗржорзНржкрж▓рзЗржЯ ржП ржЕржмржЬрзЗржХрзНржЯ ржмрж╛ dict ржХрж▓ ржХрж░рж╛ рж╣рзЯ рждржЦржи ржкрж╛ржЗржержи ржЕржЯрзЛржорзЗржЯрж┐ржХ рждрж╛рж░ str ржорзЗржержб ржХрж▓ ржХрж░рзЗ ржлрж░рзНржо ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ
ржПрж░ **str** ржорзЗржержб as_table method call ржХрж░рзЗ рждрж╛ржЗ ржЖржорж░рж╛ {{form}} рж▓рж┐ржЦрж▓рзЗ ржПржЯрж╛ рждрж╛рж░ str ржХрж▓ рж╣рзЯрзЗ as_table ржЖржХрж╛рж░рзЗ
рж░рзЗржирзНржбрж╛рж░ рж╣рзЯредржмрж╛рж╕рзНрждржмрзЗ form ржмрж╛ form.field рж╣рж▓рзЛ boundre_field object ржпрзЗржЦрж╛ржирзЗ ржЕржирзЗржХ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржУ ржорзЗржержб ржерж╛ржХрзЗ
ржпрзЗржоржи form.field.error ржПржХржЯрж╛ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ form.field.label_tag ржПржХржЯрж╛ property .

---

### ЁЯОп 9. `form.fields`

ЁЯФ╕ ржПржЯрж╛ ржПржХржЯрж╛ Dictionary ржпрж╛ `{ field_name: Field object }` ржЖржХрж╛рж░рзЗ ржерж╛ржХрзЗред ЁЯФ╕ рж╢рзБржзрзБржорж╛рждрзНрж░ raw Field Object
(CharField, IntegerField etc) access ржПрж░ ржЬржирзНржпред ЁЯФ╕ ржПржЯрж╛ Template ржП ржЗржЙржЬ рж╣рзЯ ржирж╛; template ржП ржЖржорж░рж╛
`form[field_name]` ржЗржЙржЬ ржХрж░рж┐ред

---

### ЁЯОп 10. Form Internal Structure Summary:

```python
form = MyForm()
form.fields         # dict of {name: Field instance}
form['name']        # BoundField object (renderable)
form.cleaned_data   # validated data dict (after is_valid())
form.errors         # dict of errors (after is_valid())
```

```python
# BoundField ржПрж░ ржорзВрж▓ржд ржПржЯрж╛
class BoundField:
    def __str__(self):
        return self.as_widget()
```

---

### ЁЯОп 11. Dunder Method `__getitem__`

```python
class Form:
    def __getitem__(self, name):
        return BoundField(self, self.fields[name], name)
```

ЁЯФ╕ ржПржЬржирзНржп ржЖржорж░рж╛ form\['field_name'] рж▓рж┐ржЦрж▓рзЗ рж╕рзЗ BoundField return ржХрж░рзЗред

---

### ЁЯОп 12. Template rendering & Styling

ЁЯФ╕ Custom HTML form ржП Bootstrap рж╕рж╣ styling ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗ:

```html
<form method="POST">
  {% csrf_token %}
  <div class="mb-3">{{ form.name.label_tag }} {{ form.name }} {{ form.name.errors }}</div>
</form>
```

---

### ЁЯОп 13. Form Rendering Process:

| Step | Action                                                                                             |
| ---- | -------------------------------------------------------------------------------------------------- |
| 1    | Request ржЖрж╕рзЗ form page ржП                                                                            |
| 2    | GET рж╣рж▓рзЗ blank form render ржХрж░рзЗ                                                                      |
| 3    | POST рж╣рж▓рзЗ `MyForm(request.POST)` instantiate ржХрж░рзЗ                                                    |
| 4    | `is_valid()` call рж╣рзЯ                                                                               |
| 5    | Valid рж╣рж▓рзЗ `cleaned_data` dict ржЖрж╕рзЗ ржПрж░ржкрж░ рж╕рзЗржн ржжрж┐рж▓рзЗ рждрж╛ model.object.create() ржЪрж╛рж▓рж┐рзЯрзЗ ржЕржмржЬрзЗржХрзНржЯ ржХрзНрж░рж┐ржЯрзЗ ржХрж░рзЗ |
| 6    | Template ржП BoundField ржПрж░ ржорж╛ржзрзНржпржорзЗ render рж╣рзЯ                                                         |
| 7    | Error рж╣рж▓рзЗ error dict `form.errors` render рж╣рзЯ                                                       |

---

## ЁЯФЪ Conclusion:

ржПржЗ handnote ржЯрж┐рждрзЗ Django Form Handling ржПрж░ almost рж╕ржм ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржмрж┐рж╖ржпрж╝ ржЖрж▓рзЛржЪржирж╛рж░ ржнрж┐рждрзНрждрж┐рждрзЗ рж▓рж┐ржкрж┐ржмржжрзНржз ржХрж░рж╛
рж╣ржпрж╝рзЗржЫрзЗред Future ржП ржПржХржмрж╛рж░ ржкржбрж╝рж▓рзЗржЗ рж╕ржм clear рж╣ржмрзЗ, ржПржмржВ ржПржЯрж╛ рж░рж┐ржнрж┐рж╢ржирзЗрж░ ржЬржирзНржп ржкрж╛рж░ржлрзЗржХрзНржЯред

## ЁЯНк тЬЕ Day 7: Authentication System

- Session authentication
- Django built-in auth
- Register, Login, Logout view
- login_required, messages

### ЁЯза рзз. Cookie ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

### тЬЕ Server ржерзЗржХрзЗ Cookie set:

```http
HTTP/1.1 200 OK
Set-Cookie: sessionid=abc123xyz; Path=/; HttpOnly
```

тЮбя╕П ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржмрзБржЭрзЗ ржпрж╛ржпрж╝ ржПржЯрж┐ ржПржХржЯрж┐ ржХрзБржХрж┐ ржПржмржВ рж╕рзЗржЯрж┐ рждрж╛рж░ internal cookie store-ржП рж╕рзЗржн ржХрж░рзЗред

### тЬЕ ржкрж░ржмрж░рзНрждрзА Request ржП:

```http
GET /dashboard HTTP/1.1
Host: example.com
Cookie: sessionid=abc123xyz
```

тЮбя╕П ржмрзНрж░рж╛ржЙржЬрж╛рж░ рж╕рзЗржЗ ржХрзБржХрж┐ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржкрж╛ржарж┐рзЯрзЗ ржжрзЗрзЯред

### тЬЕ Cookie ржкрж╛ржарж╛ржирзЛрж░ рж╢рж░рзНржд:

| рж╢рж░рзНржд         | ржмрзНржпрж╛ржЦрзНржпрж╛                                       |
| ------------ | ---------------------------------------------- |
| Domain match | ржХрзБржХрж┐ ржпрзЗржЗ ржбрзЛржорзЗржЗржи ржерзЗржХрзЗ ржПрж╕рзЗржЫрзЗ, рж╕рзЗржЗ ржбрзЛржорзЗржЗржирзЗ ржкрж╛ржарж╛ржмрзЗ |
| Path match   | ржХрзБржХрж┐ ржпрзЗржЗ path ржПрж░ ржЬржирзНржп рж╕рзЗржЯ, рж╕рзЗржЗ path-ржП ржкрж╛ржарж╛ржмрзЗ   |
| Secure       | рж╢рзБржзрзБржорж╛рждрзНрж░ HTTPS ржПрж░ ржЬржирзНржп ржкрж╛ржарж╛ржмрзЗ                 |
| HttpOnly     | JavaScript access ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛                |

### ЁЯФР рзи. Cookie ржжрж┐рзЯрзЗ Session ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

1. **User Login ржХрж░рж▓рзЗ**, Django ржПржХржЯрж╛ `sessionid` ржХрзБржХрж┐ рж╕рзЗржЯ ржХрж░рзЗред
2. ржПржЗ ржХрзБржХрж┐ ржмрзНрж░рж╛ржЙржЬрж╛рж░ рж╕рзЗржн ржХрж░рзЗ ржПржмржВ ржкрж░ржмрж░рзНрждрзА рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯрзЗ ржкрж╛ржарж╛рзЯред
3. Django ржПржЗ ржХрзБржХрж┐ ржжрзЗржЦрзЗ ржмрзБржЭрзЗ ржлрзЗрж▓рзЗ user ржХрзЗред
4. Django backend-ржП `/sessions/` table ржмрж╛ Redis-ржП session data рж░рж╛ржЦрзЗред

---

### ЁЯФР Django Authentication System

### ЁЯз╛ рзй. Built-in Auth Views

### тЬЕ Registration View:

```python
from django.contrib.auth.models import User

def register(request):
    if request.method == 'POST':
        username = request.POST['username']
        password = request.POST['password']
        User.objects.create_user(username=username, password=password)
        return redirect('login')
    return render(request, 'register.html')
```

### тЬЕ Login View:

```python
from django.contrib.auth import authenticate, login

def user_login(request):
    if request.method == 'POST':
        username = request.POST['username']
        password = request.POST['password']
        user = authenticate(username=username, password=password)
        if user is not None:
            login(request, user)  # Session рж╢рзБрж░рзБ рж╣рзЯ ржПржЦрж╛ржирзЗ
            return redirect('dashboard')
    return render(request, 'login.html')
```

### тЬЕ Logout View:

```python
from django.contrib.auth import logout

def user_logout(request):
    logout(request)  # reuest ржПрж░ ржЬржирзНржп sessionid ржирж┐рзЯрзЗ ржУржЗ ржЗржЙрж╕рж╛рж░ ржПрж░  Session Destroy ржХрж░рзЗ django ржПрж░ рж╕рзЗрж╢ржи ржбрж┐ржмрж┐ ржерзЗржХрзЗ ржПржирзНржб ржмрзНрж░ржорзЗрж░ ржПрж░ sessionid cookey null/remove  ржХрж░рзЗ ржжрзЗрзЯ
    return redirect('login')
```

---

### ЁЯЧВя╕П рзк. Session Authentication

тЬЕ Django session-based authentication ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

| ржзрж╛ржк | ржмрзНржпрж╛ржЦрзНржпрж╛                                  |
| --- | ----------------------------------------- |
| 1   | Login ржХрж░рж▓рзЗ session рждрзИрж░рж┐ рж╣рзЯ                |
| 2   | Django ржХрзБржХрж┐рждрзЗ `sessionid` ржкрж╛ржарж╛рзЯ           |
| 3   | ржмрзНрж░рж╛ржЙржЬрж╛рж░ рж╕рзЗржЗ ржХрзБржХрж┐ ржкрж╛ржарж╛рзЯ ржкрзНрж░рждрж┐ request ржП   |
| 4   | Django рж╕рзЗржЗ sessionid ржжрзЗржЦрзЗ user рж╕ржирж╛ржХрзНржд ржХрж░рзЗ |

---

ЁЯФД Diagram (рж╕ржВржХрзНрж╖рж┐ржкрзНржд)

```text
User Login тЖТ login(request, user)
              тЖУ
           session.save() тЖТ DB/session backend as {sessionid:xyz,user_id,abc, authentication_backend:"your auth backend setup"}
              тЖУ
           Set-Cookie: sessionid=xyz тЖР to browser

тЖТ User sends next request
     тЖУ
   Cookie: sessionid=xyz тЖР comes with request
     тЖУ
  SessionMiddleware gets session object from sesson DB by this sessionid cookey
     тЖУ
  AuthenticationMiddleware тЖТ
 get user object by sesson object user_id property and set
request.user = User instance

```

## ЁЯЫС рзл. @login_required,@user_passes_test Decorator and lamda

```python
from django.contrib.auth.decorators import login_required

@login_required
def dashboard(request):
    return render(request, 'dashboard.html')
```

тЮбя╕П ржПржЗ ржбрзЗржХрзЛрж░рзЗржЯрж░ check ржХрж░рзЗ user logged in ржХрж┐ржирж╛ред ржирж╛ ржерж╛ржХрж▓рзЗ login page ржП рж░рж┐ржбрж╛ржЗрж░рзЗржХрзНржЯ ржХрж░рзЗред

## ЁЯза `lambda` & `@user_passes_test` in Django (Handnote)

---

### тЬЕ `lambda` in Python

#### ЁЯФ╣ ржХрзА?

`lambda` рж╣рж▓рзЛ Python-ржПрж░ anonymous (ржирж╛ржорж╣рзАржи) ржПржХ рж▓рж╛ржЗржирзЗрж░ ржлрж╛ржВрж╢ржиред

#### ЁЯФ╣ Syntax:

```python
lambda arguments: expression
```

#### ЁЯФ╣ ржЙржжрж╛рж╣рж░ржг:

```python
add = lambda a, b: a + b
print(add(3, 5))  # Output: 8
```

#### ЁЯФ╣ ржмрзНржпржмрж╣рж╛рж░:

- ржЫрзЛржЯ ржлрж╛ржВрж╢ржи ржмрж╛ expression
- `map()`, `filter()`, `sorted()`, `decorator`, ржЗрждрзНржпрж╛ржжрж┐рж░ ржоржзрзНржпрзЗ
- ржХрзЛржерж╛ржпрж╝ ржПржХржмрж╛рж░рзЗрж░ ржЬржирзНржпрзЛ ржлрж╛ржВрж╢ржи рж▓рж╛ржЧрж▓рзЗ

#### ЁЯФ╣ Practical Example:

```python
squared = list(map(lambda x: x * x, [1, 2, 3]))
# Output: [1, 4, 9]
```

---

### тЬЕ `@user_passes_test` in Django

#### ЁЯФ╣ ржХрзА?

`@user_passes_test` рж╣ржЪрзНржЫрзЗ Django ржПрж░ ржПржХржЯрж╛ **decorator** ржпрж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ test ржжрж┐рзЯрзЗ **view
access control** ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

#### ЁЯФ╣ Syntax:

```python
from django.contrib.auth.decorators import user_passes_test

@user_passes_test(lambda u: u.is_superuser)
def my_view(request):
    ...
```

#### ЁЯФ╣ lambda u: u.is_superuser

ржПржЦрж╛ржирзЗ:

- `u` рж╣рж▓рзЛ `request.user`
- ржПржЯрж┐ check ржХрж░рзЗ user superuser ржХрж┐ ржирж╛

#### ЁЯФ╣ ржмрж┐ржХрж▓рзНржкржнрж╛ржмрзЗ (function ржжрж┐рзЯрзЗ):

```python
def is_admin(user):
    return user.is_superuser

@user_passes_test(is_admin)
def dashboard(request):
    ...
```

---

### ЁЯУМ ржХрзЛржерж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм?

- ржпрзЗрж╕ржм view-рждрзЗ ржЖржкржирж┐ ржЪрж╛ржи **рж╢рзБржзрзБ logged in user ржмрж╛ specific user type (admin/staff)** access ржХрж░рзБржХ
- Example:

  - `@user_passes_test(lambda u: u.is_authenticated)`
  - `@user_passes_test(lambda u: u.is_staff)`
  - `@user_passes_test(lambda u: u.is_superuser)`
  - `@user_passes_test(lambda u: u.is_active)`

---

### ЁЯЪл Access ржирж╛ ржкрзЗрж▓рзЗ ржХрзА рж╣рзЯ?

Default-ржнрж╛ржмрзЗ user рж╢рж░рзНржд ржирж╛ ржорж╛ржирж▓рзЗ рждрж╛ржХрзЗ **login page ржП redirect** ржХрж░рж╛ рж╣рзЯред рждрзБржорж┐ ржЪрж╛ржЗрж▓рзЗ custom redirect
URL ржУ ржжрж┐рждрзЗ ржкрж╛рж░рзЛ:

```python
@user_passes_test(lambda u: u.is_superuser, login_url='/no-access/')
```

---

### ЁЯж╛ рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржирж┐рзЯржо:

| ржмрж┐рж╖ржпрж╝               | ржХрж╛ржЬ              | ржмрзНржпржмрж╣рж╛рж░             |
| ------------------- | ---------------- | ------------------- |
| `lambda`            | ржПржХ рж▓рж╛ржЗржирзЗрж░ ржлрж╛ржВрж╢ржи  | Python & callback   |
| `@user_passes_test` | User ржХрзЗ test ржХрж░рзЗ | Django view control |

---

### тЬЕ Common Example:

```python
from django.contrib.auth.decorators import user_passes_test

@user_passes_test(lambda user: user.is_authenticated)
def profile_view(request):
    ...
```

---

## ЁЯЦЪ рж╢рзЗрж╖ ржХржерж╛:

- **`lambda`** тЖТ ржЫрзЛржЯ ржлрж╛ржВрж╢ржирзЗрж░ рж╢рж░рзНржЯржХрж╛рж░рзНржЯ
- **`@user_passes_test`** тЖТ view ржХрзЗ protect ржХрж░рж╛рж░ tool
- ржжрзБржЯрзЛржЗ powerful & Pythonic ЁЯРН

---

## ЁЯТм рзм. Django Messages Framework

### тЬЕ ржЙржжрж╛рж╣рж░ржг:

```python
from django.contrib import messages
from django.shortcut import redirect

def login_view(request):
    if request.method == 'POST':
        # ...
        if user is not None:
            login(request, user)
            messages.success(request, 'Login successful!')
            return redirect("messages")

        else:
            messages.error(request, 'Invalid credentials')
            return redirect("messages")
```

### тЬЕ template ржП ржжрзЗржЦрж╛рждрзЗ:

```html
{% for message in messages %}
<div class="alert">{{ message }}</div>
{% endfor %}
```

---

### `тЬЕ рж╕ржм ржорзЗржержб + ржХржорж╛ржирзНржб ржПржмржВ ржПржЧрзБрж▓рж╛рж░ ржХрж╛ржЬ`

| ржмрж┐рж╖рзЯ                                                            | ржХрж╛ржЬ                                                                                                                                                                                                                                                                                                                |
| --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Cookie                                                          | ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржПржмржВ рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ ржоржзрзНржпрзЗ ржбрзЗржЯрж╛ рж╕ржВрж░ржХрзНрж╖ржгрзЗрж░ ржорж╛ржзрзНржпржо                                                                                                                                                                                                                                                                 |
| Set-Cookie                                                      | Server -> Browser: ржХрзБржХрж┐ рж╕рзЗржЯ ржХрж░рж╛рж░ ржХржорж╛ржирзНржб                                                                                                                                                                                                                                                                            |
| Cookie header                                                   | Browser -> Server: ржХрзБржХрж┐ ржкрж╛ржарж╛ржирзЛрж░ ржЬржирзНржп                                                                                                                                                                                                                                                                               |
| Session                                                         | Server-side storage, user ржХрзЗ track ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ                                                                                                                                                                                                                                                                |
| login()                                                         | Django session рж╢рзБрж░рзБ/make ржХрж░рзЗ, ржХрзБржХрж┐ рж╕рзЗржЯ ржХрж░рзЗ set_cookey ржжрж┐рзЯрж╛ ржПржмржВ sesssion middleware ржкрзНрж░рждрж┐ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржЕржирзБржпрж╛рзЯрзА рждрж╛рж░ ржоржзрзНржпрзЗ ржмрзНрж░рж╛ржЙрж╕рж╛рж░ ржерзЗржХрзЗ ржкрж╛ржарж╛ржирзЛ sessionid ржХрзБржХрж┐ ржЕржирзБржпрж╛рзЯрзА django sesson ржбрж┐ржмрж┐ рж╣рждрзЗ ржЗржЙрж╕рж╛рж░ fetch ржХрж░рзЗ request.user ржП рж╕рзЗржЗ user ржЕржмржЬрзЗржХрзНржЯ ржкрж╛ржарж╛рзЯ рждрж╛ржЗ ржЖржорж░рж╛ template ржП request.user.username ржжрж┐рж▓рзЗ рж▓ржЧржЗржи ржЗржЙрж╕рж╛рж░ ржПрж░ ржирж╛ржо ржкрж╛ржЗ |
| logout(request)                                                 | request ржЕржмржЬрзЗржХрзНржЯ ржП ржерж╛ржХрж╛ sessionid ржПрж░ ржЬржирзНржп ржпрзЗржЗ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ рж╕рзЗрж╢ржи ржП ржЖржЪрзЗ рж╕рзЗржЗ Session ржЕржмржЬрзЗржХрзНржЯ destroy ржХрж░рзЗред ржХрж░рзЗ                                                                                                                                                                                                           |
| authenticate(request,username="something",password="something") | authenticate ржХрж░рзЗ ржпржжрж┐ ржПржЗ ржЗржиржлрж░ржорзЗрж╢ржи ржП ржХрзЛржи ржЗржЙрж╕рж╛рж░ ржкрж╛рзЯ рждрж╛рж╣рж▓рзЗ User object return ржХрж░рзЗ ржирж╛ рж╣рж▓рзЗ none return ржХрж░рзЗ                                                                                                                                                                                                               |
| @login_required(login_url="loginpage")                          | Authenticated user ржирж╛ рж╣рж▓рзЗ redirect ржХрж░рзЗ login_url ржП ржпрзЗржЗ ржЗржЙржЖрж░ржПрж▓ thake рж╕рзЗржЦрж╛ржирзЗ рж░рж┐ржбрж╛ржЗрж░рзЗржХрзНржЯ ржХрж░рзЗред                                                                                                                                                                                                                         |
| messages                                                        | User feedback display ржХрж░рждрзЗ flash ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛рзЯ рж░рж┐ржЯрж╛рж░рзНржи ржкрзЗржЬ ржП ржпрж╛ ржПржХржмрж╛рж░ ржПрж░ ржЬржирзНржп ржжрзЗржЦрж╛рзЯ ржПржирзНржб ржПржЯрж╛ рж╕рзЗрж╢ржи ржмрзЗрж╕ржб рждрж╛ржЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржЕржмржЬрзЗржХрзНржЯ ржкрж╛ржарж╛рждрзЗ рж╣рзЯ ржПржХржмрж╛рж░ рж╢рзЛ ржХрж░рж▓рзЗ рж╕рзЗрж╢ржи ржерзЗржХрзЗ ржбрзЗрж╕рзНржЯрзНрж░рзЯ рж╣рзЯ ржЖрж░ рж╕рзАржи ржирж╛ ржХрж░рж╛ ржкрж░рзНржпржирзНржд рж░рж┐ржлрзНрж░рзЗрж╢ ржХрж░рж▓рзЗржУ ржорзЗрж╕рзЗржЬ ржерзЗржХрзЗржЗ ржпрж╛рзЯред                                                                                      |

---

# тЬЕ Django Custom User Model Handnote (Day 08)

## ЁЯФ░ Custom User Model ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм?

Django-ржПрж░ default user model ржЕржирзЗржХ рж╕ржорзЯ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░рзЯрзЛржЬржи ржЕржирзБржпрж╛рзЯрзА field (ржпрзЗржоржи: phone_number,
profile_image ржЗрждрзНржпрж╛ржжрж┐) рж░рж╛ржЦрж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗрзЯ ржирж╛ред рждрж╛ржЗ ржЖржорж░рж╛ custom user model ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ ржпрж╛рждрзЗ user model
ржирж┐ржЬрзЗрж░ ржорждрзЛ modify ржХрж░рж╛ ржпрж╛рзЯред

---

## ЁЯФ╣ AbstractUser vs AbstractBaseUser

| Topic           | AbstractUser                           | AbstractBaseUser                   |
| --------------- | -------------------------------------- | ---------------------------------- |
| Inherits        | Django's built-in User model           | Only Base user class               |
| Fields          | Default fields (username, email, etc.) | Must define all fields manually    |
| Easier to use?  | тЬЕ рж╣рзНржпрж╛ржБ (prebuilt features ржкрзЗрзЯрзЗ ржпрж╛ржм)  | тЭМ ржирж╛ (рж╕ржм manually define ржХрж░рждрзЗ рж╣рзЯ) |
| Password System | Built-in ржЖржЫрзЗ                           | ржирж┐ржЬрзЗ implement ржХрж░рждрзЗ рж╣рзЯ             |

---

## ЁЯФ╣ Custom User Model ржП ржХрзА ржХрзА ржерж╛ржХрждрзЗ рж╣ржмрзЗ?

1. AbstractUser ржерзЗржХрзЗ extend ржХрж░рж╛ Model:

```python
class CustomUser(AbstractUser):
    phone_number = models.CharField(max_length=20)
    profile_image = models.ImageField(upload_to='profile/', blank=True, null=True)
```

2. Custom Manager рждрзИрж░рж┐ ржХрж░рждрзЗ рж╣ржмрзЗ:

```python
class CustomUserManager(BaseUserManager):
    def create_user(self, username, email, password=None, **extra_fields):
        if not email:
            raise ValueError('Users must have an email address')
        email = self.normalize_email(email)
        user = self.model(username=username, email=email, **extra_fields)
        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, username, email, password=None, **extra_fields):
        extra_fields.setdefault('is_superuser', True)
        extra_fields.setdefault('is_staff', True)
        return self.create_user(username, email, password, **extra_fields)
```

3. Custom User Model ржП Manager ржпрзБржХрзНржд ржХрж░рждрзЗ рж╣ржмрзЗ:

```python
class CustomUser(AbstractUser):
    phone_number = models.CharField(max_length=20)
    profile_image = models.ImageField(upload_to='profile/', blank=True, null=True)

    objects = CustomUserManager()  # Custom Manager ржпрзБржХрзНржд ржХрж░рж╛ рж╣рж▓рзЛ
```

4. settings.py ржП ржЬрж╛ржирж╛рждрзЗ рж╣ржмрзЗ:

```python
AUTH_USER_MODEL = 'yourapp.CustomUser'
```

---

## Django Profile Page

````markdown
# Django Profile Page рждрзИрж░рж┐рж░ ржЧрж╛ржЗржб (request.user ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ)

## ржнрзВржорж┐ржХрж╛

ржПржЗ ржЧрж╛ржЗржбрзЗ рж╢рзЗржЦрж╛ржирзЛ рж╣ржмрзЗ ржХрж┐ржнрж╛ржмрзЗ Django ржПрж░ built-in `request.user` ржЕржмржЬрзЗржХрзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЬржи рж▓ржЧржЗржиржХрзГржд
ржЗржЙржЬрж╛рж░рзЗрж░ ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржкрзЗржЬ рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛рзЯред

---

## рзз. URL Configuration

ржкрзНрж░ржержорзЗ рждрзЛржорж╛рж░ `urls.py` ржлрж╛ржЗрж▓рзЗ ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржкрзЗржЬрзЗрж░ URL ржПржирзНржЯрзНрж░рж┐ ржжрж┐рждрзЗ рж╣ржмрзЗ:

```python
from django.urls import path
from . import views

urlpatterns = [
    path('profile/', views.profile_view, name='profile'),
]
```
````

---

## рзи. View Function

`views.py` ржлрж╛ржЗрж▓рзЗ `profile_view` ржлрж╛ржВрж╢ржи рждрзИрж░рж┐ ржХрж░рзЛ:

```python
from django.shortcuts import render
from django.contrib.auth.decorators import login_required

@login_required  # ржирж┐рж╢рзНржЪрж┐ржд ржХрж░ржмрзЗ ржЗржЙржЬрж╛рж░ рж▓ржЧржЗржи ржЖржЫрзЗ
def profile_view(request):
    user = request.user
    context = {
        'user': user,
    }
    return render(request, 'profile.html', context)
```

---

## рзй. Template ржлрж╛ржЗрж▓ (profile.html)

`templates` ржлрзЛрж▓рзНржбрж╛рж░рзЗ `profile.html` рждрзИрж░рж┐ ржХрж░рзЛ:

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{ user.username }} ржПрж░ ржкрзНрж░рзЛржлрж╛ржЗрж▓</title>
  </head>
  <body>
    <h1>ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржкрзЗржЬ</h1>
    <p><strong>ржирж╛ржо:</strong> {{ user.get_full_name }}</p>
    <p><strong>ржЗржорзЗржЗрж▓:</strong> {{ user.email }}</p>
    <p><strong>ржЗржЙржЬрж╛рж░ржирзЗржо:</strong> {{ user.username }}</p>
    <!-- ржкрзНрж░рзЯрзЛржЬржиржорждрзЛ ржЖрж░ржУ ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЛ -->
  </body>
</html>
```

---

## рзк. Authentication Setup

- ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЛ рждрзЛржорж╛рж░ settings.py-рждрзЗ `LOGIN_URL` рж╕ржарж┐ржХ ржЖржЫрзЗ (ржпрзЗржоржи: `/accounts/login/`)
- рж▓ржЧржЗржи ржЫрж╛рзЬрж╛ ржХрзЗржЙ ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржкрзЗржЬрзЗ ржпрзЗрждрзЗ ржирж╛ ржкрж╛рж░рзЗ ржПржЬржирзНржп `@login_required` ржбрзЗржХрзЛрж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

---

### рж╣рзНржпрж╛ржирзНржбржирзЛржЯ (Handnote)

```html
<div style="border:1px solid #ccc; padding:10px; background:#f9f9f9; position: relative;">
  <h3>Quick Tips</h3>
  <pre id="handnote-text" style="white-space: pre-wrap; word-wrap: break-word;">
1. ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржкрзЗржЬ рж╢рзБржзрзБржорж╛рждрзНрж░ рж▓ржЧржЗржи ржХрж░рж╛ ржЗржЙржЬрж╛рж░рзЗрж░ ржЬржирзНржпред
2. request.user ржжрж┐рзЯрзЗ рж╕рж╣ржЬрзЗржЗ ржЗржЙржЬрж╛рж░рзЗрж░ ржбрж╛ржЯрж╛ ржкрж╛ржУржпрж╝рж╛ ржпрж╛рзЯред
3. @login_required ржбрзЗржХрзЛрж░рзЗржЯрж░ ржЗржЙржЬрж╛рж░ржХрзЗ рж▓ржЧржЗржи ржХрж░рж╛рждрзЗ ржмрж╛ржзрзНржп ржХрж░рзЗред
4. user.get_full_name() ржирж╛ржо ржжрзЗржЦрж╛ржирзЛрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред
5. ржЗржорзЗржЗрж▓, ржЗржЙржЬрж╛рж░ржирзЗржо рж╕ржм ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ request.user ржерзЗржХрзЗред
</pre
  >
  <button
    id="copy-btn"
    style="position: absolute; top: 10px; right: 10px; padding: 4px 10px; cursor: pointer;"
  >
    Copy
  </button>
</div>

<script>
  document.getElementById('copy-btn').addEventListener('click', function () {
    const text = document.getElementById('handnote-text').innerText
    navigator.clipboard
      .writeText(text)
      .then(() => {
        alert('Handnote copied!')
      })
      .catch(() => {
        alert('Copy failed, please copy manually.')
      })
  })
</script>
```

---

## ЁЯФ╣ Model.objects.create vs Model()

| Model.objects.create                   | Model() + save()                     |
| -------------------------------------- | ------------------------------------ |
| Object рждрзИрж░рж┐ ржУ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ DB-рждрзЗ save ржХрж░рзЗ | Object рждрзИрж░рж┐ рж╣рзЯ, ржкрж░рзЗ `save()` ржжрж┐рждрзЗ рж╣рзЯ |
| Internal call ржХрж░рзЗ `.save()`            | Manually `obj.save()` ржжрж┐рждрзЗ рж╣рзЯ        |

---

## ЁЯФ╣ set_password() ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖрж╕рзЗ?

- ржПржЯрж┐ `AbstractBaseUser` ржПрж░ instance methodред
- ржПрж░ ржорж╛ржзрзНржпржорзЗ password hashed ржХрж░рзЗ save ржХрж░рж╛ рж╣рзЯред

---

## ЁЯФ╣ extra_fields ржХрж╛ржЬ ржХрзА ржХрж░рзЗ?

```python
extra_fields = {"is_superuser": True, "is_staff": True}
```

- `user = self.model(username, email, **extra_fields)` тЖТ ржПрж░ ржорж╛ржирзЗ:

  ```python
  user = self.model(username=username, email=email, is_superuser=True, is_staff=True)
  ```

- ржПржЯрж┐ dictionary spread ржХрж░рзЗ additional fields assign ржХрж░рзЗред
- Python ржП `**kwargs` тЖТ keyword arguments dict ржЖржХрж╛рж░рзЗ ржирзЗрзЯред

---

## ЁЯФ╣ extra_fields.setdefault()

- Python dictionary ржПрж░ built-in method

```python
extra_fields.setdefault('is_superuser', True)
```

- ржпржжрж┐ key `is_superuser` ржирж╛ ржерж╛ржХрзЗ рждржмрзЗ `True` set ржХрж░ржмрзЗред

---

## ЁЯФ╣ ValueError ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖрж╕рзЗ?

- Python built-in exceptionред Import ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ ржирж╛ржЗред

```python
raise ValueError("Users must have an email address")
```

---

## ЁЯФ╣ model manager / object manager ржХрж┐?

- ржкрзНрж░рждрж┐ржЯрж┐ Model ржПрж░ рж╕рж╛ржерзЗ `objects` ржирж╛ржорзЗ default manager ржерж╛ржХрзЗ:

```python
User.objects.all()
User.objects.filter()
```

- ржЖржорж░рж╛ ржЪрж╛ржЗрж▓рзЗ Custom Manager рждрзИрж░рж┐ ржХрж░рзЗ `.objects` override ржХрж░рждрзЗ ржкрж╛рж░рж┐ред
- Custom Query behaviors define ржХрж░рждрзЗ ржкрж╛рж░рж┐ред
- Manager override ржХрж░рж╛рж░ ржЙржжрж╛рж╣рж░ржг:

```python
class ActiveUserManager(models.Manager):
    def get_queryset(self):
        return super().get_queryset().filter(is_active=True)
```

---

## ЁЯФ╣ UserCreationForm extend ржХрж░рж╛рж░ ржХрж╛рж░ржг?

- `UserCreationForm` Django ржПрж░ built-in form ржпрзЗржЯрж╛ automatic ржХрж┐ржЫрзБ validation (`clean_username`,
  `clean_password2`, etc) provide ржХрж░рзЗред
- Custom User Form рждрзИрж░рж┐ ржХрж░рж╛рж░ рж╕ржорзЯ ржПржЯрж┐ inherit ржХрж░рж▓рзЗ default validation system active ржерж╛ржХрзЗред

---

## ЁЯФ╣ USERNAME_FIELD vs REQUIRED_FIELDS

| Field           | ржХрж╛ржЬ                                                      |
| --------------- | -------------------------------------------------------- |
| USERNAME_FIELD  | ржХрзЛржи field ржжрж┐рзЯрзЗ user authenticate рж╣ржмрзЗ (default: username) |
| REQUIRED_FIELDS | createsuperuser ржЪрж▓рж╛ржХрж╛рж▓рзЗ ржпрзЗ fields ржЪрж╛ржЗ рждрж╛ define ржХрж░рж╛      |

```python
USERNAME_FIELD = 'email'
REQUIRED_FIELDS = ['username']
```

---

## ЁЯФ╣ Authentication Backend рж╕рзЗржЯ ржХрж░рж╛:

```python
AUTHENTICATION_BACKENDS = [
    'django.contrib.auth.backends.ModelBackend',
]
```

---

### тЬЕ ржЖржкржирж┐ ржХрж┐ ржмрзБржЭрзЗржЫрзЗржи?

- CustomUser ржХрзЗржи ржжрж░ржХрж╛рж░
- Manager ржХрж┐ ржУ ржХрзЗржи override ржХрж░рждрзЗ рж╣рзЯ
- Model vs Model.objects.create ржкрж╛рж░рзНржержХрзНржп
- set_password ржПрж░ ржкрзЗржЫржирзЗрж░ ржХрж╛рж╣рж┐ржирзА
- extra_fields ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ
- CustomUserManager ржХрж┐ ржУ ржХрзЗржи ржжрж░ржХрж╛рж░
- AUTH_USER_MODEL ржХрзЛржерж╛рзЯ рж╕рзЗржЯ ржХрж░рждрзЗ рж╣рзЯ

---

---

## тЬЕ Day 9: Middleware & Decorator

- Custom middleware ржХрзА ржПржмржВ ржХрж┐ржнрж╛ржмрзЗ ржмрж╛ржирж╛ржирзЛ ржпрж╛рзЯ
- Custom Decorator ржХрзА ржПржмржВ ржХрж┐ржнрж╛ржмрзЗ ржмрж╛ржирж╛ржирзЛ ржпрж╛рзЯ
- Decorator ржУ Permission based view

### тЬЕ Part 1: Middleware

#### ЁЯза Middleware ржХрзА?

Middleware рж╣рж▓рзЛ Django-ржПрж░ ржПржоржи ржПржХ рж╕рж┐рж╕рзНржЯрзЗржо ржпрзЗржЦрж╛ржирзЗ рждрзБржорж┐ HTTP request ржПржмржВ response ржПрж░ ржорж╛ржЭржЦрж╛ржирзЗ **extra ржХрж╛ржЬ
(logic)** ржХрж░рждрзЗ ржкрж╛рж░рзЛред

> ЁЯОп ржоржирзЗ рж░рж╛ржЦрзЛ: Middleware = Request & Response ржПрж░ ржорж╛ржЭржЦрж╛ржирзЗ ржжрж╛ржБрзЬрж┐рзЯрзЗ ржирж┐рзЯржирзНрждрзНрж░ржг ржХрж░рж╛ред

---

#### ЁЯзй Django Middleware ржХржЦржи ржЪрж▓рзЗ?

1. **Request ржЖрж╕рж▓рзЗ** тЖТ Middleware ржЖржЧрзЗ ржЪрж▓рзЗ тЖТ рждрж╛рж░ржкрж░ View ржлрж╛ржВрж╢ржирзЗ ржпрж╛рзЯ
2. **Response рж░рж┐ржЯрж╛рж░рзНржи рж╣рж▓рзЗ** тЖТ Middleware ржЖржмрж╛рж░ ржХрж╛ржЬ ржХрж░рзЗ тЖТ рждрж╛рж░ржкрж░ Client ржП ржкрж╛ржарж╛рзЯ

---

#### ЁЯФз ржХрзЗржи Middleware ржжрж░ржХрж╛рж░?

рждрзБржорж┐ View-ржП ржЕржирзЗржХ ржХрж╛ржЬ ржХрж░рждрзЗ ржкрж╛рж░рзЛ ржарж┐ржХ, ржХрж┐ржирзНрждрзБ Middleware ржПрж░ ржХрж┐ржЫрзБ Extra рж╕рзБржмрж┐ржзрж╛:

| рж╕рзБржмрж┐ржзрж╛                              | ржХрж╛рж░ржг                                  |
| ----------------------------------- | ------------------------------------- |
| Request ржЖрж╕рж╛рж░ ржЖржЧрзЗржЗ check ржХрж░рж╛ ржпрж╛рзЯ     | ржпрзЗржоржи user authenticated ржХрж┐ржирж╛          |
| View execute рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ ржХрж╛ржЬ ржХрж░рж╛ ржпрж╛рзЯ | IP blacklist ржХрж░рж╛, custom logging      |
| Response modify ржХрж░рж╛ ржпрж╛рзЯ             | HTML footer ржпрзЛржЧ ржХрж░рж╛, CORS header ржжрзЗрзЯрж╛ |
| рж╕ржм View-рж░ ржЖржЧрзЗржЗ ржмрж╛ ржкрж░рзЗ ржХрж╛ржЬ ржХрж░рзЗ       | common ржХрж╛ржЬ ржмрж╛рж░ржмрж╛рж░ ржирж╛ рж▓рж┐ржЦрждрзЗ            |

---

### ЁЯПЧя╕П Custom Middleware ржмрж╛ржирж╛ржирзЛ (Function-Based)

### тЬЕ Step-by-step:

```python
# myapp/middleware.py

def my_middleware(get_response):
    print("ЁЯСЙ Middleware Initialized")

    def middleware(request):
        print("ЁЯФ╣ Request Middleware: view-ржПрж░ ржЖржЧрзЗ")
        response = get_response(request)
        print("ЁЯФ╕ Response Middleware: view-ржПрж░ ржкрж░рзЗ")
        return response

    return middleware
```

#### ЁЯФН ржХрзА ржХрзА ржмрзНржпржмрж╣рж╛рж░ рж╣рж▓рзЛ?

| ржЬрж┐ржирж┐рж╕                              | ржХрж╛ржЬ                                                     |
| ---------------------------------- | ------------------------------------------------------- |
| `get_response`                     | ржПржЯрж╛ рж╣рж▓рзЛ рж╕рзЗржЗ function ржпрзЗржЯрж╛ request ржирж┐рзЯрзЗ View-ржХрзЗ call ржХрж░рзЗ |
| `request`                          | HTTP request object                                     |
| `response = get_response(request)` | View function ржХрзЗ call ржХрж░рзЗ, рждрж╛рж░ result ржзрж░рзЗ               |
| return response                    | Client ржХрзЗ response ржкрж╛ржарж╛рзЯ                                |

---

#### тЪая╕П ржпржжрж┐ `get_response(request)` ржирж╛ ржжрж┐рждрж╛ржо?

View ржХржЦржирзЛржЗ execute рж╣рждрзЛ ржирж╛ред рждрзЛржорж╛рж░ middleware рж╢рзБржзрзБ request ржкрзЗржд, ржХрж┐ржирзНрждрзБ response рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рждрзЛ ржирж╛ тАФ
Server рж╣рзНржпрж╛ржВ рж╣рзЯрзЗ ржпрзЗрждред

---

#### ЁЯФЧ settings.py-рждрзЗ ржпрзБржХрзНржд ржХрж░рзЛ:

```python
MIDDLEWARE = [
    ...
    'myapp.middleware.my_middleware',
]
```

---

### ЁЯПЧя╕П Custom Middleware (Class-Based)

#### тЬЕ Syntax:

```python
class MyMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response
        print("ЁЯСЙ Middleware Initialized")

    def __call__(self, request):
        print("ЁЯФ╣ Request Middleware: view-ржПрж░ ржЖржЧрзЗ")
        response = self.get_response(request)
        print("ЁЯФ╕ Response Middleware: view-ржПрж░ ржкрж░рзЗ")
        return response
```

#### ЁЯза ржмрзНржпрж╛ржЦрзНржпрж╛:

| Method         | ржХрж╛ржЬ                                     |
| -------------- | --------------------------------------- |
| `__init__`     | middleware setup рж╣рзЯ ржпржЦржи Django start рж╣рзЯ |
| `get_response` | View ржХрзЗ call ржХрж░рж╛рж░ function              |
| `__call__`     | ржкрзНрж░рждрж┐ржмрж╛рж░ request ржП middleware ржЪрж╛рж▓рж╛рзЯ     |
| `request`      | HTTPRequest object                      |
| `response`     | View ржПрж░ return                          |

---

#### тЭУ ржХрзЗржи `__call__()` рж▓рж╛ржЧрзЗ?

Django middleware instance ржХрзЗ function-ржПрж░ ржорждрзЛ call ржХрж░рзЗ: `middleware_instance(request)` `__call__` ржирж╛
ржжрж┐рж▓рзЗ, middleware request handle ржХрж░рждрзЗ ржкрж╛рж░рждрзЛ ржирж╛редЁЯСЙ Middleware class ржПрж░ **call** рж╣рж▓ python ржПрж░ ржмрж┐рж▓рзНржб ржЗржи
ржПржХржЯрж┐ special dunder method ржпрзЗржЯрж╛ class ржПрж░ instance ржХрзЗ function-ржПрж░ ржорждрзЛ call ржХрж░рж╛рж░ ржХрзНрж╖ржорждрж╛ ржжрзЗрзЯредinstance
ржХрзЗ ржлрж╛ржВрж╢ржирзЗрж░ ржорждрзЛ call ржХрж░рж▓рзЗ **call**() method execute рж╣рзЯред ржпрж╛ ржПржХржЯрж╛ ржнрж┐ржЙ function рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ ржбрзЗржХрзЛрж░рзЗржЯрж░
ржпрзЗржоржи ржХрж░рзЗ ржХрж╛рж░ржг ржЖржорж░рж╛ ржЬрж╛ржирж┐ ржпрзЗ middleware ржПржХ ржзрж░ржгрзЗрж░ ржмрж┐рж╢рзЗрж╖ ржбрзЗржХрзЛрж░рзЗржЯрж░ ржпрж╛рж░ рж╕рзНржкрзЗрж╢рж╛рж▓ ржХрж┐ржЫрзБ behave/power ржЖржЫрзЗред

---

#### ЁЯУМ ржХрзЛржерж╛рзЯ ржХрзЛржи ржХрзЛржб ржЪрж▓рзЗ?

| ржЬрж╛рзЯржЧрж╛                   | ржХрж╛ржЬ                                                |
| ----------------------- | -------------------------------------------------- |
| `__init__()`            | Django server start ржХрж░рж╛рж░ рж╕ржорзЯ ржЪрж▓рзЗ (ржПржХржмрж╛рж░)           |
| `__call__()`            | ржкрзНрж░рждрж┐ржмрж╛рж░ request ржЖрж╕рж▓рзЗ ржЪрж▓рзЗ                          |
| `get_response(request)` | View ржХрзЗ call ржХрж░рзЗ, рждрж╛рж░ржкрж░ view рж╢рзЗрж╖ рж╣рж▓рзЗ ржмрж╛ржХрж┐ code ржЪрж▓рзЗ |

---

#### ЁЯОБ Bonus: Middleware Hook ржЧрзБрж▓рзЛ

Class-based middleware-ржП ржЖрж░ржУ ржХрж┐ржЫрзБ hook ржерж╛ржХрзЗ:

| Method                        | ржХржЦржи ржЪрж▓рзЗ                          | ржХрж╛ржЬ                          |
| ----------------------------- | -------------------------------- | ---------------------------- |
| `process_view()`              | view function execute рж╣ржУржпрж╝рж╛рж░ ржЖржЧрзЗ | view check, arguments change |
| `process_exception()`         | ржпржжрж┐ exception рж╣рзЯ                 | error handle                 |
| `process_template_response()` | template response modify         |                              |

> тЪая╕П ржПржЧрзБрж▓рзЛ рж╢рзБржзрзБ old style middleware-ржП use рж╣рзЯ, Django 1.10+ ржП ржирждрзБржи style рж╣ржЪрзНржЫрзЗ `__init__`,
> `__call__`

---

---

### тЬЕ Part 2: Decorator

## ЁЯза Decorator ржХрзА?

Decorator рж╣ржЪрзНржЫрзЗ Python-ржПрж░ ржПржХржЯрж╛ ржлрж┐ржЪрж╛рж░, ржпрж╛ **function-ржПрж░ ржЙржкрж░рзЗ ржЖрж░рзЗржХржЯрж╛ function "рж▓рзЗржкрзЗ" ржжрзЗрзЯ**, ржпрзЗржи ржХрж┐ржЫрзБ
ржЕрждрж┐рж░рж┐ржХрзНржд ржХрж╛ржЬ рж╣рзЯред

---

## ЁЯОп Django-рждрзЗ ржХрзЗржи Decorator ржжрж░ржХрж╛рж░?

- ржПржХржЯрж╛ view-рж░ ржЖржЧрзЗ/ржкрж░рзЗ ржХрж╛ржЬ ржХрж░рждрзЗ
- User login check ржХрж░рждрзЗ
- Permission check ржХрж░рждрзЗ
- Custom logic add ржХрж░рждрзЗ

---

## ЁЯзй Custom Decorator ржмрж╛ржирж╛ржирзЛ (Step by Step)

### тЬЕ Basic Structure:

```python
from functools import wraps

def my_decorator(view_func):
    @wraps(view_func)
    def wrapper(request, *args, **kwargs):
        print("ЁЯФ╣ View ржПрж░ ржЖржЧрзЗ ржХрж┐ржЫрзБ ржХрж░рж▓рж╛ржо")
        response = view_func(request, *args, **kwargs)
        print("ЁЯФ╕ View ржПрж░ ржкрж░рзЗ ржХрж┐ржЫрзБ ржХрж░рж▓рж╛ржо")
        return response
    return wrapper
```

### ЁЯФН ржмрзНржпрж╛ржЦрзНржпрж╛:

| ржЬрж┐ржирж┐рж╕                      | ржХрж╛ржЬ                                          |
| -------------------------- | -------------------------------------------- |
| `@wraps(view_func)`        | ржорзВрж▓ function-ржПрж░ ржирж╛ржо ржУ docstring ржмржЬрж╛рзЯ рж░рж╛ржЦрзЗ    |
| `request, *args, **kwargs` | Django view function-ржП рж╕ржм argument ржзрж░рж╛рж░ ржЬржирзНржп |
| `view_func(request)`       | ржорзВрж▓ view ржХрзЗ call ржХрж░рзЗ                         |
| return response            | response ржХрзНрж▓рж╛рзЯрзЗржирзНржЯрзЗ ржкрж╛ржарж╛рзЯ                    |

---

### тЬЕ Custom Decorator Use ржХрж░рж╛рж░ ржирж┐рзЯржо:

```python
@my_decorator
def my_view(request):
    return HttpResponse("Hello from view")
```

---

#### тЭУDecorator ржЫрж╛рзЬрж╛ ржХрж┐ рж╕ржорзНржнржм?

рж╣рзНржпрж╛ржБ, ржХрж┐ржирзНрждрзБ ржкрзНрж░рждрж┐ржЯрж╛ view-рждрзЗ ржПржХржЗ code ржмрж╛рж░ржмрж╛рж░ рж▓рж┐ржЦрждрзЗ рж╣рждрзЛред DRY (Don't Repeat Yourself) ржнрж╛ржЩрждред

тЬЕ ржХржЦржи my_decorator() ржЪрж▓рзЗ, ржХржЦржи wrapper() ржЪрж▓рзЗ?

| ржлрж╛ржВрж╢ржи            | ржХржЦржи ржЪрж▓рзЗ                                                           |
| ---------------- | ----------------------------------------------------------------- |
| `my_decorator()` | ржпржЦржи Python рждрзЛржорж╛рж░ view ржХрзЗ decorate ржХрж░рзЗ (server start-ржПрж░ рж╕ржорзЯ ржПржХржмрж╛рж░) |
| `wrapper()`      | ржпржЦржи user request ржХрж░рзЗ ржПржмржВ decorated view call рж╣рзЯ                   |

#### Server start рж╣рж▓рзЗ

- рждрзЛржорж╛рж░ view ржХрзЗ decorate ржХрж░рзЗ (server start-ржПрж░ рж╕ржорзЯ ржПржХржмрж╛рж░)
- Django рждрзЛржорж╛рж░ рж╕ржм middleware read ржХрж░рзЗ (settings.py тЖТ MIDDLEWARE list ржерзЗржХрзЗ)

- ржкрзНрж░рждрж┐ржЯрж┐ middleware ржХрзЗ call ржХрж░рзЗ ржПржХржмрж╛рж░ тЖТ middleware_instance = middleware(get_response)

- ржПрж░ ржорж╛ржирзЗ ржкрзНрж░рждрж┐ржЯрж┐ middleware get_response ржХрзЗ wrap ржХрж░рзЗ ржирждрзБржи ржПржХржЯрж╛ callable return ржХрж░рзЗред

тЮбя╕П рж╕ржм middleware ржПржХржЯрж╛рж░ ржнрзЗрждрж░рзЗ ржЖрж░рзЗржХржЯрж╛ nested рж╣рзЯред

### ЁЯМА Middleware vs Decorator: ржкрж╛рж░рзНржержХрзНржп

| ржжрж┐ржХ                         | Middleware                           | Decorator                              |
| --------------------------- | ------------------------------------ | -------------------------------------- |
| ржмрзНржпржмрж╣рзГржд рж╣рзЯ                  | Django core request/response cycle-ржП | рж╢рзБржзрзБржорж╛рждрзНрж░ view ржлрж╛ржВрж╢ржирзЗрж░ ржЙржкрж░             |
| ржХрзЗ apply ржХрж░рзЗ                | Django ржирж┐ржЬрзЗржЗ (server start-ржП)        | рждрзБржорж┐ ржирж┐ржЬрзЗ ржХрзЛржбрзЗ `@decorator` ржжрж┐рзЯрзЗ       |
| Scope                       | global (рж╕ржм view-рждрзЗ)                  | local (ржирж┐рж░рзНржжрж┐рж╖рзНржЯ view-ржП)               |
| Request/Response handle ржХрж░рзЗ | рж╣рзНржпрж╛ржБ                                | ржирж╛, рж╢рзБржзрзБржорж╛рждрзНрж░ view-ржПрж░ ржЖржЧрзЗ/ржкрж░рзЗ          |
| Initialization рж╕ржорзЯ          | Django ржЪрж▓рж╛рж░ рж╕ржорзЯ                      | Python runtime-ржП (function define рж╕ржорзЯ) |

### Middleware chaining (View wrapping)

Middleware ржЧрзБрж▓рзЛ ржПрж░ржХржо ржХрж╛ржЬ ржХрж░рзЗ:

```python
# middlewares = ["middleware1", "middleware2", "middleware3"]
final_view = middleware1(
                  middleware2(
                      middleware3(
                          original_view
                      )
                  )
              )
```

ржПржЦрж╛ржирзЗ тАЬserver run рж╣рж▓рзЗ view = middleware(view)тАЭ

### Decorator ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзА рж╣рзЯ?

```python
@my_decorator
def my_view(request):
    ...

```

тЮбя╕П Python internally ржХрж░рзЗ:

```python
my_view = my_decorator(my_view)
```

### ржжрзБржЗржЯрж╛рзЯ ржПржХрж╕рж╛ржерзЗ use ржХрж░рж▓рзЗ (middleware,decoretor)

```python
# middlewares = ["middleware1", "middleware2", "middleware3"]
# @mydecorator
# def original_view;

final_view = middleware1(
                  middleware2(
                      middleware3(
                          my_decorator(original_view)
                      )
                  )
              )
```

#### ЁЯФД Execution Order (console output):

```pgsql

middleware1 before view
decorator before view
Inside view
decorator after view
middleware1 after view


```

| ржмрж┐рж╖рзЯ                          | Summary                                                   |
| ----------------------------- | --------------------------------------------------------- |
| **Middleware**                | Request/Response ржПрж░ ржорж╛ржЭржЦрж╛ржирзЗ ржмрж╕рзЗ ржХрж╛ржЬ ржХрж░рзЗ; рж╕ржм view-рждрзЗ ржЪрж╛рж▓рж╛рзЯ |
| **Decorator**                 | View-ржПрж░ ржЖржЧрзЗ/ржкрж░рзЗ ржЖрж▓рж╛ржжрж╛ ржХрж╛ржЬ ржХрж░рзЗ; рж╢рзБржзрзБ ржУржЗ view-рждрзЗржЗ           |
| **Function-based Middleware** | Simple function ржпрж╛ request ржирж┐рзЯрзЗ response ржлрзЗрж░ржд ржжрзЗрзЯ         |
| **Class-based Middleware**    | Full control ржжрзЗрзЯ, Django ржПрж░ ржирждрзБржи рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржб            |
| **Custom Decorator**          | View ржПрж░ ржЖржЧрзЗ/ржкрж░рзЗ ржирж┐ржЬрж╕рзНржм logic ржЪрж╛рж▓рж╛рзЯ                        |

---

## `Middleware is actually a special kind of decorator.`

### тЬЕ Part 3 : Decorator ржУ Permission based view

#### ЁЯФ╣ рзз. Decorator ржХрзА?

`Decorator` рж╣рж▓рзЛ Python-ржПрж░ ржПржХ ржзрж░ржирзЗрж░ ржлрж╛ржВрж╢ржи ржпрж╛ ржЕржирзНржп ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи ржмрж╛ ржнрж┐ржЙ-ржХрзЗ modify ржмрж╛ enhance ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд
рж╣рзЯред

Django-рждрзЗ ржмрзНржпржмрж╣рзГржд common decorators:

- `@login_required`
- `@permission_required`
- `@user_passes_test`

---

#### ЁЯФ╣ рзи. ржХрзЗржи Decorator ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐?

тЬЕ View ржХрзЗ protected ржХрж░рждрзЗ тЬЕ ржХрзЛржи ржнрж┐ржЙрждрзЗ рж╢рзБржзрзБ logged-in user access ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рждрзЗ тЬЕ
Custom condition apply ржХрж░рждрзЗ (ржпрзЗржоржи: рж╢рзБржзрзБ staff user, рж╢рзБржзрзБ superuser)

---

## ЁЯФ╣ рзй. `@login_required` ржмрзНржпржмрж╣рж╛рж░

#### тЬЕ ржЙржжрзНржжрзЗрж╢рзНржп:

ржпржжрж┐ user рж▓ржЧ ржЗржи ржирж╛ ржХрж░рзЗ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ рждрж╛ржХрзЗ login ржкрзЗржЬрзЗ redirect ржХрж░ржмрзЗред

#### тЬЕ ржмрзНржпржмрж╣рж╛рж░:

```python
from django.contrib.auth.decorators import login_required
@login_required(login_url='/accounts/login/')
def dashboard(request):
    return render(request, 'dashboard.html')
```

#### ЁЯФ╣ рзк. @permission_required ржмрзНржпржмрж╣рж╛рж░

#### тЬЕ ржЙржжрзНржжрзЗрж╢рзНржп:

User-ржПрж░ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ permission ржЖржЫрзЗ ржХрж┐ржирж╛ рждрж╛ ржпрж╛ржЪрж╛ржЗ ржХрж░рзЗред ржирж╛ ржерж╛ржХрж▓рзЗ 403 Forbidden ржжрж┐ржмрзЗред

#### тЬЕ ржмрзНржпржмрж╣рж╛рж░:

```python
from django.contrib.auth.decorators import permission_required

@permission_required('app_label.permission_codename', raise_exception=True)
def my_view(request):
    return render(request, 'secure_page.html')

```

ЁЯФН ржмрзБржЭрзЗ ржирзЗржи:

- 'app_label.permission_codename' = eg: 'products.add_product'

- raise_exception=True ржжрж┐рж▓рзЗ login ржирж╛ ржерж╛ржХрж╛ ржмрж╛ permission ржирж╛ ржерж╛ржХрж▓рзЗ 403 ржжрж┐ржмрзЗред

#### ЁЯФ╣ рзл. @user_passes_test ржжрж┐рзЯрзЗ Custom Check

#### тЬЕ Example:

```python
from django.contrib.auth.decorators import user_passes_test

def is_admin(user):
    return user.is_superuser

@user_passes_test(is_admin)
def admin_dashboard(request):
    return render(request, 'admin.html')
```

#### ЁЯФ╣ рзм. Model Permission ржирж╛ржо ржЧрзБрж▓рзЛ ржХрзАржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣рзЯ?

- Model: Product

| ржХрж╛ржЬ            | Permission Codename |
| -------------- | ------------------- |
| Add product    | `add_product`       |
| Change product | `change_product`    |
| Delete product | `delete_product`    |
| View product   | `view_product`      |

Format: 'app_label.codename'

#### ЁЯФ╣ рзн. Permission Add ржХрж░рж╛рж░ ржирж┐рзЯржо (admin panel ржерзЗржХрзЗ)

Admin panel тЖТ User тЖТ Permissions тЖТ тЬЕ Select required permissions тЖТ Save

ЁЯза Bonus: Custom Permission рждрзИрж░рж┐ (Model Meta ржХрзНрж▓рж╛рж╕рзЗ)

```
class Product(models.Model):
    name = models.CharField(max_length=100)

    class Meta:
        permissions = [
            ("can_publish", "Can Publish Product"),
        ]

```

#### ЁЯФ╣ рзо. Function-based View (FBV) vs Class-based View (CBV) ржП Decorator

##### тЬЕ CBV ржП login_required ржмрзНржпржмрж╣рж╛рж░:

```python
from django.utils.decorators import method_decorator
from django.contrib.auth.decorators import login_required

@method_decorator(login_required, name='dispatch')
class DashboardView(View):
    def get(self, request):
        return render(request, 'dashboard.html')
```

| Decorator              | ржХрж╛ржЬ                                           |
| ---------------------- | --------------------------------------------- |
| `@login_required`      | Login ржЫрж╛рзЬрж╛ ржнрж┐ржЙ access ржХрж░рждрзЗ ржжрж┐ржмрзЗ ржирж╛            |
| `@permission_required` | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ permission ржЫрж╛рзЬрж╛ view access ржжрж┐ржмрзЗ ржирж╛ |
| `@user_passes_test`    | Custom logic check                            |
| Custom Decorator       | ржирж┐ржЬрзЗрж░ ржорждрзЛ ржХрж░рзЗ ржХрзЛржи logic enforce ржХрж░рж╛           |

---

## тЬЕ Day 10: blog backend based website by django done

---

- DRF install & config

- APIView ржжрж┐рзЯрзЗ JSON Response

- API vs Web Page

## тЬЕ Day 11: DRF Setup & First API

### ЁЯз▒ Part 1: DRF Install & Configuration

#### ЁЯФ╣ Step 1: DRF Install

```bash
pip install djangorestframework
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> DRF (Django REST Framework) ржЗржирж╕рзНржЯрж▓ ржирж╛ ржХрж░рж▓рзЗ ржЖржорж░рж╛ Django ржжрж┐рзЯрзЗ API ржмрж╛ржирж╛рждрзЗ ржкрж╛рж░рждрж╛ржо ржирж╛ред ржПржЯрж╛ Django ржПрж░
> ржУржкрж░ ржмрж╕рж╛ржирзЛ ржПржХржЯрж╛ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА extensionред

---

#### ЁЯФ╣ Step 2: settings.py рждрзЗ ржпрзЛржЧ ржХрж░рзЛ

```python
INSTALLED_APPS = [
    ...
    'rest_framework',
]
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> Django-ржХрзЗ ржЬрж╛ржирж╛рждрзЗ рж╣ржмрзЗ ржпрзЗ ржЖржорж░рж╛ DRF ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмред ржирж╛ ржХрж░рж▓рзЗ Django ржПржЯрж╛ ржЪрж┐ржирждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛редby-deafalut drf
> ржПржХржЯрж╛ app ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ ржЖржорж░рж╛ ржЬрж╛ржирж┐ ржПржХржЯрж╛ apps ржмрж╛ржирж╛рж▓рзЗ рждрж╛ ржЖржорж╛ржжрзЗрж░ settings.py рждрзЗ ржЕрзНржпрж╛ржб ржХрж░рждрзЗ рж╣рзЯ ржирж╛ рж╣рж▓рзЗ
> рж╕рзЗржЗ app ржХрзЗ django ржЪрж┐ржирждрзЗ ржкрж╛рж░рзЗ ржирж╛ рждрж╛ржЗ ржЖржорж╛ржжрзЗрж░ add ржХрж░рждрзЗ рж╣рзЯрзЗржЫрзЗред

---

#### тЬЕ Part 2: APIView ржжрж┐рзЯрзЗ JSON Response - Step by Step

#### ЁЯФ╣ Step 1: Model рждрзИрж░рж┐ ржХрж░рзЛ

```python
# blog/models.py
from django.db import models

class Blog(models.Model):
    title = models.CharField(max_length=200)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> ржЖржорж░рж╛ ржбрзЗржЯрж╛ ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖржиржм? Model ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ ржбрзЗржЯрж╛ржмрзЗржЗрж╕рзЗрж░ ржХрж╛ржарж╛ржорзЛредржПржЗ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржерзЗржХрзЗ ржЖржорж░рж╛ ржбрж╛ржЯрж╛ ржирж┐ржмрзЛ ржпрж╛ api
> ржПрж░ maddhome ржлрзНрж░ржирзНржЯржПржирзНржб apps ржХрзЗ ржкрж╛ржарж╛ржмрзЛред

---

#### ЁЯФ╣ Step 2: Serializer рждрзИрж░рж┐ ржХрж░рзЛ

```python
# blog/serializers.py
from rest_framework import serializers
from .models import Blog

class BlogSerializer(serializers.ModelSerializer):
    class Meta:
        model = Blog
        fields = '__all__'
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> Model ржХрзЗ JSON ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛рж░ ржЬржирзНржп serializer ржжрж░ржХрж╛рж░ред ржирж╛ ржХрж░рж▓рзЗ API ржбрзЗржЯрж╛ ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ред serializer
> ржЕржирзЗржХ ржЯрж╛ django ржПрж░ ржлрж░рзНржо ржПрж░ ржорждрзЛ ржлрж░рзНржо ржпрзЗржоржи ржоржбрзЗрж▓ ржЕржмржЬрзЗржХрзНржЯ ржлрж┐рж▓рзНржбрж╕ ржмрж╛ ржХрж╛рж╕рзНржЯржо ржлрж┐рж▓рзНржбрж╕ ржХрзЗ ржЯрзЗржорзНржкрж▓рзЗржЯ ржП ржХржиржнрж╛рж░рзНржЯ
> ржПржирзНржб ржбрж╛ржЯрж╛ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржХрж░рзЗред рждрзЗржоржирж┐ serializer ржУ ржоржбрзЗрж▓ ржЕржмржЬрзЗржХрзНржЯ ржлрж┐рж▓рзНржбрж╕ ржмрж╛ ржХрж╛рж╕рзНржЯржо ржлрж┐рж▓рзНржбрж╕ ржХрзЗ ржкрж╛ржЗржержи
> dictionary рждрзЗ ржХржиржнрж╛рж░рзНржЯ ржХрж░рзЗ ржПржмржВ ржлрж┐рж▓рзНржб ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржХрж░рзЗред ржПрж░ржкрж░ рж╕рзЗржЗ ржкрж╛ржЗржержи dictionary ржХрзЗ ржкрж░ржмрж░рзНрждрзА ржнрж┐ржЙ рждрзЗ
> response json ржП ржХржиржнрж╛рж░рзНржЯ ржХрж░рзЗ рж╕рзЗржЗ ржЬрзЗрж╕ржи ржПрж░ рж╕рж╛ржерзЗ ржкрзНрж░рзЯрзЛржЬржирзАрзЯ рж╕ржм ржорзЗржЯрж╛ ржбрж╛ржЯрж╛ рж╣рзЗржбрж╛рж░ рж╕рзНржЯрзЗржЯрж╛рж╕ ржпрзБржХрзНржд ржХрж░рзЗ
> ржлрзНрж░ржирзНржЯржПржирзНржб apps ржХрзЗ ржкрж╛ржарж┐рзЯрзЗ ржжрзЗрзЯред

---

#### ЁЯФ╣ Step 3: APIView рждрзИрж░рж┐ ржХрж░рзЛ

```python
# blog/views.py
from rest_framework.views import APIView
from rest_framework.response import Response
from .models import Blog
from .serializers import BlogSerializer

class BlogListAPIView(APIView):
    def get(self, request):
        blogs = Blog.objects.all()
        serializer = BlogSerializer(blogs, many=True) #many=true ржирж╛  ржжрж┐рж▓рзЗ ржоржбрзЗрж▓ ржПрж░ ржПржХрж╛ржзрж┐ржХ ржЕржмржЬрзЗржХрзНржЯ ржХрзЗ ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рзЗ  рж▓рж┐рж╕рзНржЯ ржЕржл ржоржбрзЗрж▓  ржЕржмржЬрзЗржХрзНржЯ  ржбрж┐ржХрзНржЯ  ржмрж╛ржирж╛рждрзЛ ржирж╛ ржПржХржЯрж╛ ржЕржмржЬрзЗржХрзНржЯ ржзрж░рзЗ ржирж┐рждрзЛ dict  ржПрж░ рж▓рж┐рж╕рзНржЯ ржирж╛ ржмрж╛ржирж┐рзЯрзЗ ржЬрж╛рж╕рзНржЯ ржПржХржЯрж╛ dict ржмрж╛ржирж╛рждрзЛред
        return Response(serializer.data)
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> APIView рж╣рж▓рзЛ DRF-ржПрж░ class-based view, ржпрзЗржЯрж╛ ржжрж┐рзЯрзЗ ржЖржорж░рж╛ GET/POST ржЗрждрзНржпрж╛ржжрж┐ method ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐редржпрж╛рж░
> ржПржХржЯрж╛ ржорзЗржержб ржЖржЫрзЗ as_view ржПржЗ ржорзЗржержб рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржПрж░ ржорзЗржержб (post,get,put,patch,delete) ржЕржирзБржпрж╛рзЯрзА apiview ржПрж░
> view ржорзЗржержб ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ ржХрж░рзЗредAPIView ржирж┐ржЬрзЗржЗ as_view() ржорзЗржержб ржжрж┐рзЯрзЗ HTTP ржорзЗржержб (get, post, put, patch,
> delete) ржЕржирзБржпрж╛рзЯрзА ржХрзНрж▓рж╛рж╕рзЗрж░ рж╕ржВрж╢рзНрж▓рж┐рж╖рзНржЯ ржорзЗржержб (get(), post(), put()...) ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ ржХрж░рзЗред ржЖржорж░рж╛ viewset ржПрж░
> ржХрзНрж╖рзЗрждрзНрж░рзЗ as_view() class ржорзЗржержб ржХрзЗ ржЖрж░рзНржЧрзБржорзЗржирзНржЯ ржкрж╛рж╕ ржХрж░рзЗ ржмрж▓рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ ржХрзЛржи рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржорзЗржержб ржП ржХрзЛржи ржХрзНрж▓рж╛рж╕
> ржорзЗржержб ржнрж┐ржЙ ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ рж╣ржмрзЗ APIview.as_view({

    "get":list,"post":create,"put":update

}) ржПржЗ ржХрж╛ржЬ рждрж╛ ржорзВрж▓ржд deafaltrouter() ржХрж░рзЗ urlpatterent рж▓рж┐рж╕рзНржЯ ржмрж╛ржирж╛рзЯ ржПржЯрж╛ viewset ,modelviewset ржПрж░ ржмрзЗрж▓рж╛рзЯ
рждржмрзЗ рж╕рзЗржЯрж╛ apiview ржП ржХрж╛ржЬ ржХрж░рзЗ ржирж╛ ред

#### APIview vs viewset

| ржмрж┐рж╖рзЯ                   | APIView                           | ViewSet / ModelViewSet                   |
| ---------------------- | --------------------------------- | ---------------------------------------- |
| HTTP ржорзЗржержб рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ   | ржХрзНрж▓рж╛рж╕рзЗрж░ get/post/put ржЗрждрзНржпрж╛ржжрж┐ ржорзЗржержб | `as_view()`-ржП ржорзЗржержб-ржорзНржпрж╛ржкрж┐ржВ ржбрж┐ржХрж╢ржирж╛рж░рж┐ ржжрж┐рзЯрзЗ |
| `as_view()` ржЖрж░рзНржЧрзБржорзЗржирзНржЯ | ржирзЗрзЯ ржирж╛                            | ржирзЗрзЯ (ржорзЗржержб-ржорзНржпрж╛ржкрж┐ржВ ржбрж┐ржХрж╢ржирж╛рж░рж┐)              |
| URL ржкрзНржпрж╛ржЯрж╛рж░рзНржи          | ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ рж▓рж┐ржЦрждрзЗ рж╣рзЯ               | Router ржжрж┐рзЯрзЗ ржЕржЯрзЛржорзЗржЯрж┐ржХ рждрзИрж░рж┐ рж╣рзЯ             |

---

#### ЁЯФ╣ Step 4: URL ржпрзБржХрзНржд ржХрж░рзЛ

```python
# blog/urls.py
from django.urls import path
from .views import BlogListAPIView

urlpatterns = [
    path('api/blogs/', BlogListAPIView.as_view(), name='api-blogs'),
]
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> URL ржЫрж╛рзЬрж╛ ржЖржорж░рж╛ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржмрж╛ ржЕрзНржпрж╛ржк ржерзЗржХрзЗ ржПржЗ API-рждрзЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░рждрж╛ржо ржирж╛ред

---

#### ЁЯФ╣ ржПржЦржи ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржПржЗ рж▓рж┐ржВржХ ржнрж┐ржЬрж┐ржЯ ржХрж░рзЛ:

```
http://127.0.0.1:8000/api/blogs/
```

ЁЯФ╕ рждрзБржорж┐ JSON format-ржП ржбрзЗржЯрж╛ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗред

---

### ЁЯФ╣ Bonus: POST ржжрж┐рзЯрзЗ ржирждрзБржи Blog рждрзИрж░рж┐

```python
class BlogCreateAPIView(APIView):
    def post(self, request):
        serializer = BlogSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=201)
        return Response(serializer.errors, status=400)
```

ЁЯФ╕ ржХрзЗржи ржХрж░рж▓рж╛ржо?

> рж╢рзБржзрзБ GET ржХрж░рж▓рзЗ ржбрзЗржЯрж╛ ржжрзЗржЦрж╛ржирзЛ ржпрж╛рзЯред POST ржХрж░рж▓рзЗ ржирждрзБржи ржбрзЗржЯрж╛ ржпрзЛржЧ ржХрж░рж╛ ржпрж╛рзЯред

---

### ЁЯУК Part 3: API vs Web Page

| ржмрж┐рж╖рзЯ                    | Web Page            | API                 |
| ----------------------- | ------------------- | ------------------- |
| Format                  | HTML                | JSON                |
| Viewer                  | ржорж╛ржирзБрж╖ (User)        | ржЕрзНржпрж╛ржк ржмрж╛ JavaScript |
| ржЙржжрзНржжрзЗрж╢рзНржп                | ржжрзЗржЦрж╛ржирзЛ              | ржбрзЗржЯрж╛ ржкрж╛ржарж╛ржирзЛ/ржирзЗржУрзЯрж╛   |
| ржХрзА ржерж╛ржХрзЗ?                | Text, Image, Design | ржХрж╛ржБржЪрж╛ ржбрзЗржЯрж╛          |
| Mobile App ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ? | ржирж╛                  | рж╣рзНржпрж╛ржБ               |

---

### ЁЯза ржЙржкрж╕ржВрж╣рж╛рж░:

- Web Page = ржорж╛ржирзБрж╖рзЗрж░ ржЬржирзНржп
- API = ржЕрзНржпрж╛ржк ржУ ржХржорзНржкрж┐ржЙржЯрж╛рж░рзЗрж░ ржЬржирзНржп
- APIView ржжрж┐рзЯрзЗ DRF ржП JSON Response ржкрж╛ржарж╛ржирзЛ ржпрж╛рзЯ
- Serializer ржЫрж╛рзЬрж╛ JSON ржмрж╛ржирж╛ржирзЛ ржпрзЗржд ржирж╛,validation ржХрж░рж╛ ржпрзЗржд ржирж╛
- URL ржЫрж╛рзЬрж╛ API ржПржХрзНрж╕рзЗрж╕ ржХрж░рж╛ ржпрзЗржд ржирж╛

---

## тЬЕ Day 12: Serializers (Basic)

ржПржЗ Handnote ржЯрж╛ рзйржЯрж╛ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг Django DRF topic ржХржнрж╛рж░ ржХрж░ржмрзЗ:

- Manual Serializer Class
- ModelSerializer
- Serializer Validation

рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ржорзВрж▓ржХ ржЖрж▓рзЛржЪржирж╛ ржерж╛ржХржмрзЗ Django Forms ржПрж░ рж╕рж╛ржерзЗ:

- Forms vs Serializers
- ModelForm vs ModelSerializer

---

### 1. Manual Serializer Class

#### ЁЯФ╣ ржХрзА?

Manual serializer class рж╣ржЪрзНржЫрзЗ DRF-ржПрж░ serializer ржпрзЗржЯрж╛ `serializers.Serializer` ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ ржХрж░рзЗ
ржмрж╛ржирж╛ржирзЛ рж╣рзЯред ржПржЯрж╛ ржПржХржжржо Django Form ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ JSON data ржПрж░ ржЬржирзНржпред

#### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

ржпржЦржи ржЖржкржирж┐ ржирж┐ржЬрзЗрж░ ржорждрзЛ ржХрж░рзЗ ржлрж┐рж▓рзНржб, ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рждрзЗ ржЪрж╛ржи ржПржмржВ Model ржПрж░ рж╕рж╛ржерзЗ рж╕рж░рж╛рж╕рж░рж┐ рж╕ржорзНржкрж░рзНржХ ржирж╛ржЗред

#### ЁЯФз ржХрзЛржб:

```python
from rest_framework import serializers

class BlogSerializer(serializers.Serializer):
    title = serializers.CharField(max_length=100, label="Blog Title")
    content = serializers.CharField()

    def validate_title(self, value):
        if 'django' not in value.lower():
            raise serializers.ValidationError("Title must contain 'django'")
        return value

    def validate(self, data):
        if data['title'] == data['content']:
            raise serializers.ValidationError("Title and content must be different")
        return data

# External validator function
from rest_framework.validators import ValidationError

def no_hello(value):
    if 'hello' in value.lower():
        raise ValidationError("'hello' is not allowed")

class SampleSerializer(serializers.Serializer):
    name = serializers.CharField(validators=[no_hello])
```

### ЁЯза ржорж┐рж▓ Django Form ржПрж░ рж╕рж╛ржерзЗ:

| Manual Serializer                | Django Form                    |
| -------------------------------- | ------------------------------ |
| `Serializer` ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ        | `forms.Form` ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ      |
| ржлрж┐рж▓рзНржб define ржХрж░рждрзЗ рж╣рзЯ             | ржлрж┐рж▓рзНржб define ржХрж░рждрзЗ рж╣рзЯ           |
| `.is_valid()`, `.validated_data` | `.is_valid()`, `.cleaned_data` |
| `.validate_<field>()` method     | `clean_<field>()` method       |
| `.validate()` method             | `clean()` method               |

### тЭМ ржЕржорж┐рж▓:

| Manual Serializer                                              | Django Form                                                                                                                                                                                         |
| -------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| JSON Data handle ржХрж░рзЗ                                           | HTML form data handle ржХрж░рзЗ                                                                                                                                                                           |
| API request/response format                                    | Template rendering and user input                                                                                                                                                                   |
| `.save()` method ржирж╛ржЗ                                           | `.save()` method ржирж╛ржЗ (form ржП ржерж╛ржХрзЗ рж╢рзБржзрзБ ModelForm ржП)                                                                                                                                                 |
| DRF ржирж┐ржЬрзЗ validate\_<field>(self,value) ржП ржлрж┐рж▓рзНржбрзЗрж░ value ржкрж╛ржарж╛рзЯ   | Form ржП clean\_<field>() call ржХрж░рж╛рж░ рж╕ржорзЯ cleaned_data ржерзЗржХрзЗ ржирж┐ржЬрзЗ cleaned_data[field] avabe ржирж┐рждрзЗ рж╣рзЯ                                                                                                      |
| DRF ржирж┐ржЬрзЗржЗ validate(self,data)-ржП рж╕ржм cleaned/validate data ржкрж╛ржарж╛рзЯ | Django Form ржП parent class ржПрж░ clean() manually call ржХрж░рждрзЗ рж╣рзЯ self.cleaned_data dict рждрзИрж░рж┐ ржХрж░рждрзЗ рждрж╛рж░ржкрж░ cleaned_data[field] ржПржнрж╛ржмрзЗ ржХрж░рзЗ ржпрждржЧрзБрж▓рж╛ ржжрж░ржХрж╛рж░ ржлрж┐рж▓рзНржб ржПрж░ ржнрзНржпрж╛рж▓рзБ ржирж┐рждрзЗ рж╣рзЯ json ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯрзЗ ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ред |

---

### 2. ModelSerializer

#### ЁЯФ╣ ржХрзА?

`serializers.ModelSerializer` ржПржоржи ржПржХ serializer ржпрзЗржЯрж╛ Django ржПрж░ Model ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржЕржЯрзЛ ржлрж┐рж▓рзНржб
рждрзИрж░рж┐ ржХрж░рзЗ ржжрзЗрзЯред

#### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

ржпржЦржи ржЖржкржирж╛рж░ ржбрзЗржЯрж╛ рж╕рж░рж╛рж╕рж░рж┐ Model ржПрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХрж┐рждред

#### ЁЯФз ржХрзЛржб:

```python
from rest_framework import serializers
from .models import Blog

# Custom validator
from rest_framework.validators import ValidationError

def no_forbidden(value):
    if "forbidden" in value.lower():
        raise ValidationError("You can't use the word 'forbidden'")

class BlogModelSerializer(serializers.ModelSerializer):
    class Meta:
        model = Blog
        fields = ['title', 'content']
        extra_kwargs = {
            'title': {
                'label': "Blog Title",
                'validators': [no_forbidden]
            },
            'content': {
                'label': "Content Body"
            }
        }

    def validate_title(self, value):
        if len(value) < 5:
            raise serializers.ValidationError("Title is too short")
        return value

    def validate(self, data):
        if data['title'] == data['content']:
            raise serializers.ValidationError("Title and content cannot be the same")
        return data
```

#### ЁЯза ржорж┐рж▓ ModelForm ржПрж░ рж╕рж╛ржерзЗ:

| ModelSerializer             | ModelForm                   |
| --------------------------- | --------------------------- |
| Model ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ     | Model ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ     |
| `Meta` class ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ    | `Meta` class ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ    |
| ржлрж┐рж▓рзНржб ржЕржЯрзЛ рждрзИрж░рж┐ рж╣рзЯ           | ржлрж┐рж▓рзНржб ржЕржЯрзЛ рждрзИрж░рж┐ рж╣рзЯ           |
| `.save()` method ржерж╛ржХрзЗ       | `.save()` method ржерж╛ржХрзЗ       |
| Validation override ржХрж░рж╛ ржпрж╛рзЯ | Validation override ржХрж░рж╛ ржпрж╛рзЯ |

#### тЭМ ржЕржорж┐рж▓:

| ModelSerializer        | ModelForm             |
| ---------------------- | --------------------- |
| JSON data process ржХрж░рзЗ  | HTML Form process ржХрж░рзЗ |
| Template render ржХрж░рзЗ ржирж╛ | Template render ржХрж░рзЗ   |
| API-based              | Form-based            |

---

### 3. Serializer Validation vs Form Validation

#### ЁЯзй ржлрж┐рж▓рзНржб-рж▓рзЗржнрзЗрж▓ Validation:

| Serializer                          | Form                          |
| ----------------------------------- | ----------------------------- |
| `validate_<field>()`                | `clean_<field>()`             |
| Raise `serializers.ValidationError` | Raise `forms.ValidationError` |

#### ЁЯзй Object-рж▓рзЗржнрзЗрж▓ Validation:

| Serializer                          | Form                          |
| ----------------------------------- | ----------------------------- |
| `validate(self, data)`              | `clean(self)`                 |
| Raise `serializers.ValidationError` | Raise `forms.ValidationError` |

#### ЁЯзй Built-in Field Validation:

| Serializer                                 | Form                                       |
| ------------------------------------------ | ------------------------------------------ |
| `CharField(required=True, max_length=...)` | `CharField(required=True, max_length=...)` |

#### ЁЯзй Custom Validator Function:

| Serializer                          | Form                          |
| ----------------------------------- | ----------------------------- |
| `validators=[my_func]`              | `validators=[my_func]`        |
| Raise `serializers.ValidationError` | Raise `forms.ValidationError` |

---

#### ЁЯзй Error ржХрзЛржерж╛рзЯ store рж╣рзЯ?

| ржмрж┐рж╖рзЯ                            | Serializer                                  | Form                                                                  |
| ------------------------------- | ------------------------------------------- | --------------------------------------------------------------------- |
| ржлрж┐рж▓рзНржб-рж▓рзЗржнрзЗрж▓ Error               | `serializer.errors['field']`                | `form['field'].errors`                                                |
| ржЕржмржЬрзЗржХрзНржЯ-рж▓рзЗржнрзЗрж▓ Error (non-field) | `serializer.errors['non_field_errors']`     | `form.non_field_errors()`                                             |
| ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ Error add ржХрж░рж▓рзЗ       | `raise ValidationError({'field': 'error'})` | `self.add_error('field', 'error')` ржмрж╛ `raise forms.ValidationError()` |

---

#### ЁЯФД Summary Table

| ржмрж┐рж╖рзЯ              | Serializer                               | Form                   | ржорж┐рж▓ | ржЕржорж┐рж▓                    |
| ----------------- | ---------------------------------------- | ---------------------- | --- | ----------------------- |
| ржЗржирж╣рзЗрж░рж┐ржЯ           | serializers.Serializer / ModelSerializer | forms.Form / ModelForm | тЬЕ  | тЭМ DRF uses JSON        |
| ржлрж┐рж▓рзНржб define      | тЬЕ                                       | тЬЕ                     | тЬЕ  | тЭМ HTML vs JSON         |
| Field validation  | validate\_<field>()                      | clean\_<field>()       | тЬЕ  | Syntax ржЖрж▓рж╛ржжрж╛            |
| Object validation | validate()                               | clean()                | тЬЕ  | Syntax ржЖрж▓рж╛ржжрж╛            |
| Custom validator  | тЬЕ                                       | тЬЕ                     | тЬЕ  | Raise class ржЖрж▓рж╛ржжрж╛       |
| `.is_valid()`     | тЬЕ                                       | тЬЕ                     | тЬЕ  | None                    |
| `.save()`         | рж╢рзБржзрзБ ModelSerializer ржП                   | рж╢рзБржзрзБ ModelForm ржП       | тЬЕ  | Manual serializer ржП ржирж╛ржЗ |
| Data format       | JSON                                     | HTML form              | тЭМ  | тЬЕ                      |
| Frontend Render   | тЭМ                                       | тЬЕ                     | тЭМ  | тЬЕ                      |
| API Usage         | тЬЕ                                       | тЭМ                     | тЭМ  | тЬЕ                      |

---

### тЬЕ Extra Tips:

- DRF ржПрж░ serializer = Django Form ржПрж░ advanced version, API-centric
- рж╢рзБржзрзБ frontend rendering рж▓рж╛ржЧрж▓рзЗ => Django Form
- ржпржжрж┐ API ржмрж╛ржирж╛рждрзЗ рж╣рзЯ => DRF Serializer
- Model ржПрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ ржХрж░рж▓рзЗ => ModelSerializer / ModelForm
- ржХрж╛рж╕рзНржЯржо ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи рж▓рж╛ржЧрж▓рзЗ => `validate_<field>()` ржмрж╛ `validate()` override ржХрж░рзЛ

---

## тЬЕ Day 13: API CRUD (GenericAPIView,mixin)

- mixin,genericapiview

- ListAPIView, CreateAPIView

- RetrieveUpdateDestroyAPIView

- Data add, edit, delete via API(genericapiview)

### ЁЯУЪ DRF: GenericAPIView, Mixins, and Class-Based Views (A to Z Full Guide)

ржПржЗ рж╣рзНржпрж╛ржирзНржбржирзЛржЯрзЗ ржЖржорж░рж╛ DRF-ржПрж░ GenericAPIView, Mixins ржПржмржВ Generic Views ржпрзЗржоржи `ListAPIView`,
`CreateAPIView`, `RetrieveUpdateDestroyAPIView` тАФ ржкрзНрж░рждрж┐ржЯрж┐ ржмрж┐рж╖рзЯ A to Z рждрзЗ ржЖрж▓рзЛржЪржирж╛ ржХрж░ржмрзЛред ржПржЫрж╛рзЬрж╛ржУ, ржПржЧрзБрж▓рзЛрж░
Form (Django traditional form)-ржПрж░ рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ржУ ржХрж░ржмрзЛ, ржпрзЗржи future-ржП рж░рж┐ржнрж┐рж╢ржи ржжрж┐рж▓рзЗ рж╕рж╣ржЬрзЗ ржоржирзЗ ржкрзЬрзЗ ржпрж╛рзЯред

---

### ЁЯза DRF ржП GenericAPIView ржЖрж░ Mixins ржХрзЗржи ржПрж▓рзЛ?

ЁЯСЙ DRF ржЕржирзЗржХ low-level ржерзЗржХрзЗ ржХрж╛ржЬ ржХрж░рждрзЗ ржжрзЗрзЯ тАФ ржпрзЗржоржи APIView ржжрж┐рзЯрзЗред ржХрж┐ржирзНрждрзБ рж╕ржмржХрж┐ржЫрзБ ржЖржмрж╛рж░ ржЖржмрж╛рж░ рж▓рж┐ржЦрждрзЗ рж╣рзЯ
(validation, queryset, save, etc.)ред рждрж╛ржЗ DRY (Don't Repeat Yourself) ржорзЗржирзЗ reusable ржЕржВрж╢ржЧрзБрж▓рзЛржХрзЗ ржЖрж▓рж╛ржжрж╛
ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ тАФ GenericAPIView ржУ Mixins ржЖржХрж╛рж░рзЗред

- `GenericAPIView`: ржПржЯрж┐ base class ржпрзЗржЯрж┐ queryset, serializer_class, lookup_field ржПрж╕ржмржХрзЗ configure ржХрж░рзЗ
  ржПржмржВ ржПрж░ ржоржзрзНржпрзЗ get_queryset,get_serializer_class,filter_queryset etc ржорзЗржержб ржерж╛ржХрзЗ ржпрж╛рж░ ржорж╛ржжрзНржзржорзЗ ржПрж░ ржЪрж╛ржЗрж▓рзНржб
  ржЧрзБрж▓рзЛ ржПрж░ ржХржиржлрж┐ржЧрж╛рж░ ржЧрзБрж▓рж╛ fetch ржХрж░рждрзЗ ржкрж╛рж░рзЗ ред ржПржЯрж┐ APIView ржХрзЗ extend ржХрж░рзЗ ржпрж╛рж░ ржлрж▓рзЗ ржЬрзЗржирзЗрж░рж┐ржХ ржПрж░ рж╕ржм route
  apiview handle ржХрж░рзЗ рждрж╛рж░ ржбрзЗржлрж▓рзНржЯ ржмрж┐рж╣рзЗржнрж┐рзЯрж╛рж░ (get ,post ,update ,delete ) ржорзЗржержб ржжрж┐рзЯрж╛ ред
- `Mixins`: ржПржЧрзБрж▓рзЛ ржЫрзЛржЯ ржЫрзЛржЯ ржХрж╛ржЬрзЗрж░ behavior ржжрзЗрзЯ тАФ ржпрзЗржоржи list ржХрж░рж╛, create ржХрж░рж╛, retrieve ржХрж░рж╛ ржЗрждрзНржпрж╛ржжрж┐редржмрж▓рж╛
  ржпрж╛рзЯ mixin рж░рзЗржбрж┐ржорзЗржЯ ржбрж╛ржЗржирж╛ржорж┐ржХ ржнрж┐ржЙ ржмрж╛ржирж┐рзЯрзЗ рж░рж╛ржЦрзЗ ржпрзЗ self.get_serializer(data=request.data)
  self.get_queryset() ржПрж░ ржорж╛ржзрзНржпржорзЗ serializer ,queryset etc genericapiview ржПрж░ ржХрж╛ржЫ ржерзЗржХрзЗ рждрж╛ржХрзЗ ржПржХрзНрж╕ржЯрзЗржирзНржб
  ржПрж░ ржоржзрзНржпрзЗ ржерж╛ржХрж╛ ржорзЗржержб ржЧрзБрж▓рж╛ use ржХрж░рзЗ ржЕржкрж╛рж░рзЗрж╢ржи ржЪрж▓рж╛рж░ ржЬржирзНржп ржпрж╛ ржпрж╛ рж▓рж╛ржЧрзЗ рж╕ржм ржлрзЗржЪ ржХрж░рзЗ ржирзЗрзЯ ред mixin ржП ржкрзНрж░рждрж┐ржЯрж╛
  oparetion ржПрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ ржЖрж▓рж╛ржжрж╛ ржХрзНрж▓рж╛рж╕ ржЖржЫрзЗ mixins.RetrieveModelMixin,
  mixins.UpdateModelMixin,mixins.DestroyModelMixin ржЗрждрзНржпрж╛ржжрж┐

Note: mixin ржбрж╛ржЗрж░рзЗржХрзНржЯ ржнрж╛ржмрзЗ GenericAPIView ржХрзЗ ржПржХрзНрж╕ржЯрзЗржирзНржб ржХрж░рзЗ ржирж╛ ржмрж░ржВ ржЗржиржбрж╛ржЗрж░рзЗржХрзНржЯ ржнрж╛ржмрзЗ ржХрж░рзЗ ржорж╛ржирзЗ рж╣рж▓рзЛ
ListAPIView, CreateAPIView, RetrieveUpdateDestroyAPIView ржПржЧрзБрж▓рж╛ GenericAPIView ржПржмржВ рждрж╛рж░ ржЕржкрж╛рж░рзЗрж╢ржи ржПрж░
ржЬржирзНржп ржпрзЗ ржорж┐ржХрзНрж╕рж┐ржи рж▓рж╛ржЧржмрзЗ рж╕рзЗржЯрж╛ ржПржХрзНрж╕ржЯрзЗржирзНржб ржХрж░рзЗ ржпрзЗржоржи ListAPIView mixins.listModelMixin ржХрзЗ ржЖржмрж╛рж░
CreateAPIView Createmodelmixin ржХрзЗ рждрж╛ржЗ mixin ржУ ржЗржиржбрж╛ржЗрж░рзЗржХрзНржЯ ржнрж╛ржмрзЗ GenericAPIView ржХрзЗ ржПржХрзНрж╕ржЯрзЗржирзНржб ржХрж░рзЗ

```python
class RetrieveUpdateDestroyAPIView(mixins.RetrieveModelMixin,
                                   mixins.UpdateModelMixin,
                                   mixins.DestroyModelMixin,
                                   GenericAPIView):
    """
    Concrete view for retrieving, updating or deleting a model instance.
    """
    def get(self, request, *args, **kwargs): #apiview  ржПрж░ get ржорзЗржержб ржЖрж░ get ржнрж┐ржЙ рж░рзЗржирзНржбрж╛рж░ functionaity
        return self.retrieve(request, *args, **kwargs)

    def put(self, request, *args, **kwargs): #apiview  ржПрж░ put  ржорзЗржержб ржЖрж░ put ржнрж┐ржЙ рж░рзЗржирзНржбрж╛рж░ functionaity
        return self.update(request, *args, **kwargs)

    def patch(self, request, *args, **kwargs):   #apiview  ржПрж░ patch  ржорзЗржержб ржЖрж░ patch  ржнрж┐ржЙ рж░рзЗржирзНржбрж╛рж░ functionaity
        return self.partial_update(request, *args, **kwargs)

    def delete(self, request, *args, **kwargs): #apiview  ржПрж░ delete  ржорзЗржержб ржЖрж░ delete  ржнрж┐ржЙ рж░рзЗржирзНржбрж╛рж░ functionaity
        return self.destroy(request, *args, **kwargs)

```

#### ржПржнрж╛ржмрзЗржЗ GenericAPIView ржЗржиржбрж╛ржЗрж░рзЗржХрзНржЯ ржнрж╛ржмрзЗ apiview ржжрзНржмрж╛рж░рж╛ рж░рж╛ржЙржЯрж┐ржВ ржПржирзНржб ржорзЗржержб ржнрж┐ржЙ рж░рзЗржирзНржбрж╛рж░рж┐ржВ рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░рзЗ

---

### ЁЯФО APIView vs GenericAPIView vs ViewSet vs ModelViewSet

| Feature     | APIView              | GenericAPIView          | ViewSet            | ModelViewSet             |
| ----------- | -------------------- | ----------------------- | ------------------ | ------------------------ |
| Base Class  | `APIView`            | `GenericAPIView`        | `ViewSet`          | `ModelViewSet`           |
| Flexibility | Full control         | Semi-automated          | Fully automated    | Fully automated + CRUD   |
| Use Case    | Custom logic         | CRUD with customization | Grouped routes     | Full CRUD with less code |
| When to Use | Complex custom logic | Control + Reuse         | Router with method | Most default use cases   |

---

### ЁЯзй GenericAPIView + Mixins: ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ

### ЁЯз▒ GenericAPIView ржХрж╛ржЬ ржХрзА?

- `queryset` : ржХрж╛ржжрзЗрж░ ржЙржкрж░ ржХрж╛ржЬ рж╣ржмрзЗ
- `serializer_class` : ржХрзЛржи serializer ржЗржЙржЬ рж╣ржмрзЗ
- `.get_queryset()` ржУ `.get_serializer_class()` override ржХрж░рж▓рзЗ ржбрж╛рзЯржирж╛ржорж┐ржХ behavior ржжрзЗржУрзЯрж╛ ржпрж╛рзЯ

### ЁЯФз DRF Mixins

| Mixin                | Functionality    |
| -------------------- | ---------------- |
| `ListModelMixin`     | GET list         |
| `CreateModelMixin`   | POST add         |
| `RetrieveModelMixin` | GET single item  |
| `UpdateModelMixin`   | PUT/PATCH update |
| `DestroyModelMixin`  | DELETE delete    |

**ржХрж╛ржЬрзЗрж░ ржзрж░ржи ржЕржирзБржпрж╛рзЯрзА Mixins ржорж┐рж╢рж┐рзЯрзЗ GenericAPIView ржерзЗржХрзЗ ржирж┐ржЬрзЗрж░ ржнрж┐ржЙ ржмрж╛ржирж╛ржирзЛ ржпрж╛рзЯред**

---

### ЁЯзк ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд Generic Views

#### тЬЕ 1. `ListAPIView`

**ржмрзНржпржмрж╣рж╛рж░:** рж╕ржм ржбрзЗржЯрж╛ рж▓рж┐рж╕рзНржЯ ржЖржХрж╛рж░рзЗ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛

```python
from rest_framework.generics import ListAPIView

class BlogListView(ListAPIView):
    queryset = Blog.objects.all()
    serializer_class = BlogSerializer
```

#### ЁЯФБ Form ржжрж┐рзЯрзЗ:

```python
def blog_list(request):
    blogs = Blog.objects.all()
    return render(request, 'template.html', {'blogs': blogs})
```

### тЬЕ 2. `CreateAPIView`

**ржмрзНржпржмрж╣рж╛рж░:** ржирждрзБржи ржбрзЗржЯрж╛ ржпрзБржХрзНржд ржХрж░рж╛

```python
from rest_framework.generics import CreateAPIView

class BlogCreateView(CreateAPIView):
    queryset = Blog.objects.all()
    serializer_class = BlogSerializer
```

#### ЁЯФБ Form ржжрж┐рзЯрзЗ:

```python
class BlogForm(forms.ModelForm):
    class Meta:
        model = Blog
        fields = '__all__'

def blog_create(request):
    form = BlogForm(request.POST)
    if form.is_valid():
        form.save()
```

### тЬЕ 3. `RetrieveUpdateDestroyAPIView`

**ржмрзНржпржмрж╣рж╛рж░:** ржПржХржЯрж┐ ржбрзЗржЯрж╛ ржжрзЗржЦрж╛ржирзЛ, ржЖржкржбрзЗржЯ ржХрж░рж╛ ржмрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рж╛

```python
from rest_framework.generics import RetrieveUpdateDestroyAPIView

class BlogDetailView(RetrieveUpdateDestroyAPIView):
    queryset = Blog.objects.all()
    serializer_class = BlogSerializer
```

#### ЁЯФБ Form ржжрж┐рзЯрзЗ:

```python
def blog_edit(request, pk):
    blog = get_object_or_404(Blog, pk=pk)
    form = BlogForm(request.POST or None, instance=blog)
    if form.is_valid():
        form.save()
```

---

### тМЫ ржХржЦржи ржХрзЛржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

| ржХрж╛ржЬрзЗрж░ ржзрж░ржи                     | ржХрзЛржи View ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи     |
| ----------------------------- | -------------------------- |
| Full CRUD ржжрж░ржХрж╛рж░               | `ModelViewSet`             |
| Partial/customized CRUD ржжрж░ржХрж╛рж░ | `GenericAPIView` + Mixins  |
| ржЦрзБржм Custom logic ржжрж░ржХрж╛рж░        | `APIView`                  |
| Nested Routing ржжрж░ржХрж╛рж░          | `ViewSet` / `ModelViewSet` |

---

### ЁЯФБ рждрзБрж▓ржирж╛ржорзВрж▓ржХ ржЯрзЗржмрж┐рж▓ (Form vs DRF)

| Task     | Django Form                           | DRF GenericAPIView   |
| -------- | ------------------------------------- | -------------------- |
| List     | Query in view + Template loop         | `ListAPIView`        |
| Create   | `ModelForm`, save()                   | `CreateAPIView`      |
| Retrieve | `get_object_or_404()` + form.instance | `RetrieveModelMixin` |
| Update   | `form(instance=obj).save()`           | `UpdateModelMixin`   |
| Delete   | `obj.delete()`                        | `DestroyModelMixin`  |

---

### ЁЯФР Extra Notes:

- `ListAPIView` = `GenericAPIView` + `ListModelMixin`
- `CreateAPIView` = `GenericAPIView` + `CreateModelMixin`
- `RetrieveUpdateDestroyAPIView` = `GenericAPIView` + `RetrieveModelMixin`+ `updateModelMixin` +
  `updateModelMixin`

---

## тЬЕ Tips:

- ржЫрзЛржЯржЦрж╛ржЯрзЛ customize ржХрж░рж▓рзЗ GenericAPIView + Mixins ржЦрзБржм efficient
- full CRUD ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ ModelViewSet рж╕ржмржЪрзЗрзЯрзЗ рж╢рж░рзНржЯржХрж╛ржЯ ржУ powerful
- highly customizable ржЪрж╛ржЗрж▓рзЗ APIView ржП ржкрзБрж░рзЛ ржХржирзНржЯрзНрж░рзЛрж▓ рж░рж╛ржЦрж╛ ржпрж╛рзЯ

---

## ЁЯУж Bonus: Routing & URL

```python
from django.urls import path
from .views import BlogListView, BlogCreateView, BlogDetailView

urlpatterns = [
    path('blogs/', BlogListView.as_view()),
    path('blogs/create/', BlogCreateView.as_view()),
    path('blogs/<int:pk>/', BlogDetailView.as_view()),
]
```

---

## тЬЕ Day 14: ViewSets & Routers

- ViewSet vs APIView
- viewsets,modelviewset,readonlyviewset
- Routers ржжрж┐рзЯрзЗ URL config
- ViewSet actions (list, retrieve, create, etc.)

### ЁЯФ╣ 1. APIView ржХрж┐?

`APIView` рж╣рж▓ Django REST Framework ржПрж░ рж╕ржмржЪрзЗрзЯрзЗ Base ржХрзНрж▓рж╛рж╕ API рждрзИрж░рж┐ ржХрж░рж╛рж░ ржЬржирзНржпред ржПржЯрж┐ Python-ржПрж░ рж╕рж╛ржзрж╛рж░ржг
ржХрзНрж▓рж╛рж╕ ржнрж┐рждрзНрждрж┐ржХ View-ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗред

### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

- ржпржЦржи ржЖржорж╛ржжрзЗрж░ ржкрзБрж░рзЛ ржХрж╛рж╕рзНржЯржорж╛ржЗржЬржб control ржжрж░ржХрж╛рж░ HTTP methods ржПрж░ ржЙржкрж░ред

### ЁЯза Structure:

```python
from rest_framework.views import APIView
from rest_framework.response import Response

class MyAPIView(APIView):
    def get(self, request):
        return Response({"message": "GET request"})

    def post(self, request):
        return Response({"message": "POST request"})
```

---

### ЁЯФ╣ 2. ViewSet ржХрж┐?

`ViewSet` ржПржХржЯрж┐ ржХрзНрж▓рж╛рж╕ ржпрзЗржЯрж┐ APIView ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рждрзИрж░рж┐, ржХрж┐ржирзНрждрзБ ржПрждрзЗ HTTP methods ржЧрзБрж▓рзЛ ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗ ржирж╛
рж▓рж┐ржЦрзЗ ржПржХрж╕рж╛ржерзЗ CRUD operations handle ржХрж░рж╛ ржпрж╛рзЯред list create ржПрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ class ржЖржмрж╛рж░
update,delete,retrive ржПрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ ржХрзНрж▓рж╛рж╕ рж▓рж┐ржЦрж╛рж░ ржжрж░ржХрж╛рж░ рж╣рзЯ viewset rouder ржПрж░ ржжрзНржмрж╛рж░рж╛ ржХрж╛ржЬ ржХрж░рзЗ рж░рж╛ржЙржЯрж╛рж░
ржирж┐ржЬрзЗ route create ржХрж░рждрзЗ ржкрж╛рж░рзЗ рждрж╛ржЗ ржЖржорж╛ржжрзЗрж░ ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ ржнрж┐ржЙрж╕рзЗржЯ ржПрж░ ржЬржирзНржп route рж▓рж┐ржЦрж╛рж░ ржжрж░ржХрж╛рж░ рж╣рзЯ ржирж╛ deafalt
рж░рж╛ржЙржЯрж╛рж░ ржП рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░ ржХрж░рж▓рзЗ рж╣рзЯред рж╕рзЗржЗ рж╕ржм route ржмрж╛ржирж┐рзЯрзЗ ржПржХржЯрж╛ urlpattern ржмрж╛ржирж┐рзЯрзЗ ржжрзЗрзЯред

### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

- ржпржЦржи ржЖржорж░рж╛ CRUD operation ржХрж░ржмрзЛ ржПржмржВ ржкрзНрж░рждрж┐ржмрж╛рж░ `get`, `post`, `put`, `delete` ржЖрж▓рж╛ржжрж╛ ржЖрж▓рж╛ржжрж╛ ржХрзНрж▓рж╛рж╕рзЗ ржПрж░ржХржо
  apiview ржПрж░ ржорждрзЛ ржХрж░рзЗ ржирж╛ рж▓рж┐ржЦрзЗ shortcut ржП ржХрж╛ржЬ ржХрж░рждрзЗ ржЪрж╛ржЗредржПржмржВ ржирж┐ржЬрзЗ ржЗржЙржЖрж░ржПрж▓ ржорзНржпрж╛ржкрж┐ржВ ржХрж░рждрзЗ ржирж╛ ржЪрж╛ржЗрж▓рзЗ ржЖржорж░рж╛
  ржнрж┐ржЙрж╕рзЗржЯ use ржХрж░ржмрзЛред

### ЁЯза Structure:

```python
from rest_framework.viewsets import ViewSet

class MyViewSet(ViewSet):
    def list(self, request):
        return Response({"message": "List of data"})

    def retrieve(self, request, pk=None):
        return Response({"message": f"Single data {pk}"})
```

> тЪая╕П ржПржЦрж╛ржирзЗ `as_view()` method ржмрзНржпрж╛ржмрж╣рж╛рж░рзЗрж░ ржжрж░ржХрж╛рж░ ржирзЗржЗ, DRF ржПрж░ `routers` ржПржЧрзБрж▓рзЛ auto-map ржХрж░рзЗ ржжрзЗрзЯред

---

### ЁЯФ╣ 3. ModelViewSet ржХрж┐?

`ModelViewSet` рж╣ржЪрзНржЫрзЗ `ViewSet` ржПрж░ subclass, ржпрзЗржЯрж╛ ржоржбрзЗрж▓ ржПржмржВ serializer ржирж┐рзЯрзЗ ржкрзБрж░рзЛ CRUD automatically
handle ржХрж░рзЗред `modelviewset` mixins.CreateModelMixin, mixins.RetrieveModelMixin,
mixins.UpdateModelMixin, mixins.DestroyModelMixin, mixins.ListModelMixin, GenericViewSet ржХрзЗ
ржПржХрзНрж╕ржЯрзЗржирзНржб ржХрж░рзЗ ржпрж╛рж░ ржлрж▓рзЗ ржЖржмрж╛рж░ genericviewset ViewSetMixin, generics.GenericAPIView ржХрзЗ extend ржХрж░рзЗ ржпрж╛рж░
ржлрж▓рзЗ ржмрж▓рж╛ ржпрж╛рзЯ modelviewset ржЗржиржбрж╛ржЗрж░рзЗржХрзНржЯ ржнрж╛ржмрзЗ ржнрж┐ржЙрж╕рзЗржЯ ржХрзЗ ржПржХрзНрж╕ржЯрзЗржирзНржб ржХрж░рзЗ ржпрж╛рж░ ржлрж▓рзЗ ржоржбрзЗрж▓ ржнрж┐ржЙрж╕рзЗржЯ ржПрж░ feacher
router ржПрж░ рж╕рж╛ржкрзЛрж░рзНржЯ ржкрж╛рзЯ ржЖрж░ list ,create ,retrive, destry etc рж╕ржм ржнрж┐ржЙ ржорж┐ржХрзНрж╕рж┐ржи ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ ржХрж░рзЗ ржпрж╛рж░ ржлрж▓рзЗ
ржЖржорж╛ржжрзЗрж░ ржЬрж╛рж╕рзНржЯ рж╕рзЗрж░рж┐рзЯрж╛рж▓рж┐ржЬрзЗрж░ ржЖрж░ queryset ржжрж┐рждрзЗ рж╣рзЯ agenericapiview ржХрзЗ рждрж╛рж░ ржХрж╛ржЫ ржерзЗржХрзЗ рж╕ржм serializer
,queryset,filter ,serch etc рж╕ржм ржирзЗрзЯ genericviewset ржПржмржВ рж╕рзЗржЗ ржЕржирзБржпрж╛рзЯрзА get ржорзЗржержб ржП рж▓рж┐рж╕рзНржЯ pk ржкрж╛ржарж╛рж▓рзЗ retrive
,post ржП create ржЯрж┐ = etc ржПржнрж╛ржмрзЗ autommatic рж╕ржм рж╣рзНржпрж╛ржирзНржбрзЗрж▓ рж╣рзЯред

### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

- ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп ржкрзБрж░рзЛ CRUD рждрзИрж░рж┐ ржХрж░рждрзЗ ржЪрж╛ржЗ ржЦрзБржм рж╕рж╣ржЬрзЗред

### ЁЯза Structure:

```python
from rest_framework.viewsets import ModelViewSet
from .models import MyModel
from .serializers import MyModelSerializer

class MyModelViewSet(ModelViewSet):
    queryset = MyModel.objects.all()
    serializer_class = MyModelSerializer
```

---

### ЁЯФ╣ 4. ReadOnlyModelViewSet ржХрж┐?

`ReadOnlyModelViewSet` ржУ `ModelViewSet` ржПрж░ ржорждрзЛ, ржХрж┐ржирзНрждрзБ рж╢рзБржзрзБ `list` ржУ `retrieve` method ржжрзЗрзЯред ржХрзЛржи ржХрж┐ржЫрзБ
Create, Update, Delete ржХрж░рж╛ ржпрж╛рзЯ ржирж╛ред

### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

- ржпржЦржи рж╢рзБржзрзБ data ржжрзЗржЦрждрзЗ ржжрж┐ржмрзЛ, ржХрж┐ржирзНрждрзБ edit ржХрж░рждрзЗ ржжрж┐ржмрзЛ ржирж╛ред

### ЁЯза Structure:

```python
from rest_framework.viewsets import ReadOnlyModelViewSet

class MyReadOnlyViewSet(ReadOnlyModelViewSet):
    queryset = MyModel.objects.all()
    serializer_class = MyModelSerializer
```

---

### ЁЯФ╣ 5. Routers ржжрж┐рзЯрзЗ URL Configuration

`ViewSet` ржмрж╛ `ModelViewSet` use ржХрж░рж▓рзЗ ржирж┐ржЬрзЗ URL path рж▓рж┐ржЦрждрзЗ рж╣рзЯ ржирж╛, `router` automatically рж╕ржм URL рждрзИрж░рж┐
ржХрж░рзЗ ржжрзЗрзЯред

### тЬЕ ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

- ржкрзНрж░рждрж┐ржЯрж╛ route ржирж┐ржЬрзЗ рж▓рж┐ржЦрж╛рж░ ржЭрж╛ржорзЗрж▓рж╛ ржерзЗржХрзЗ ржмрж╛ржБржЪрж╛рж░ ржЬржирзНржпред

### ЁЯза Structure:

```python
from rest_framework.routers import DefaultRouter
from .views import MyModelViewSet

router = DefaultRouter()
router.register(r'myapi', MyModelViewSet, basename='myapi')
                   ред_ prefix    ред_viewclass

urlpatterns = [
    path('', include(router.urls)),
]
```

#### router internally ржирж┐ржЪрзЗрж░ ржорждрзЛ ржХрж░рзЗ ржХрж╛ржЬ ржХрж░рзЗред

```python

  [
      path("prefix/",viewset.as_view({"get":"list","post":"create"}),
      path("prefix/<int:pk>/",viewset.as_view({"get":"retrive","put":"update","delete":"destroy","patch":"partial-update"}))
  ]

```

##### note: as_view() te paramitar hisabe configer viewset e pathano jay apiview e jay na.

### ЁЯСЙ ржПржЯрж╛ automatically ржирж┐ржЪрзЗрж░ URL ржЧрзБрж▓рзЛ рждрзИрж░рж┐ ржХрж░рзЗ:

- GET `/myapi/` тЖТ list() // url name-> basename-list
- GET `/myapi/<pk>/` тЖТ retrieve() // url name-> basename-retrieve
- POST `/myapi/` тЖТ create() // url name-> basename-create
- PUT `/myapi/<pk>/` тЖТ update() // url name-> basename-update
- DELETE `/myapi/<pk>/` тЖТ destroy() // url name-> basename-destroy

---

#### prefix vs name

| ржмрж┐рж╖рзЯ        | `prefix`                                   | `basename`                                   |
| ----------- | ------------------------------------------ | -------------------------------------------- |
| ржХрж╛ржЬ         | ржПрж░ ржУржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржкрзНрж░рждрж┐ржЯрж╛ URL path ржарж┐ржХ ржХрж░рзЗ | ржПрж░ ржУржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржкрзНрж░рждрж┐ржЯрж╛ Route name ржарж┐ржХ ржХрж░рзЗ |
| ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ  | рззржо argument рж╣рж┐рж╕рж╛ржмрзЗ                         | рзйрзЯ argument рж╣рж┐рж╕рж╛ржмрзЗ                           |
| ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛ | Always required                            | Optional (queryset ржерж╛ржХрж▓рзЗ ржирж╛ ржжрж┐рж▓рзЗржУ ржЪрж▓рзЗ)       |
| ржЙржжрж╛рж╣рж░ржг      | `'books'` тЖТ `/books/`                      | `'book'` тЖТ `book-list`, `book-detail`        |

### ЁЯФ╣ ViewSet ржПрж░ Built-in Methods

| Method Name      | Description                 |
| ---------------- | --------------------------- |
| list()           | рж╕ржм object ржПрж░ рж▓рж┐рж╕рзНржЯ ржжрзЗржЦрж╛рзЯ    |
| retrieve()       | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржПржХржЯрж┐ object ржжрзЗржЦрж╛рзЯ |
| create()         | ржирждрзБржи object рждрзИрж░рж┐ ржХрж░рзЗ        |
| update()         | ржкрзБрж░рж╛ object ржЖржкржбрзЗржЯ ржХрж░рзЗ       |
| partial_update() | ржХрж┐ржЫрзБ ржЕржВрж╢ ржЖржкржбрзЗржЯ ржХрж░рзЗ (PATCH)  |
| destroy()        | object ржбрж┐рж▓рж┐ржЯ ржХрж░рзЗ            |

---

### ЁЯФ╣ ViewSet vs APIView рждрзБрж▓ржирж╛

| Feature     | APIView                       | ViewSet / ModelViewSet |
| ----------- | ----------------------------- | ---------------------- |
| Control     | ржмрзЗрж╢рж┐ ржХрж╛рж╕рзНржЯржорж╛ржЗржЬржб               | ржХржо ржХрж╛рж╕рзНржЯржорж╛ржЗржЬржб          |
| URL mapping | ржирж┐ржЬрзЗ ржХрж░рждрзЗ рж╣рзЯ                  | Router auto-handle ржХрж░рзЗ |
| Use case    | ржпржЦржи ржПржХржжржо ржирж┐ржЬрзЗ logic рж▓рж┐ржЦрждрзЗ ржЪрж╛ржЗ | ржпржЦржи CRUD ржЕржЯрзЛ ржЪрж╛ржЗ       |

---

#### ЁЯФ╣ ржХржЦржи ржХрзЛржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

| Condition                              | Use                    |
| -------------------------------------- | ---------------------- |
| рж╕ржорзНржкрзВрж░рзНржг ржХрж╛рж╕рзНржЯржо API behavior ржжрж░ржХрж╛рж░     | `APIView`              |
| Simple CRUD ржжрж░ржХрж╛рж░                      | `ModelViewSet`         |
| рж╢рзБржзрзБ ржжрзЗржЦрж╛ржмрзЛ (read-only)                | `ReadOnlyModelViewSet` |
| ржХрж╛рж╕рзНржЯржо method рж╕рж╣ CRUD control ржХрж░рждрзЗ ржЪрж╛ржЗ | `ViewSet` + `@action`  |

---

#### ЁЯФ╣ Bonus: ViewSet ржПрж░ Custom Action

```python
from rest_framework.decorators import action

class MyViewSet(ViewSet):
    @action(detail=True, methods=['get'])
    def custom_action(self, request, pk=None):
        return Response({"msg": "This is custom action"})
```

URL: `/myviewset/<pk>/custom_action/`

---

#### ЁЯФ╣ Extra: ViewSet ржПрж░ ржнрж┐рждрж░рзЗ as_view() ржирж╛ рж▓рж╛ржЧрж╛рж░ ржХрж╛рж░ржг

`ViewSet` class ржПрж░ ржЬржирзНржп DRF-ржПрж░ router system automatically URL map ржХрж░рзЗ ржжрзЗрзЯред ржХрж┐ржирзНрждрзБ `APIView`
ржмрзНржпрж╛ржмрж╣рж╛рж░ ржХрж░рж▓рзЗ, ржирж┐ржЬрзЗрж░ рж╣рж╛рждрзЗ `.as_view()` ржжрж┐рждрзЗ рж╣рзЯ, ржХрж╛рж░ржг Django ржмрзБржЭрзЗ ржирж╛ ржХрзЛржи method handle ржХрж░ржмрзЗред

---

### тЬЕ Summary:

- `APIView`: ржмрзЗрж╢рж┐ ржХрж╛рж╕рзНржЯржо ржХрж╛ржЬрзЗрж░ ржЬржирзНржпред
- `ViewSet`: ржЕржирзЗржХ ржХрж╛ржЬ shortcut ржП ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗред
- `ModelViewSet`: CRUD ржЦрзБржм рж╕рж╣ржЬрзЗ рждрзИрж░рж┐ ржХрж░рждрзЗред
- `ReadOnlyModelViewSet`: рж╢рзБржзрзБ ржжрзЗржЦрж╛ржирзЛрж░ ржЬржирзНржпред
- `router`: ViewSet URL ржЕржЯрзЛ handle ржХрж░рзЗред

---

## тЬЕ Day 15: API Testing (Postman)

- Postman ржжрж┐рзЯрзЗ API GET/POST

- Header set, Auth, Params, Body

- API error handling

- Django-рждрзЗ CORS allow ржХрж░рж╛

---

### ЁЯзк 1. API Testing (Postman)

### ржХрзЗржи API Testing ржХрж░ржмрзЛ?

Django-рждрзЗ ржЖржорж░рж╛ ржпржЦржи API рждрзИрж░рж┐ ржХрж░рж┐ (DRF ржжрж┐рзЯрзЗ), рждржЦржи ржЪрж╛ржЗ ржпрзЗ Client рж╕ржарж┐ржХржнрж╛ржмрзЗ request ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░ржмрзЗ ржПржмржВ
Server ржарж┐ржХржнрж╛ржмрзЗ response ржжрж┐ржмрзЗред ржПржЗржЯрж╛ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ Postman ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ред

### Postman ржХрзА?

Postman ржПржХржЯрж┐ GUI-based tool, ржпрзЗржЯрж╛ ржжрж┐рзЯрзЗ рждрзБржорж┐ API call (GET, POST, PUT, DELETE etc) ржХрж░рждрзЗ ржкрж╛рж░рзЛ тАФ рж╕рж╣ржЬрзЗред

---

### ЁЯФБ 2. Postman ржжрж┐рзЯрзЗ API GET / POST

### ЁЯФ╣ GET Request:

- ржбрзЗржЯрж╛ ржжрзЗржЦрж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ
- Example:
  - Endpoint: `http://127.0.0.1:8000/api/blogs/`
  - Method: `GET`
  - Postman-ржП рж╢рзБржзрзБ URL ржжрж┐рзЯрзЗ **Send** ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗржЗ JSON data ржЪрж▓рзЗ ржЖрж╕ржмрзЗ

### ЁЯФ╣ POST Request:

- ржирждрзБржи ржбрзЗржЯрж╛ add ржХрж░рж╛рж░ ржЬржирзНржп
- Example:
  - Endpoint: `http://127.0.0.1:8000/api/blogs/`
  - Method: `POST`
  - Body > raw > JSON format:
    ```json
    {
      "title": "My Blog",
      "content": "This is my blog post."
    }
    ```
  - рждрж╛рж░ржкрж░ **Send**

---

### ЁЯУС 3. Headers, Auth, Params, Body

### ЁЯФ╕ Headers:

Headers рж╣рж▓ ржПржоржи рждржерзНржп ржпрж╛ Client ржПржмржВ Server-ржПрж░ ржоржзрзНржпрзЗ communication ржПрж░ ржЬржирзНржп ржжрж░ржХрж╛рж░ рж╣рзЯред

#### Headers рзи ржкрзНрж░ржХрж╛рж░:

1. **General Headers** тАУ Meta info ржжрзЗрзЯ
2. **Request Headers** тАУ Client ржерзЗржХрзЗ ржпрж╛рзЯ
3. **Response Headers** тАУ Server ржерзЗржХрзЗ ржЖрж╕рзЗ

### рзз General Headers:

> HTTP General Headers ржорж╛ржирзЗ ржПржоржи header ржЧрзБрж▓рж╛ ржпрж╛ request ржПржмржВ response ржЙржнржпрж╝ ржХрзНрж╖рзЗрждрзНрж░рзЗржЗ ржмрзНржпржмрж╣рзГржд рж╣рждрзЗ ржкрж╛рж░рзЗред
> ржПржЗ headers ржЧрзБрж▓рж╛ ржорзВрж▓ржд message-ржПрж░ meta-information ржмрж╣ржи ржХрж░рзЗ тАФ ржпрзЗржоржи message caching, connection info,
> ржЕржержмрж╛ date/time ржПрж░ ржорждрзЛ ржмрж┐рж╖рзЯред

- ржПржЧрзБрж▓рзЛ ржПржоржи header ржпрж╛ client тЖТ server ржПржмржВ server тЖТ client ржЙржнржпрж╝ ржжрж┐ржХрзЗржЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред
- ржПржЧрзБрж▓рзЛрж░ ржХрж╛ржЬ рж╣ржЪрзНржЫрзЗ message-ржПрж░ ржЖржЪрж░ржг ржУ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рж╛, ржХрж┐ржирзНрждрзБ ржПржЧрзБрж▓рзЛ body ржмрж╛ content-ржПрж░ ржмрж┐рж╖рзЯрзЗ
  ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж┐ржЫрзБ ржмрж▓рзЗ ржирж╛ред

- General Headers рж╕ржм рж╕ржорзЯ message-ржПрж░ body ржирзЯ, ржмрж░ржВ message ржирж┐ржЬрзЗржЗ ржХрж┐ржнрж╛ржмрзЗ handle рж╣ржмрзЗ рждрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗред

- ржПржЧрзБрж▓рзЛ content-specific ржирзЯ, ржпрзЗржоржи content-type, content-length ржПржЧрзБрж▓рзЛ entity headers ржмрж╛
  representation headers ржП ржкрзЬрзЗред

#### ЁЯОпMost Common Built-in HTTP General Headers (Meta Info ржжрзЗрзЯ)

| Header              | ржХрж╛ржЬ                                                         | ржХрзЛржерж╛рзЯ/ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ                                        | ржирж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзА рж╣рждрзЗ ржкрж╛рж░рзЗ                           |
| ------------------- | ----------------------------------------------------------- | ----------------------------------------------------------- | ----------------------------------------------------- |
| `Cache-Control`     | ржХржирзНржЯрзЗржирзНржЯ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржХрждржХрзНрж╖ржг ржХрзНржпрж╛рж╢рзЗ ржерж╛ржХржмрзЗ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ      | Performance optimization, SPA ржмрж╛ static content ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ | ржХржирзНржЯрзЗржирзНржЯ ржмрж╛рж░ржмрж╛рж░ рж▓рзЛржб рж╣ржмрзЗ тЖТ Performance slow            |
| `Connection`        | рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржирзЗржХрж╢ржи ржерж╛ржХржмрзЗ ржХрж┐ржирж╛ рждрж╛ ржмрж▓рзЗ (keep-alive/close) | Persistent connection ржПрж░ ржЬржирзНржп                               | ржкрзНрж░рждрж┐ржмрж╛рж░ request ржП ржирждрзБржи ржХрж░рзЗ TCP connection ржЦрзЛрж▓рж╛ рж▓рж╛ржЧржмрзЗ |
| `Date`              | рж░рзЗрж╕ржкржирзНрж╕ржЯрж┐ ржХржЦржи ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ                             | Time validation/check ржПрж░ ржЬржирзНржп                               | Response ржПрж░ рж╕ржорзЯ ржЬрж╛ржирж╛ ржпрж╛ржмрзЗ ржирж╛, sync issue рж╣рждрзЗ ржкрж╛рж░рзЗ     |
| `Transfer-Encoding` | ржХржиржЯрзЗржирзНржЯ ржХрж┐ржнрж╛ржмрзЗ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ (chunked etc.)          | Large content break ржХрж░рзЗ ржкрж╛ржарж╛ржирзЛрж░ ржЬржирзНржп                        | ржмрзЬ response ржкрж╛ржарж╛рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗ                    |
| `Via`               | ржХрзЛржи intermediate proxy/gateway рж╣рзЯрзЗ ржПрж╕рзЗржЫрзЗ рждрж╛ ржЬрж╛ржирж╛рзЯ           | Proxy server ржмрж╛ caching mechanism ржмрзНржпржмрж╣рж╛рж░рзЗ                  | Proxy troubleshooting ржХржарж┐ржи рж╣рзЯрзЗ ржкрзЬрзЗ                    |

ЁЯСЙ Example General headers:

```http
GET /api/users HTTP/1.1
Host: example.com
Authorization: Bearer abc123xyz
Accept: application/json
User-Agent: Mozilla/5.0

```

### рзи Request Headers (Client тЖТ Server ржпрж╛рзЯ):

> HTTP Request Headers ржорзВрж▓ржд client (ржпрзЗржоржи browser ржмрж╛ Postman) ржпржЦржи server-ржПрж░ ржХрж╛ржЫрзЗ ржХрзЛржи request ржкрж╛ржарж╛рзЯ,
> рждржЦржи рж╕рж╛ржерзЗ ржХрж┐ржЫрзБ ржЕрждрж┐рж░рж┐ржХрзНржд рждржерзНржп ржкрж╛ржарж╛ржирзЛ рж╣рзЯ header-ржПрж░ ржорж╛ржзрзНржпржорзЗред ржПржЧрзБрж▓рзЛ server ржХрзЗ ржмрж▓рзЗ ржжрзЗрзЯ request рж╕ржорзНржкрж░рзНржХрзЗ
> context, ржпрзЗржоржи content format, authentication token, language preference ржЗрждрзНржпрж╛ржжрж┐ред

#### ЁЯОпMost Common Built-in HTTP Request Headers

| Header          | ржХрж╛ржЬ                                                       | ржХрзЛржерж╛рзЯ/ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ                          | ржирж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзА рж╣рждрзЗ ржкрж╛рж░рзЗ                 |
| --------------- | --------------------------------------------------------- | --------------------------------------------- | ------------------------------------------- |
| `Host`          | ржХрзЛржи ржбрзЛржорзЗржЗржирзЗрж░ ржЬржирзНржп рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ                     | Server multiple site handle ржХрж░рж▓рзЗ              | рж╕рж╛рж░рзНржнрж╛рж░ ржмрзБржЭржмрзЗ ржирж╛ ржХрзЛржи site ржПрж░ ржЬржирзНржп рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ |
| `User-Agent`    | Client-ржПрж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржмрж╛ ржбрж┐ржнрж╛ржЗрж╕ info ржжрзЗрзЯ                     | Analytics, device-specific content serve ржХрж░рждрзЗ | Browser compatibility issue рж╣рждрзЗ ржкрж╛рж░рзЗ        |
| `Accept`        | Client ржХрзЛржи ржЯрж╛ржЗржкрзЗрж░ content ржЪрж╛рзЯ (e.g., JSON, HTML)          | REST API, Content negotiation ржП               | Server ржнрзБрж▓ format ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░рзЗ               |
| `Authorization` | Access token ржмрж╛ credentials ржкрж╛ржарж╛рзЯ                         | Protected route access ржХрж░рждрзЗ                   | Unauthorized (401) error ржЖрж╕ржмрзЗ               |
| `Content-Type`  | Client ржХржиржЯрзЗржирзНржЯрзЗрж░ ржЯрж╛ржЗржк declare ржХрж░рзЗ (e.g., JSON, form-data) | POST, PUT рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯрзЗ body parse ржХрж░рж╛рж░ ржЬржирзНржп     | Server body ржмрзБржЭрждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ тЖТ Error 415      |

#### ЁЯСЙ Example Request headers:

```http
GET /api/users HTTP/1.1
Host: example.com
Authorization: Bearer abc123xyz
Accept: application/json
User-Agent: Mozilla/5.0

```

#### тЬЕ Custom Headers:

##### Custom header ржЧрзБрж▓рзЛ рж╕рж╛ржзрж╛рж░ржиржд X- ржжрж┐рзЯрзЗ рж╢рзБрж░рзБ рж╣рзЯред

```http
X-Auth-Token: your_token_here
X-API-Key: abc123xyz
```

#### Header ржирж╛ ржжрж┐рж▓рзЗ ржХрзА рж╕ржорж╕рзНржпрж╛?

- Server ржмрзБржЭрждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ ржХрзЛржи format-ржП data ржПрж╕рзЗржЫрзЗ
- Secure API-рждрзЗ Access Token ржирж╛ ржерж╛ржХрж▓рзЗ `401 Unauthorized` error ржжрж┐ржмрзЗ

### рзй. Response Headers (Server тЖТ Client ржкрж╛ржарж╛рзЯ)

> Django (ржмрж╛ ржпрзЗржХрзЛржирзЛ ржУрзЯрзЗржм ржлрзНрж░рзЗржоржУрзЯрж╛рж░рзНржХ)-ржПрж░ HTTP Response ржП ржпрзЗ Headers ржерж╛ржХрзЗ, рж╕рзЗржЧрзБрж▓рзЛ ржорзВрж▓ржд client
> (browser ржмрж╛ API consumer)-ржПрж░ ржХрж╛ржЫрзЗ ржХрж┐ржЫрзБ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг metadata ржкрж╛ржарж╛ржирзЛрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯредржПржЧрзБрж▓рзЛ рж╣рж▓рзЛ
> Key-Value pair ржЖржХрж╛рж░рзЗ рждржерзНржп ржпрж╛ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржмрж╛ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯржХрзЗ ржЬрж╛ржирж╛рзЯ Response-ржПрж░ ржзрж░ржи, Cache ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржХрж┐ржирж╛,
> Content ржХрзА ржзрж░ржирзЗрж░, ржХржд ржмрзЬ ржЗрждрзНржпрж╛ржжрж┐ред

##### тЬЕ Response Headers-ржПрж░ ржзрж░ржг

> Response Headers ржХрзЗ ржЖржорж░рж╛ ржХрзЯрзЗржХржЯрж┐ ржнрж╛ржЧрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

| ржзрж░ржи                  | ржмрж░рзНржгржирж╛                                   |
| -------------------- | ---------------------------------------- |
| **General Headers**  | Server ржПржмржВ client ржЙржнрзЯрзЗрж░ ржЬржирзНржп рж╕рж╛ржзрж╛рж░ржг рждржерзНржп |
| **Response Headers** | Server рж╕ржорзНржкрж░рзНржХрж┐ржд рждржерзНржп                    |
| **Entity Headers**   | ржорзВрж▓ content (body) рж╕ржорзНржкрж░рзНржХрзЗ рждржерзНржп         |
| **Security Headers** | ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд      |

#### ЁЯОпMost Common Built-in HTTP Response Headers

| Header                        | ржХрж╛ржЬ                                                  | ржХрзЛржерж╛рзЯ/ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ                     | ржирж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзА рж╣рждрзЗ ржкрж╛рж░рзЗ              |
| ----------------------------- | ---------------------------------------------------- | ---------------------------------------- | ---------------------------------------- |
| `Content-Type`                | рж░рзЗрж╕ржкржирзНрж╕рзЗрж░ content ржЯрж╛ржЗржк ржмрж▓рзЗ (HTML, JSON, etc.)        | ржмрзНрж░рж╛ржЙржЬрж╛рж░/ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ рж╕ржарж┐ржХржнрж╛ржмрзЗ render ржХрж░рждрзЗ  | ржбрзЗржЯрж╛ ржнрзБрж▓ржнрж╛ржмрзЗ render/show рж╣рждрзЗ ржкрж╛рж░рзЗ        |
| `Content-Length`              | ржХржиржЯрзЗржирзНржЯрзЗрж░ total byte size ржмрж▓рзЗ                        | Download/file transfer/streaming ржП       | Incomplete ржмрж╛ corrupt data ржЖрж╕рждрзЗ ржкрж╛рж░рзЗ     |
| `Set-Cookie`                  | Cookie ржХрзНрж▓рж╛рзЯрзЗржирзНржЯрзЗ рж╕рзЗржЯ ржХрж░рждрзЗ                           | Session management, auth token save      | рж▓ржЧржЗржи рж╕рж┐рж╕рзНржЯрзЗржо ржХрж╛ржЬ ржХрж░ржмрзЗ ржирж╛                 |
| `Access-Control-Allow-Origin` | ржХрзЛржи origin ржерзЗржХрзЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржЖрж╕рждрзЗ ржкрж╛рж░ржмрзЗ рждрж╛ ржмрж▓рзЗ          | Cross-origin requests (CORS) handle ржХрж░рждрзЗ | ржЕржирзНржп origin ржерзЗржХрзЗ API access рж╕ржорзНржнржм рж╣ржмрзЗ ржирж╛ |
| `ETag`                        | ржХржирзНржЯрзЗржирзНржЯ ржЪрзЗржЮрзНржЬ рж╣рзЯрзЗржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рж╛рж░ ржЬржирзНржп version/hash | Cache validation ржПржмржВ bandwidth ржХржорж╛рждрзЗ     | ржкрзБрж░рзЛржирзЛ ржмрж╛ ржнрзБрж▓ ржХрзНржпрж╛рж╢ржб ржбрзЗржЯрж╛ рж▓рзЛржб рж╣рждрзЗ ржкрж╛рж░рзЗ   |

### тЬЕ ржЙржжрж╛рж╣рж░ржг (Django view ржерзЗржХрзЗ):

```python
from django.http import HttpResponse

def my_view(request):
    response = HttpResponse("Hello, World!")
    response['Content-Type'] = 'text/plain'
    response['Cache-Control'] = 'no-cache'
    response['X-Custom-Header'] = 'MyApp'
    return response

```

#### тЬЕ Bonus: Django Response Header ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ ржХрзЛржерж╛рзЯ?

- Browser DevTools тЖТ Network тЖТ Headers Tab
- Postman тЖТ Response тЖТ Headers
- Python code ржжрж┐рзЯрзЗ:

```python
response = client.get('/some-url/')
print(response.headers)
```

### тЬЕ рж╕ржВржХрзНрж╖рж┐ржкрзНрждржнрж╛ржмрзЗ (Auto bind and none bind header):

| Header ржЯрж╛ржЗржк | Auto bind рж╣рзЯ                                     | Manually bind ржХрж░рждрзЗ рж╣рзЯ                                       |
| ----------- | ------------------------------------------------ | ----------------------------------------------------------- |
| General     | `Date`, `Connection`, `Transfer-Encoding`, `Via` | `Cache-Control`                                             |
| Request     | `Host`, `User-Agent`, `Accept`                   | `Authorization`, `Content-Type`                             |
| Response    | `Content-Length`, `ETag`                         | `Content-Type`, `Set-Cookie`, `Access-Control-Allow-Origin` |

### ЁЯФ╕ Auth:

Postman-ржП:

- Authorization Tab > Type: Token/Auth
- Token ржЯрж╛ржЗржк ржжрж┐рж▓рзЗ Header-ржП auto ржпрзЛржЧ рж╣рзЯ

### ЁЯФ╕ Params:

- Query parameters (URL ржПрж░ рж╢рзЗрж╖рзЗ ?name=value)
- Example: `/blogs/?author=monira`

### ЁЯФ╕ Body:

- рж╢рзБржзрзБ POST, PUT, PATCH method ржП рж▓рж╛ржЧрзЗ
- Postman-ржП: Body > raw > JSON

---

## тЭМ 4. API Error Handling

### ржХрзЗржи ржжрж░ржХрж╛рж░?

- Client ржХрзЗ ржмрзБржЭрж╛ржирзЛ ржжрж░ржХрж╛рж░ ржпрзЗ request-ржП ржХрзА ржнрзБрж▓ ржЫрж┐рж▓

### Django DRF-ржП Error Handling ржПрж░ Step-by-Step Process:

#### тЬЕ Step 1: Validation error example (Serializer)

```python
def validate_title(self, value):
    if "badword" in value:
        raise serializers.ValidationError("Invalid title")
    return value
```

#### тЬЕ Step 2: View-ржП try-except

```python
from rest_framework.response import Response
from rest_framework import status

def post(self, request):
    try:
        serializer = BlogSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=201)
        return Response(serializer.errors, status=400)
    except Exception as e:
        return Response({'error': str(e)}, status=500)
```

#### тЬЕ Step 3: Postman-ржП response ржжрзЗржЦрзЛ

```json
{
  "title": ["Invalid title"]
}
```

#### тЬЕ Common Error Codes:

| Status Code | ржорж╛ржирзЗ                               |
| ----------- | ---------------------------------- |
| 200         | Success                            |
| 201         | Created                            |
| 400         | Bad Request (ржнрзБрж▓ data)             |
| 401         | Unauthorized (token ржирж╛ржЗ / invalid) |
| 403         | Forbidden (permission ржирж╛ржЗ)         |
| 404         | Not Found                          |
| 500         | Server Error                       |

---

## тЬЕ Bonus: CORS Issue Fix (Browser Access)

### Django-рждрзЗ CORS allow ржХрж░рждрзЗ:

1. `pip install django-cors-headers`
2. settings.py ржП ржпрзЛржЧ ржХрж░рзЛ:

```python
INSTALLED_APPS = [
  ...
  'corsheaders',
]

MIDDLEWARE = [
  'corsheaders.middleware.CorsMiddleware',
  ...
]

CORS_ALLOW_ALL_ORIGINS = True  # development time only
```

---

## ЁЯУМ Summary Checklist (Revision Time)

тЬЕ Postman setup ржХрж░рзЗржЫрзЛ тЬЕ GET/POST ржХрж░рзЗ response ржкрзЗрзЯрзЗржЫрзЛ тЬЕ Header, Body, Params use ржХрж░рждрзЗ ржкрж╛рж░рзЛ тЬЕ
Token based Auth ржХрж░рзЗржЫрзЛ тЬЕ Error Handling implement ржХрж░рзЗржЫрзЛ тЬЕ CORS fix ржХрж░рзЗржЫрзЛ browser access ржПрж░ ржЬржирзНржп

---

## тЬЕ Day 16: Filtering & Searching

- django-filter use
- filter_backends
- SearchFilter
- OrderingFilter
- django_filter
- filterset

---

### ЁЯФ╣ 1. django-filter ржХрзА?

`django-filter` рж╣рж▓ Django REST Framework (DRF)-ржПрж░ ржЬржирзНржп ржПржХ ржзрж░ржирзЗрж░ Third-Party filtering library, ржпрж╛
API-ржПрж░ GET param ржПрж░ ржорж╛ржзрзНржпржорзЗ рж╕рж╣ржЬрзЗ filtering ржХрж░рж╛рж░ рж╕рзБржмрж┐ржзрж╛ ржжрзЗржпрж╝ред

### тЬЕ Install:

```bash
pip install django-filter
```

### тЬЕ settings.py:

```python
INSTALLED_APPS = [
    ...
    'django_filters',
]
########################################################################
REST_FRAMEWORK = {
    'DEFAULT_FILTER_BACKENDS': [
        'django_filters.rest_framework.DjangoFilterBackend'
    ]
}
```

---

### ЁЯФ╣ 2. Filter Backend ржХрзА?

`filter_backends` ржПржХржЯрж┐ DRF attribute ржпрж╛ filtering, searching ржмрж╛ ordering ржПрж░ ржЬржирзНржп backend class
ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ ржжрзЗрзЯредfilter_backends DRF-ржПрж░ ржПржХржЯрж╛ attribute, ржпрж╛ рж╕рж╛ржзрж╛рж░ржгржд ржЖржорж░рж╛ APIView, GenericAPIView,
ListAPIView, ModelViewSet ржЗрждрзНржпрж╛ржжрж┐рж░ ржоржзрзНржпрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ред

> note:Filter Backend GenericAPIView рждржерж╛ ржнрж┐ржЙ ржПрж░ queryset ржХрзЗ ржорзЛржбрж┐ржлрж╛ржЗ ржХрж░рзЗ ржЖрж░ pagination ржнрж┐ржЙ ржПрж░ рж░рзЗрж╕ржкржирзНрж╕
> ржХрзЗ ржорзЛржбрж┐ржлрж╛ржЗ ржХрж░рзЗ ржПржЯрж╛ржЗ ржЖрж╕рж▓ ржХржерж╛ред

### тЬЕ Global Level Setup:(рж╕ржм ржХрзНрж▓рж╛рж╕ ржнрж┐ржЙ ржПрж░ ржЬржирзНржп)

```python
# settings.py
REST_FRAMEWORK = {
    'DEFAULT_FILTER_BACKENDS': [
        'django_filters.rest_framework.DjangoFilterBackend',
        'rest_framework.filters.SearchFilter',
        'rest_framework.filters.OrderingFilter',
    ]
}
```

### тЬЕ Local Level Setup (ржирж┐рж░рзНржжрж┐рж╖рзНржЯ View class ржПрж░ ржнрж┐рждрж░рзЗ):

```python
from rest_framework import generics, filters
from django_filters.rest_framework import DjangoFilterBackend

class ProductListAPIView(generics.ListAPIView):
    queryset = Product.objects.all()
    serializer_class = ProductSerializer

    filter_backends = [
        DjangoFilterBackend,
        filters.SearchFilter,
        filters.OrderingFilter
    ]
    filterset_field=["name","city"]
```

ржПржЗ attribute ржЯрж╛ accept ржХрж░рзЗ filter backend classes-ржПрж░ list, ржпрзЗржЧрзБрж▓рзЛрж░ ржкрзНрж░рждрзНржпрзЗржХржЯрж╛рж░ ржнрж┐рждрж░рзЗ ржПржХржЯрж╛ method
ржерж╛ржХрзЗ:

```python
def filter_queryset(self, request, queryset, view):
    ...
```

ЁЯФ╣ ржХрзЗ filter_backends ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ?

#### тЬЕ GenericAPIView ржПржЗ attribute ржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

### ЁЯУМ рж╕ржм ListAPIView, RetrieveAPIView, ModelViewSet ржПржЗрж╕ржм ржХрзНрж▓рж╛рж╕ GenericAPIView ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ ржХрж░рзЗред рждрж╛ржЗ filter_backends ржЖрж╕рж▓рзЗ GenericAPIView-ржПрж░ propertyред

ЁЯФ╣ ржЗржирзНржЯрж╛рж░рзНржирж╛рж▓рж┐ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

GenericAPIView ржПрж░ ржоржзрзНржпрзЗ ржПржХржЯрж╛ method ржЖржЫрзЗ:

```python

def filter_queryset(self, queryset):
    for backend in list(self.filter_backends):
        queryset = backend().filter_queryset(self.request, queryset, self)
    return queryset
```

#### тЪЩя╕П Step-by-step:

- self.filter_backends ржерзЗржХрзЗ list ржирзЗржУрзЯрж╛ рж╣рзЯ (ржпрзЗржоржи: [DjangoFilterBackend, SearchFilter])
- ржкрзНрж░рждрзНржпрзЗржХ backend class ржХрзЗ ржЗржирж┐рж╢рж┐рзЯрж╛рж▓рж╛ржЗржЬ ржХрж░рзЗ: backend()
- рждрж╛рж░ржкрж░ ржкрзНрж░рждрзНржпрзЗржХржЯрж╛рж░ filter_queryset() method ржХрж▓ ржХрж░рж╛ рж╣рзЯ:

```python
queryset = backend().filter_queryset(request, queryset, view)
```

- ржкрзНрж░рждрж┐ржмрж╛рж░рзЗ queryset modify рж╣рзЯрзЗ update рж╣рзЯред
- рж╢рзЗрж╖рзЗ final filtered queryset return рж╣рзЯред ЁЯФ╣ View-ржП ржПржЗ filter_queryset() ржХржЦржи ржХрж┐ржнрж╛ржмрзЗ ржХрж▓ рж╣рзЯ mixin ржПрж░
  ржорж╛ржжрзНржзржорзЗ ?

```python
def list(self, request, *args, **kwargs):
        queryset = self.filter_queryset(self.get_queryset())

        page = self.paginate_queryset(queryset)
        if page is not None:
            serializer = self.get_serializer(page, many=True)
            return self.get_paginated_response(serializer.data)

        serializer = self.get_serializer(queryset, many=True)
        return Response(serializer.data)

```

ЁЯФ╣ Custom filter_backend class ржмрж╛ржирж╛рждрзЗ ржЪрж╛ржЗрж▓рзЗ?

```python
from rest_framework.filters import BaseFilterBackend

class MyCustomFilterBackend(BaseFilterBackend):
    def filter_queryset(self, request, queryset, view):
        # ржХрж╛рж╕рзНржЯржо рж▓ржЬрж┐ржХ
        if request.user.is_staff:
            return queryset
        return queryset.none()
```

---

### ЁЯФ╣ 3. django_filter FilterSet ржмрзНржпржмрж╣рж╛рж░

### тЬЕ Step-by-Step:

#### Step 1: Create filters.py

```python
import django_filters
from .models import Product

class ProductFilter(django_filters.FilterSet):
    price_min = django_filters.NumberFilter(field_name='price', lookup_expr='gte')
    price_max = django_filters.NumberFilter(field_name='price', lookup_expr='lte')
    name = django_filters.CharFilter(lookup_expr='icontains')

    class Meta:
        model = Product
        fields = ['category', 'price_min', 'price_max', 'name']

```

#### Step 2: View-ржП ржпрзБржХрзНржд ржХрж░рзЛ

```python
from .filters import ProductFilter

class ProductListAPIView(generics.ListAPIView):
    queryset = Product.objects.all()
    serializer_class = ProductSerializer
    filter_backends = [DjangoFilterBackend]
    filterset_class = ProductFilter
```

---

#### ЁЯФ╣ 4. SearchFilter (Full Text Search)

`SearchFilter` allow ржХрж░рзЗ search query рждрзИрж░рж┐ ржХрж░рждрзЗ `?search=...` param ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

### тЬЕ Syntax:

```python
from rest_framework import filters

class ProductListAPIView(generics.ListAPIView):
    ...
    filter_backends = [filters.SearchFilter]
    search_fields = ['name', 'description']
```

### тЬЕ Prefix Meaning:

- `^title` тЖТ Starts with
- `=title` тЖТ Exact match
- `@title` тЖТ Full text search (only PostgreSQL)
- `$title` тЖТ Regex match

тЬЕ Example:

```python
search_fields = ['^name', '=category', '$description']
```

---

#### ЁЯФ╣ 5. OrderingFilter

API-рждрзЗ order ржХрж░рждрзЗ `?ordering=fieldname` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред

#### тЬЕ Example:

```python
class ProductListAPIView(generics.ListAPIView):
    ...
    filter_backends = [filters.OrderingFilter]
    ordering_fields = ['price', 'created_at']
    ordering = ['price']  # Default ordering
```

тЮбя╕П ?ordering=price тЮбя╕П ?ordering=-price

---

#### ЁЯФ╣ 6. ржХрзЛржиржЯрж╛ ржХржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

| Feature         | Use When                                          |
| --------------- | ------------------------------------------------- |
| django_filter   | Exact field filtering, date range, etc.           |
| SearchFilter    | Full-text search/filter                           |
| OrderingFilter  | Sorting result ascending/descending               |
| filterset_class | Complex filter logic (custom class-based filters) |

---

#### ЁЯФ╣ 7. Internally DRF ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

- View ржПрж░ `filter_backends` list ржЕржирзБржпрж╛рзЯрзА sequentially filtering apply ржХрж░рзЗ
- ржкрзНрж░рждрзНржпрзЗржХ filter class ржП `filter_queryset(self, request, queryset, view)` method ржерж╛ржХрзЗ
- ржпрзЗржЯрж╛ `request.GET` ржерзЗржХрзЗ query ржирзЗржпрж╝ ржПржмржВ `queryset` modify ржХрж░рзЗ return ржХрж░рзЗ

---

#### ЁЯФ╣ 8. рж╕ржм ржХрж┐ржЫрзБрж░ рж╕ржВржХрзНрж╖рж┐ржкрзНржд рж╕ржВржпрзЛржЧ:

```python
# filters.py
import django_filters
from .models import Product

class ProductFilter(django_filters.FilterSet):
    class Meta:
        model = Product
        fields = ['category', 'price']

# views.py
from rest_framework import generics, filters
from django_filters.rest_framework import DjangoFilterBackend
from .filters import ProductFilter

class ProductListAPIView(generics.ListAPIView):
    queryset = Product.objects.all()
    serializer_class = ProductSerializer

    filter_backends = [
        DjangoFilterBackend,
        filters.SearchFilter,
        filters.OrderingFilter
    ]
    filterset_class = ProductFilter
    filterset_field=["category","topic"]
    search_fields = ['^name', '=category']
    ordering_fields = ['price', 'created_at']
    ordering = ['price']
```

---

#### filterset_fields vs filterset_class

| ржкрж╛рж░рзНржержХрзНржп                  | filterset_fields                          | filterset_class                   |
| ------------------------- | ----------------------------------------- | --------------------------------- |
| ржХрж┐рж╕рзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ     | Simple ржлрж┐рж▓рзНржб ржнрж┐рждрзНрждрж┐ржХ filtering            | Complex/custom filtering logic    |
| ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ            | DRF ржирж┐ржЬрзЗ ржерзЗржХрзЗ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ filter рждрзИрж░рж┐ ржХрж░рзЗ | рждрзБржорж┐ ржирж┐ржЬрзЗ filter class define ржХрж░рзЛ |
| ржХрзЛржбрзЗрж░ ржЙржжрж╛рж╣рж░ржг              | `filterset_fields = ['field1', 'field2']` | `filterset_class = ProductFilter` |
| Custom logic support ржХрж░рзЗ? | тЭМ ржирж╛                                     | тЬЕ рж╣рзНржпрж╛ржБ                          |
| ржХрзЛржиржЯрж╛ ржмрзЗрж╢рж┐ flexible?      | тЭМ рж╕рзАржорж┐ржд                                  | тЬЕ ржЕржирзЗржХ ржмрзЗрж╢рж┐ flexible             |

#### ЁЯФЪ Conclusion

ржПржЗ рж╣рзНржпрж╛ржирзНржбржирзЛржЯ ржкржбрж╝рзЗ рждрзЛржорж╛рж░ ржПржЦржи ржкрзБрж░рзЛржкрзБрж░рж┐ ржХрзНрж▓рж┐ржпрж╝рж╛рж░ рж╣ржпрж╝рзЗ ржпрж╛ржУржпрж╝рж╛рж░ ржХржерж╛:

- `django-filter` ржжрж┐ржпрж╝рзЗ ржХрж╛рж╕рзНржЯржо ржлрж┐рж▓рзНржЯрж╛рж░
- `SearchFilter` ржжрж┐ржпрж╝рзЗ flexible рж╕рж╛рж░рзНржЪ
- `OrderingFilter` ржжрж┐ржпрж╝рзЗ ordering
- `filter_backends` ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ
- Prefix ( ^ @ = \$ ) ржорж╛ржирзЗ ржХрзА

рждрзЛржорж╛рж░ DRF ржкрзНрж░ржЬрзЗржХрзНржЯрзЗ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржПржЦржи рж╣ржмрзЗ ржПржХржжржо ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ рж▓рзЗржнрзЗрж▓рзЗрж░ред тЬЕ

---

## тЬЕ Day 17: Pagination

- PageNumberPagination
- LimitOffsetPagination
- Custom Pagination Class

---

### ЁЯФ╣ Pagination ржХрзЗржи ржжрж░ржХрж╛рж░?

ржпржЦржи Queryset ржмрзЬ рж╣рзЯ (рззрзжрзжрзж+ record), рждржЦржи ржкрзБрж░рзЛ dataset return ржХрж░рж▓рзЗ performance ржЦрж╛рж░рж╛ржк рж╣рзЯред рждрж╛ржЗ ржЖржорж░рж╛
**pagination** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ тАФ ржЕрж░рзНржерж╛рзО **ржПржХрж╕рж╛ржерзЗ рж╕ржм ржирж╛ ржкрж╛ржарж┐рзЯрзЗ, ржкрзНрж░рждрж┐ ржмрж╛рж░ ржХрж┐ржЫрзБ ржХрж┐ржЫрзБ ржХрж░рзЗ ржкрж╛ржарж╛ржирзЛ**ред

---

### ЁЯФ╣ Pagination DRF-ржП ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

DRF-ржПрж░ ржпрзЗржХрзЛржирзЛ `ListAPIView`, `ModelViewSet` ржмрж╛ `ListModelMixin` ржП pagination ржЕржЯрзЛржорзЗржЯрж┐ржХ ржХрж╛ржЬ ржХрж░рзЗ ржпржжрж┐
pagination class рж╕рзЗржЯ ржХрж░рж╛ ржерж╛ржХрзЗред

Pagination class-ржПрж░ ржорзВрж▓ ржХрж╛ржЬ:

- ржХрзЛржи page ржХржд item ржжрзЗржЦрж╛ржмрзЗ рждрж╛ ржирж┐рзЯржирзНрждрзНрж░ржг ржХрж░рж╛
- Response format ржарж┐ржХ ржХрж░рзЗ ржжрзЗржУрзЯрж╛

---

### ЁЯФ╣ PageNumberPagination тАФ (Simple Page Based)

#### тЬЕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ ржпржЦржи:

- рждрзБржорж┐ ржЪрж╛ржЗ pagination `?page=2` ржПрж░ ржорждржи рж╣ржмрзЗ
- Fixed item per page ржЪрж╛ржУ
- ржкрзЗржЬ ржмрж╛ржирж╛рждрзЗ ржЪрж╛ржУ ржмржЗ ржПрж░ ржорждрзЛ ржпрзЗ ржХрзЯрзЗржХржЯрж╛ рж▓рж╛ржЗржи ржорж┐рж▓рзЗ ржПржХржЯрж╛ ржкрзЗржЬ ржмрж╛ржирж╛рзЯ ржЖржмрж╛рж░ ржЖржмрж╛рж░ ржХрзЯрзЗржХржЯрж╛ ржкрзЗржЬ ржорж┐рж▓рзЗ ржПржХржЯрж╛ ржмржЗ
  ржмрж╛ржирж╛рзЯ ржПржХрзНрж╖рзЗрждрзНрж░рзЗ рж▓рж╛ржЗржи рж╣рж▓рзЛ ржоржбрзЗрж▓ ржЕржмржЬрзЗржХрзНржЯ ржЖрж░ ржмржЗ рж╣рж▓рзЛ queryset ржЖржорж░рж╛ params ржП ржмрж▓рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ ржпрзЗ ржЖржорж░рж╛ ржХрзЯ
  ржиржорзНржмрж░ ржкрзЗржЬ ржПрж░ ржбрж╛ржЯрж╛ ржирж┐рждрзЗ ржЪрж╛ржЗред

#### тЬЕ Global Setup (settings.py):

```python
REST_FRAMEWORK = {
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 10,
    "PAGE_PARMS":"p"
}
```

тЮбя╕П ржПржЦржи `/api/products/?page=2` тЖТ ржПржЗрж░ржХржо URL ржХрж╛ржЬ ржХрж░ржмрзЗ

#### тЬЕ Local Setup (View-ржП):

```python
from rest_framework.pagination import PageNumberPagination

class ProductPagination(PageNumberPagination):
    page_size = 5
    page_size_query_param = 'size'
    max_page_size = 100
    page_query_param = 'mypage'
```

```python
class ProductListAPIView(generics.ListAPIView):
    queryset = Product.objects.all()
    serializer_class = ProductSerializer
    pagination_class = ProductPagination
```

тЮбя╕П `/api/products/?mypage=3&size=20` тЖТ ржПржЗржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░ржмрзЗ

---

### ЁЯФ╣ LimitOffsetPagination тАФ (Limit & Offset(skippeditemnumber) Based)

#### тЬЕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ ржпржЦржи:

- рждрзБржорж┐ ржЪрж╛ржЗ user ржмрж▓рзЗ ржжрж┐ржмрзЗ ржХрзЯржЯрж╛ skip(offset) ржХрж░рзЗ ржХрзЯржЯрж╛ item(limit) ржирж┐ржмрзЗ
- URL рж╣ржмрзЗ `?limit=10&offset=30`

#### тЬЕ Global Setup:

```python
REST_FRAMEWORK = {
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.LimitOffsetPagination',
    'PAGE_SIZE': 10  # default limit
}
```

тЮбя╕П `/api/products/?limit=5&offset=15`

### тЬЕ Local Customization:

```python
from rest_framework.pagination import LimitOffsetPagination

class CustomLimitPagination(LimitOffsetPagination):
    default_limit = 5
    limit_query_param = 'lmt'
    offset_query_param = 'ofs'
    max_limit = 100
```

```python
class ProductListAPIView(generics.ListAPIView):
    queryset = Product.objects.all()
    serializer_class = ProductSerializer
    pagination_class = CustomLimitPagination
```

тЮбя╕П `/api/products/?lmt=10&ofs=20`

---

### ЁЯФ╣ Custom Pagination (Fully Customized Response)

#### тЬЕ Custom Class ржмрж╛ржирж╛ржирзЛрж░ ржХрж╛рж░ржи:

- рждрзБржорж┐ ржЪрж╛ржЗ JSON ржПрж░ format ржкрзБрж░рзЛржкрзБрж░рж┐ ржирж┐ржЬрзЗрж░ ржорждржи ржХрж░рзЛ
- Custom page_size, max_limit ржжрж┐рждрзЗ ржкрж╛рж░рзЛ

#### тЬЕ ржЙржжрж╛рж╣рж░ржг:

```python
from rest_framework.pagination import PageNumberPagination
from rest_framework.response import Response

class CustomPagination(PageNumberPagination):
    page_size = 5
    page_size_query_param = 'size'
    max_page_size = 50
    page_query_param = 'page'

    def get_paginated_response(self, data):
        return Response({
            'total_items': self.page.paginator.count,
            'total_pages': self.page.paginator.num_pages,
            'current_page': self.page.number,
            'next': self.get_next_link(),
            'previous': self.get_previous_link(),
            'results': data
        })
```

тЮбя╕П ржПржЦржи API response рж╣ржмрзЗ:

```json
{
  "total_items": 50,
  "total_pages": 10,
  "current_page": 2,
  "next": "http://...page=3",
  "previous": "http://...page=1",
  "results": [ ...data... ]
}
```

---

#### ЁЯФ╣ Pagination Summary Table

| Pagination Type       | Query Format          | Use When                            |
| --------------------- | --------------------- | ----------------------------------- |
| PageNumberPagination  | `?page=2`             | Simple page-based navigation        |
| LimitOffsetPagination | `?limit=10&offset=20` | More control on data range          |
| CustomPagination      | As you design         | Need custom response / page control |

---

#### ЁЯФ╣ Pagination Important Parameters

| Parameter               | ржХрж╛ржЬ ржХрзА ржХрж░рзЗ                            |
| ----------------------- | ------------------------------------- |
| `page_size`             | ржкрзНрж░рждрж┐ ржкрзЗржЬрзЗ ржХрзЯржЯрж╛ item ржерж╛ржХржмрзЗ            |
| `page_size_query_param` | client-side ржерзЗржХрзЗ page_size ржЪрзЗржЮрзНржЬ ржХрж░рждрзЗ |
| `max_page_size`         | client ржХрждрзЛ ржмрзЬ page_size ржжрж┐рждрзЗ ржкрж╛рж░ржмрзЗ    |
| `page_query_param`      | default `?page=` ржПрж░ ржирж╛ржо ржЪрзЗржЮрзНржЬ ржХрж░рждрзЗ    |
| `limit_query_param`     | default `?limit=` ржирж╛ржо ржЪрзЗржЮрзНржЬ ржХрж░рждрзЗ      |
| `offset_query_param`    | default `?offset=` ржирж╛ржо ржЪрзЗржЮрзНржЬ ржХрж░рждрзЗ     |
| `default_limit`         | initial limit ржорж╛ржи                     |

---

#### ЁЯФЪ Conclusion

ржПржЗ рж╣рзНржпрж╛ржирзНржбржирзЛржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ рждрзБржорж┐ ржПржЦржи рж╢рж┐ржЦрзЗ ржлрзЗрж▓рзЗржЫрзЛ:

- DRF Pagination ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ
- Global vs Local Pagination config
- PageNumberPagination vs LimitOffsetPagination ржПрж░ ржкрж╛рж░рзНржержХрзНржп
- Custom Pagination ржХрзАржнрж╛ржмрзЗ ржмрж╛ржирж╛рждрзЗ рж╣рзЯ
- pagination class ржПрж░ parameter ржЧрзБрж▓рзЛрж░ ржХрж╛ржЬ

---

## тЬЕ Day 18: Permissions & Authentication

### 1я╕ПтГг Permission ржХрзА?

Permission ржорж╛ржирзЗ рж╣рж▓рзЛ **ржХрзЗ ржХрзЛржи API endpoint ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ, ржХрзЗ ржкрж╛рж░ржмрзЗ ржирж╛** тАФ ржПржЗ ржирж┐рзЯржо ржирж┐рж░рзНржзрж╛рж░ржг
ржХрж░рж╛ред ржПржЯрж╛ ржорзВрж▓ржд **Authentication-ржПрж░ ржкрж░ржмрж░рзНрждрзА ржзрж╛ржк**ред

- **Authentication** тЖТ ржЗржЙржЬрж╛рж░ ржХрзЗ (Identity ржЪрзЗржХ)
- **Permission** тЖТ ржПржЗ ржЗржЙржЬрж╛рж░ ржХрзА ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ (Access Control)

---

### 2я╕ПтГг Permission ржХрзЛржерж╛рзЯ ржмрж╕рж╛ржирзЛ ржпрж╛рзЯ?

Permission ржжрзБржЗржнрж╛ржмрзЗ ржмрж╕рж╛ржирзЛ ржпрж╛рзЯ тАФ

| Scope                | ржХрзАржнрж╛ржмрзЗ ржмрж╕рж╛ржмрзЛ                                      | ржкрзНрж░ржнрж╛ржм                                           |
| -------------------- | ------------------------------------------------- | ------------------------------------------------ |
| **Global**           | `settings.py` ржП `DEFAULT_PERMISSION_CLASSES` ржжрж┐рзЯрзЗ | ржкрзБрж░рзЛ ржкрзНрж░ржЬрзЗржХрзНржЯрзЗ ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ ржУржЗ permission ржХрж╛ржЬ ржХрж░ржмрзЗ |
| **Per View / Local** | `permission_classes` attribute ржжрж┐рзЯрзЗ               | рж╢рзБржзрзБ ржУржЗ ржнрж┐ржЙ ржмрж╛ ржнрж┐ржЙрж╕рзЗржЯрзЗ ржХрж╛ржЬ ржХрж░ржмрзЗ                  |

#### **Global Example** (`settings.py`)

```python
REST_FRAMEWORK = {
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticated',
    ]
}
```

#### **Local Example** (ржнрж┐ржЙрждрзЗ)

```python
from rest_framework.permissions import IsAuthenticated

class MyView(APIView):
    permission_classes = [IsAuthenticated]
```

---

### 3я╕ПтГг DRF Built-in Permission Classes

| Permission Class                         | ржХрж╛ржЬ                                                                           | ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ                                                                                                                                                  |
| ---------------------------------------- | ----------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **AllowAny**                             | рж╕ржмрж╛ржЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ (рж▓ржЧржЗржи рж▓рж╛ржЧржмрзЗ ржирж╛)                                     | Public API, Login/Register page                                                                                                                                   |
| **IsAuthenticated**                      | рж╢рзБржзрзБ рж▓ржЧржЗржи ржХрж░рж╛ ржЗржЙржЬрж╛рж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржкрж╛ржмрзЗ                                            | Protected API ржпрзЗржоржи Dashboard                                                                                                                                      |
| **IsAdminUser**                          | рж╢рзБржзрзБ `is_staff=True` ржЗржЙржЬрж╛рж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржкрж╛ржмрзЗ                                     | Admin Panel API                                                                                                                                                   |
| **IsAuthenticatedOrReadOnly**            | рж▓ржЧржЗржи ржЗржЙржЬрж╛рж░ = рж╕ржм ржкрж╛рж░ржмрзЗ, рж▓ржЧржЗржи ржирж╛ ржХрж░рж▓рзЗ = рж╢рзБржзрзБ GET/HEAD/OPTIONS ржкрж╛рж░ржмрзЗ             | Public read + Private write API                                                                                                                                   |
| **DjangoModelPermissions**               | Django Model permission system ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЪрзЗржХ ржХрж░рзЗ                            | ржпржЦржи User permissions (add, change, delete, view) ржоржбрзЗрж▓рзЗ рж╕рзЗржЯ ржХрж░рж╛ ржЖржЫрзЗ                                                                                                |
| **DjangoModelPermissionsOrAnonReadOnly** | рж▓ржЧржЗржи ржЗржЙржЬрж╛рж░ = Model permission ржЕржирзБржпрж╛рзЯрзА ржХрж╛ржЬ ржХрж░ржмрзЗ, рж▓ржЧржЗржи ржирж╛ ржХрж░рж▓рзЗ = рж╢рзБржзрзБ read-only | Public read, private write with model perms                                                                                                                       |
| **DjangoObjectPermissions**              | Object-level permission (guardian ржмрж╛ custom) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЪрзЗржХ ржХрж░рзЗ              | Row-level security ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ ржпрзЗржоржи ржпрж╛рж░ ржкрзЛрж╕рзНржЯ рж╕рзЗ ржпрзЗржи рж╢рзБржзрзБ рж╕рзЗржЗ ржкрзЛрж╕рзНржЯржЯрж┐ retrive,update,delete ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржПржоржи permissions ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ DjangoObjectPermissions ржжрж░ржХрж╛рж░ рж╣рзЯред |

---

### 4я╕ПтГг Permission ржХрж╛ржЬрзЗрж░ Flow (Internally)

DRF ржпржЦржи **APIView / GenericAPIView** ржЪрж╛рж▓рж╛рзЯ, рждржЦржи ржПрж░ ржоржзрзНржпрзЗ ржПржЗ ржкрзНрж░рж╕рзЗрж╕ рж╣рзЯ:

1. ржнрж┐ржЙ ржХрж▓ рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗ тЖТ `APIView.dispatch()` тЖТ `self.check_permissions(request)` ржХрж▓ рж╣рзЯ
2. `check_permissions` тЖТ рж▓рзБржк ржЪрж╛рж▓рж┐рзЯрзЗ рж╕ржм `permission_classes` ржПрж░ `has_permission(request, view)` ржЪрзЗржХ
   ржХрж░рзЗ
3. ржпржжрж┐ `has_permission` **False** ржжрзЗрзЯ тЖТ `PermissionDenied` exception рждрзБрж▓рзЗ ржжрзЗрзЯ (HTTP 403)
4. ржпржжрж┐ object-level permission рж▓рж╛ржЧрзЗ (Retrieve/Update/Delete) тЖТ
   `check_object_permissions(request, obj)` ржХрж▓ рж╣рзЯ
5. `check_object_permissions` тЖТ ржкрзНрж░рждрж┐ржЯрж┐ `permission_classes` ржПрж░
   `has_object_permission(request, view, obj)` ржЪрзЗржХ ржХрж░рзЗ
6. Fail рж╣рж▓рзЗ тЖТ `PermissionDenied`

### ЁЯОп Permission ржХрж╛ржЬрзЗрж░ ржбрж╛рзЯрж╛ржЧрзНрж░рж╛ржо

```pgsql

        тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
        тФВ  Request ржЖрж╕рзЗ (APIView / GenericAPIView) тФВ
        тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
                         тЦ╝
           тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
           тФВ  dispatch() ржХрж▓ рж╣рзЯ        тФВ
           тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
                         тЦ╝
      тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
      тФВ  self.check_permissions(request)   тФВ
      тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
         тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
         тФВ  Loop ржХрж░рзЗ ржкрзНрж░рждрж┐ржЯрж┐ permission_classes ржЪрзЗржХ ржХрж░рзЗ тФВ
         тФВ  has_permission(request, view)              тФВ
         тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
       тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР              тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
       тФВ True рж╣рж▓рзЗ тЖТ   тФВ              тФВ False рж╣рж▓рзЗ тЖТ  тФВ
       тФВ ржкрж░рзЗрж░ рж╕рзНржЯрзЗржкрзЗ  тФВ              тФВ PermissionDeniedтФВ
       тФВ ржпрж╛ржмрзЗ         тФВ              тФВ (HTTP 403)    тФВ
       тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ              тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
                         тЦ╝
       тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
       тФВ  ржпржжрж┐ Object-level permission ржжрж░ржХрж╛рж░ рж╣рзЯ       тФВ
       тФВ  (Retrieve / Update / Delete ржПрж░ рж╕ржорзЯ)        тФВ
       тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
                         тЦ╝
   тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
   тФВ  self.check_object_permissions(request, obj)тФВ
   тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
         тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
         тФВ  Loop ржХрж░рзЗ ржкрзНрж░рждрж┐ржЯрж┐ permission_classes ржЪрзЗржХ ржХрж░рзЗтФВ
         тФВ  has_object_permission(request, view, obj) тФВ
         тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
       тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР              тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
       тФВ True рж╣рж▓рзЗ тЖТ   тФВ              тФВ False рж╣рж▓рзЗ тЖТ  тФВ
       тФВ ржнрж┐ржЙ ржЪрж▓ржмрзЗ    тФВ              тФВ PermissionDeniedтФВ
       тФВ (рж╕рж╛ржХрж╕рзЗрж╕)    тФВ              тФВ (HTTP 403)    тФВ
       тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ              тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
```

### ЁЯШК internally

```python
def check_permissions(self, request):
        """
        Check if the request should be permitted.
        Raises an appropriate exception if the request is not permitted.
        """
        for permission in self.get_permissions():
            if not permission.has_permission(request, self):
                self.permission_denied(
                    request,
                    message=getattr(permission, 'message', None),
                    code=getattr(permission, 'code', None)
                )
```

---

### 5я╕ПтГг Method: `has_permission()` vs `has_object_permission()`

| Method                                            | ржХржмрзЗ ржХрж▓ рж╣рзЯ                                                 | ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░        | ржХрзА return ржХрж░ржмрзЗ                      |
| ------------------------------------------------- | --------------------------------------------------------- | ------------------ | ----------------------------------- |
| `has_permission(self, request, view)`             | ржнрж┐ржЙ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕рзЗрж░ ржЖржЧрзЗ                                       | request, view      | **True** (Allow) / **False** (Deny) |
| `has_object_permission(self, request, view, obj)` | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ object ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕рзЗрж░ рж╕ржорзЯ (Retrieve/Update/Delete) | request, view, obj | True / False                        |

---

### 6я╕ПтГг Custom Permission ржмрж╛ржирж╛ржирзЛ

#### Example: рж╢рзБржзрзБ owner data ржжрзЗржЦрждрзЗ ржкрж╛рж░ржмрзЗ

```python
from rest_framework.permissions import BasePermission

class IsOwnerOnly(BasePermission):
    def has_permission(self, request, view):
        # рж╢рзБржзрзБ authenticated ржЗржЙржЬрж╛рж░ржХрзЗ allow ржХрж░ржмрзЛ
        return request.user.is_authenticated

    def has_object_permission(self, request, view, obj):
        # Object рж░ owner рж╣рж▓рзЗ allow ржХрж░ржмрзЛ ржмрж╛ ржПржХржЯрж╛ ржмрзНрж▓ржЧ /post  ржПрж░ owner ржП рж╢рзБржзрзБ retrive /delete /ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред
        return obj.owner == request.user
```

**Use in view:**

```python
class MyDetailView(RetrieveUpdateAPIView):
    permission_classes = [IsOwnerOnly]
    queryset = MyModel.objects.all()
```

---

### 7я╕ПтГг Table тАФ рж╕ржм Permission ржПрж░ Summary

| Class                                | Login ржжрж░ржХрж╛рж░? | Admin рж▓рж╛ржЧржмрзЗ? | Object level? | Public Read? |
| ------------------------------------ | ------------ | ------------ | ------------- | ------------ |
| AllowAny                             | тЭМ           | тЭМ           | тЭМ            | тЬЕ           |
| IsAuthenticated                      | тЬЕ           | тЭМ           | тЭМ            | тЭМ           |
| IsAdminUser                          | тЬЕ           | тЬЕ           | тЭМ            | тЭМ           |
| IsAuthenticatedOrReadOnly            | Optional     | тЭМ           | тЭМ            | тЬЕ           |
| DjangoModelPermissions               | тЬЕ           | тЭМ           | тЭМ            | тЭМ           |
| DjangoModelPermissionsOrAnonReadOnly | Optional     | тЭМ           | тЭМ            | тЬЕ           |
| DjangoObjectPermissions              | тЬЕ           | тЭМ           | тЬЕ            | тЭМ           |

---

### 8я╕ПтГг ржмрж╛рж╕рзНрждржмрзЗ ржХрзЛржиржЯрж╛ ржХржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

- **Public API** тЖТ `AllowAny`
- **Login ржкрзНрж░рзЯрзЛржЬржи** тЖТ `IsAuthenticated`
- **рж╢рзБржзрзБ Admin ржЗржЙржЬрж╛рж░** тЖТ `IsAdminUser`
- **Public Read + Private Write** тЖТ `IsAuthenticatedOrReadOnly`
- **Django admin perms control** тЖТ `DjangoModelPermissions`
- **Public read + model perms write** тЖТ `DjangoModelPermissionsOrAnonReadOnly`
- **Owner / Row-level control** тЖТ Custom permission + `has_object_permission`

---

### 9я╕ПтГг Shortcut ржХрзЛржб тАФ Global + Local Example

```python
# settings.py (Global)
REST_FRAMEWORK = {
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticated',
    ]
}

# views.py (Local Override)
from rest_framework.permissions import AllowAny, IsAuthenticatedOrReadOnly
from rest_framework.views import APIView

class PublicView(APIView):
    permission_classes = [AllowAny]

class MixedView(APIView):
    permission_classes = [IsAuthenticatedOrReadOnly]
```

---

### ЁЯФЯ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржХржерж╛

- **Permission рж╕ржмрж╕ржорзЯ Authentication-ржПрж░ ржкрж░рзЗ ржЪрзЗржХ рж╣рзЯ**
- **Permission fail ржХрж░рж▓рзЗ DRF 403 Forbidden рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ**
- **Custom permission ржмрж╛ржирж╛рж▓рзЗ True/False return ржХрж░рждрзЗржЗ рж╣ржмрзЗ**
- Object level permission рж╢рзБржзрзБ detail views ржП ржЪрзЗржХ рж╣рзЯ, list view-рждрзЗ ржирж╛
- ржПржХрж╛ржзрж┐ржХ permission ржжрж┐рж▓рзЗ тЖТ рж╕ржмржЧрзБрж▓рзЛ **AND condition** рж╣рзЯред

---

## тЬЕ Day 19: API Authentication (Login/Register) with TokenAuthentication

### Topic Covered:

- Custom Register API
- Custom Login API
- Django Default User Model Use
- Password Hashing & Response

---

### 1я╕ПтГг ржХрзЗржи API Authentication рж▓рж╛ржЧржмрзЗ?

**Authentication** ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ ржЗржЙржЬрж╛рж░ржХрзЗ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛ тАФ рж╕рзЗ ржХрзЗ, рж╕рзЗ рж▓ржЧржЗржи ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржкрж╛рзЯ ржХрж┐ржирж╛ред ржУрзЯрзЗржм ржЕрзНржпрж╛ржк ржмрж╛
ржорзЛржмрж╛ржЗрж▓ ржЕрзНржпрж╛ржкрзЗ ржЗржЙржЬрж╛рж░ржжрзЗрж░ржХрзЗ ржЖрж▓рж╛ржжрж╛ ржЖрж▓рж╛ржжрж╛ ржбрзЗржЯрж╛, рж╕рж╛рж░рзНржнрж┐рж╕ ржмрж╛ ржЕрзНржпрж╛ржХрж╢ржи ржжрж┐рждрзЗ ржЪрж╛ржЗрж▓рзЗ, ржЖржЧрзЗ рждрж╛ржжрзЗрж░ ржкрж░рж┐ржЪрзЯ ржирж┐рж╢рзНржЪрж┐ржд
ржХрж░рждрзЗ рж╣рзЯред **ржирж╛ ржХрж░рж▓рзЗ:** ржпрзЗржХрзЗржЙ рждрзЛржорж╛рж░ API ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрзЗржЯрж╛ ржжрзЗржЦрждрзЗ ржмрж╛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ (Security risk
тЪа)ред

---

### 2я╕ПтГг ржХрзЛржи ржоржбрзЗрж▓ ржЗржЙржЬ ржХрж░ржм?

ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ **Django ржПрж░ ржбрж┐ржлрж▓рзНржЯ User Model** ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмред
`from django.contrib.auth.models import User`

**ржХрзЗржи ржбрж┐ржлрж▓рзНржЯ ржЗржЙржЬ ржХрж░рж▓рж╛ржо?**

- Django ржЗрждрж┐ржоржзрзНржпрзЗржЗ ржПржЗ ржоржбрзЗрж▓рзЗ **username, email, password hashing system, authentication functions**
  ржжрж┐рзЯрзЗ ржжрж┐рзЯрзЗржЫрзЗред
- рж╢рзБрж░рзБрждрзЗ рж╕ржорзЯ ржмрж╛ржБржЪрзЗред
- ржкрж░рзЗ ржЪрж╛ржЗрж▓рзЗ Custom User Model-ржП ржорж╛ржЗржЧрзНрж░рзЗржЯ ржХрж░рж╛ ржпрж╛ржмрзЗред

**ржирж╛ ржХрж░рж▓рзЗ:** ржирж┐ржЬрзЗ ржирждрзБржи ржоржбрзЗрж▓ ржмрж╛ржирж┐рзЯрзЗ Password Hash, Login Functionality, Permission System рж╕ржм рж╢рзВржирзНржп
ржерзЗржХрзЗ ржмрж╛ржирж╛рждрзЗ рж╣рждрзЛред

---

### 3я╕ПтГг Password Hashing ржХрзЗржи рж▓рж╛ржЧржмрзЗ?

- Password ржХржЦржирзЛ plain text ржЖржХрж╛рж░рзЗ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж░рж╛ржЦрж╛ ржпрж╛ржмрзЗ ржирж╛ред
- Django **PBKDF2 hashing algorithm** ржжрж┐рзЯрзЗ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб рж╕рзЗржн ржХрж░рзЗред
- ржПржЗ ржХрж╛ржЬржЯрж┐ `set_password()` method ржирж┐ржЬрзЗ ржХрж░рзЗ ржжрзЗрзЯред

**ржирж╛ ржХрж░рж▓рзЗ:** ржбрж╛ржЯрж╛ржмрзЗржЬ рж╣рзНржпрж╛ржХ рж╣рж▓рзЗ ржЗржЙржЬрж╛рж░рзЗрж░ ржЖрж╕рж▓ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржлрж╛ржБрж╕ рж╣рзЯрзЗ ржпрж╛ржмрзЗред

---

### 4я╕ПтГг Register API ржмрж╛ржирж╛ржирзЛрж░ ржзрж╛ржк

### (a) Serializer рждрзИрж░рж┐ ржХрж░рж╛

```python
from rest_framework import serializers
from django.contrib.auth.models import User

class RegisterSerializer(serializers.ModelSerializer):
    password = serializers.CharField(write_only=True)  # рж╢рзБржзрзБ ржЗржиржкрзБржЯ ржирж┐ржмрзЗ, ржЖржЙржЯржкрзБржЯ ржжрж┐ржмрзЗ ржирж╛

    class Meta:
        model = User
        fields = ['username', 'email', 'password']

    def create(self, validated_data):
        # ржПржЦрж╛ржирзЗ set_password ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ password hash ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ
        user = User(
            username=validated_data['username'],
            email=validated_data['email']
        )
        user.set_password(validated_data['password'])  # Password Hash
        user.save()
        return user
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- Serializer ржбрзЗржЯрж╛ ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рзЗ ржУ User object рждрзИрж░рж┐ ржХрж░рзЗред
- `set_password()` ржирж╛ ржжрж┐рж▓рзЗ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб plain text ржЖржХрж╛рж░рзЗ рж╕рзЗржн рж╣ржд (Huge security risk)ред

#### 1я╕ПтГг create() ржорзЗржержбрзЗрж░ ржХрж╛ржЬ

рждрзБржорж┐ ржпрзЗрж╣рзЗрждрзБ ModelSerializer ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржЫрзЛ, ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ serializer.save() ржХрж▓ ржХрж░рж▓рзЗ DRF рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ
ржоржбрзЗрж▓рзЗрж░ instance рждрзИрж░рж┐ ржХрж░рзЗ (ржмрж╛ ржЖржкржбрзЗржЯ ржХрж░рзЗ)ред

- ржХрж┐ржирзНрждрзБ ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ password рж╣рзНржпрж╛рж╢ ржХрж░рзЗ рж╕рзЗржн ржХрж░рждрзЗ ржЪрж╛ржЗ, plain-text ржЖржХрж╛рж░рзЗ ржирж╛ред

- ржПржЬржирзНржп create() ржорзЗржержб override ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

- ржпржЦржи рждрзБржорж┐ serializer.save() ржХрж░ржмрзЗ, рждржЦржи DRF ржнрзЗрждрж░рзЗ ржнрзЗрждрж░рзЗ

- ржкрзНрж░ржержорзЗ serializer.is_valid() ржЪрж╛рж▓рж╛ржмрзЗ тЖТ ржбрзЗржЯрж╛ ржнрзНржпрж╛рж▓рж┐ржб ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░ржмрзЗ

- рждрж╛рж░ржкрж░ create(validated_data) ржорзЗржержб ржХрж▓ ржХрж░ржмрзЗ (ржпржжрж┐ ржПржЯрж╛ ржирждрзБржи object рж╣рзЯ, update рж╣рж▓рзЗ update() ржорзЗржержб ржХрж▓ рж╣рзЯ)

- рждрзБржорж┐ ржПржЦрж╛ржирзЗ custom ржнрж╛ржмрзЗ user рждрзИрж░рж┐ ржХрж░ржЫрзЛ ржЖрж░ set_password() ржжрж┐рзЯрзЗ рж╣рзНржпрж╛рж╢ ржХрж░ржЫрзЛред

### ЁЯОпрзк ржХржЦржи ржЯрзНрж░рж┐ржЧрж╛рж░ рж╣ржмрзЗ?

- рждрзБржорж┐ POST API ржХрж▓ ржХрж░рж▓рзЗ тЖТ serializer data ржкрж╛ржмрзЗ

- serializer.is_valid() тЖТ ржбрзЗржЯрж╛ ржЪрзЗржХ ржХрж░ржмрзЗ

- serializer.save() ржХрж▓ ржХрж░рж▓рзЗ serializer() ржП data kwarg ржкрж╛рж╕ ржХрж░рж▓рзЗ тЖТ create() ржорзЗржержб ржЯрзНрж░рж┐ржЧрж╛рж░ рж╣ржмрзЗ

- ржирждрзБржи instance тЖТ create() ржорзЗржержб ржХрж▓

- ржкрзБрж░рж╛рждржи instance ржЖржкржбрзЗржЯ serializer() ржП data ржПржирзНржб instance kwarg ржкрж╛рж╕ ржХрж░рж▓рзЗ тЖТ update() ржорзЗржержб ржХрж▓

## ржЕрж░рзНржерж╛рзО serializerobject.save() рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирзЗрзЯ ржХрзЛржи ржорзЗржержб ржХрж▓ ржХрж░рждрзЗ рж╣ржмрзЗред

### (b) View рждрзИрж░рж┐ ржХрж░рж╛

```python
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from .serializers import RegisterSerializer

class RegisterView(APIView):
    def post(self, request):
        serializer = RegisterSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response({"message": "User registered successfully"}, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- `APIView` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рж╛ржо ржпрзЗржи ржХрж╛рж╕рзНржЯржо рж▓ржЬрж┐ржХ рж▓рзЗржЦрж╛ ржпрж╛рзЯред
- POST request ржПрж░ ржорж╛ржзрзНржпржорзЗ ржирждрзБржи ржЗржЙржЬрж╛рж░ рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░ ржХрж░рж╛рждрзЗред
- Error рж╣рж▓рзЗ 400, рж╕ржлрж▓ рж╣рж▓рзЗ 201 рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛ рж╣рж▓рзЛред

---

## 5я╕ПтГг Login API ржмрж╛ржирж╛ржирзЛрж░ ржзрж╛ржк

### (a) Serializer рждрзИрж░рж┐ ржХрж░рж╛

```python
from django.contrib.auth import authenticate

class LoginSerializer(serializers.Serializer):
    username = serializers.CharField()
    password = serializers.CharField()

    def validate(self, data):
        user = authenticate(username=data['username'], password=data['password'])
        if not user:
            raise serializers.ValidationError("Invalid credentials")
        data['user'] = user
        return data
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- `authenticate()` Django ржПрж░ ржмрж┐рж▓рзНржЯ-ржЗржи ржорзЗржержб ржпрж╛ ржЗржЙржЬрж╛рж░рзЗрж░ username & password ржорж┐рж▓рж┐рзЯрзЗ ржжрзЗржЦрзЗред
- рж╕ржарж┐ржХ рж╣рж▓рзЗ User object ржжрзЗрзЯ, ржирж╛рж╣рж▓рзЗ None ржжрзЗрзЯред
- Error ржорзЗрж╕рзЗржЬ ржжрж┐рж▓рзЗ рж╣рзНржпрж╛ржХрж╛рж░ржХрзЗ hint ржирж╛ ржжрзЗржУрзЯрж╛рж░ ржЬржирзНржп "Invalid credentials" generic message ржмрзНржпржмрж╣рж╛рж░
  ржХрж░рж▓рж╛ржоред

---

### (b) View рждрзИрж░рж┐ ржХрж░рж╛

```python
from rest_framework.authtoken.models import Token

class LoginView(APIView):
    def post(self, request):
        serializer = LoginSerializer(data=request.data)
        if serializer.is_valid():
            user = serializer.validated_data['user']  # validated_data ~ cleaned_data ржпрзЗрж╣рзЗрждрзБ ржПржЦрж╛ржирзЗ ржоржбрзЗрж▓ ржПрж░ рж╕рж╛ржерзЗ related ржирж╛ рждрж╛ржЗ рж╕рзЗржн ржорзЗржержб ржХрж▓ рж╣ржмрзЗ ржирж╛ рждрж╛ржЗ serializer.data ржУ ржкрж╛ржУрзЯрж╛ ржпрж╛ржмрзЗ ржирж╛ рждрж╛ржЗ serialize.validate_data ржЙрж╕рзЗ ржХрж░рж╛ рж╣ржЗрж╕рзЗ
            token, created = Token.objects.get_or_create(user=user)
            return Response({"token": token.key}, status=status.HTTP_200_OK)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- Token-based authentication ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржЫрж┐ (DRF ржПрж░ default `TokenAuthentication`)ред
- Token ржЗржЙржЬрж╛рж░рзЗрж░ ржЬржирзНржп unique key, ржпрж╛ ржкрж░рзЗ ржкрзНрж░рждрж┐ржЯрж┐ request ржПрж░ рж╕рж╛ржерзЗ header-ржП ржкрж╛ржарж╛ржирзЛ рж╣рзЯред
- `get_or_create` ржжрж┐рж▓рж╛ржо ржпрж╛рждрзЗ ржПржХ ржЗржЙржЬрж╛рж░рзЗрж░ ржЬржирзНржп ржПржХржмрж╛рж░ржЗ ржЯрзЛржХрзЗржи рждрзИрж░рж┐ рж╣рзЯред get_or_create() ржорзЗржержб ржХрзА ржХрж░рзЗ ржПржмржВ
  ржПржЦрж╛ржирзЗ token, created ржП ржХрзА рж╣ржЪрзНржЫрзЗ Token.objects.get_or_create(user=user) рж╣ржЪрзНржЫрзЗ Django ORM ржПрж░ Model
  Manager ржПрж░ ржПржХржЯрж╛ shortcut methodред ржПржЯрж╛ ржжрзБржЗржЯрж╛ ржХрж╛ржЬ ржХрж░рзЗ:

```pgsql

ржкрзНрж░ржержорзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЦрзЛржБржЬрзЗ

Token ржЯрзЗржмрж┐рж▓рзЗ user=user ржорж┐рж▓рзЗ ржПржоржи рж░рзЗржХрж░рзНржб ржЦрзБржБржЬрзЗред

ржкрж╛ржУрзЯрж╛ ржЧрзЗрж▓рзЗ:

рж╕рзЗржЗ ржЕржмржЬрзЗржХрзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржмрзЗред

created рж╣ржмрзЗ False

ржирж╛ ржкрж╛ржУрзЯрж╛ ржЧрзЗрж▓рзЗ:

ржирждрзБржи ржХрж░рзЗ рж░рзЗржХрж░рзНржб рждрзИрж░рж┐ ржХрж░ржмрзЗред

рж╕рзЗржЗ ржЕржмржЬрзЗржХрзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржмрзЗред

created рж╣ржмрзЗ True
ржЕрж░рзНржерж╛рзО ржПржЗ ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржорзЗржержб ржПржХржЯрж╛ tuple рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ ржпрж╛рж░ (tokenobject,iscreatedtoken?)

рж░рж┐ржЯрж╛рж░рзНржи ржнрзНржпрж╛рж▓рзБ:

token тЖТ Token model ржПрж░ instance (ржорж╛ржирзЗ ржЯрзЗржмрж┐рж▓рзЗрж░ row object)

created тЖТ Boolean, ржирждрзБржи рждрзИрж░рж┐ рж╣рж▓рзЗ True, ржкрзБрж░рж╛рждржи ржкрж╛ржУрзЯрж╛ ржЧрзЗрж▓рзЗ False

рждрзЛржорж╛рж░ ржХрзЛржбрзЗ:
token, created = Token.objects.get_or_create(user=user)
ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ:

ржпржжрж┐ user ржПрж░ ржЬржирзНржп ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржЯрзЛржХрзЗржи ржерж╛ржХрзЗ тЖТ token рж╣ржмрзЗ рж╕рзЗржЗ ржЯрзЛржХрзЗржи ржЕржмржЬрзЗржХрзНржЯ, created=False

ржпржжрж┐ ржирж╛ ржерж╛ржХрзЗ тЖТ ржирждрзБржи ржЯрзЛржХрзЗржи рждрзИрж░рж┐ рж╣ржмрзЗ, created=True

```

**ржирж╛ ржХрж░рж▓рзЗ:** ржкрзНрж░рждрж┐ржмрж╛рж░ рж▓ржЧржЗржи ржХрж░рж▓рзЗ ржирждрзБржи ржЯрзЛржХрзЗржи рждрзИрж░рж┐ рж╣рзЯрзЗ ржкрзБрж░рж╛ржирзЛ ржЯрзЛржХрзЗржи ржЕржмрзИржз рж╣рзЯрзЗ ржпрзЗрждред

#### ЁЯШК serializer.data vs serializer.validate_data

| ржмрж┐рж╖рзЯ                | `.validated_data`                       | `.data`                                             |
| ------------------- | --------------------------------------- | --------------------------------------------------- |
| ржХржмрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛ржмрзЗ?     | ржХрзЗржмрж▓ `is_valid()` ржПрж░ ржкрж░рзЗ                | рж╕рж╛ржзрж╛рж░ржгржд `save()` ржмрж╛ ржпрзЗржХрзЛржирзЛ serializer instance ржерзЗржХрзЗ |
| ржбрзЗржЯрж╛ ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖрж╕рзЗ? | ржЗржЙржЬрж╛рж░рзЗрж░ ржЗржиржкрзБржЯ тЖТ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржкрж╛рж╕ ржХрж░рж╛ ржбрзЗржЯрж╛ | ржоржбрзЗрж▓ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ ржмрж╛ ржбрж┐ржХрж╢ржирж╛рж░рж┐ тЖТ serialize рж╣ржУрзЯрж╛ ржбрзЗржЯрж╛  |
| ржлрж░ржорзНржпрж╛ржЯ             | Python-native dict/list                 | JSON-compatible dict/list                           |
| ржХрзЛржерж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ?   | ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж╕рзЗржн ржХрж░рж╛рж░ ржЖржЧрзЗ ржкрзНрж░рж╕рзЗрж╕рж┐ржВ          | API рж░рзЗрж╕ржкржирзНрж╕рзЗ ржкрж╛ржарж╛ржирзЛрж░ ржЬржирзНржп                           |

---

### 6я╕ПтГг URL Configuration

```python
from django.urls import path
from .views import RegisterView, LoginView

urlpatterns = [
    path('register/', RegisterView.as_view(), name='register'),
    path('login/', LoginView.as_view(), name='login'),
]
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- ржкрзНрж░рждрж┐ржЯрж┐ API endpoint ржПрж░ ржЬржирзНржп URL mappingред
- рж╕рзНржкрж╖рзНржЯ ржирж╛ржо ржжрзЗржУрзЯрж╛ ржнрж╛рж▓рзЛ (`name='login'`) ржпрзЗржи reverse URL ржХрж░рж╛ ржпрж╛рзЯред

---

### 7я╕ПтГг Settings Update

```python
INSTALLED_APPS = [
    ...
    'rest_framework',
    'rest_framework.authtoken',
]
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- Token Authentication ржХрж╛ржЬ ржХрж░рж╛рждрзЗ `'rest_framework.authtoken'` ржпрзЛржЧ ржХрж░рждрзЗ рж╣ржмрзЗред
- ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржЪрж╛рж▓рж╛рждрзЗ рж╣ржмрзЗ: `python manage.py migrate`

---

### 8я╕ПтГг API Test Example (Postman)

**Register Request**

```
POST /register/
{
    "username": "mostakin",
    "email": "mostakin@example.com",
    "password": "1234"
}
```

**Login Request**

```
POST /login/
{
    "username": "mostakin",
    "password": "1234"
}
```

**Response:**

```json
{
  "token": "e52ad8f945cf..."
}
```

---

### DRF ржХрзНрж▓рж╛рж╕ base ржнрж┐ржЙ ржЕржерзЗржиржЯрж┐ржХрзЗрж╢ржи ржкрзНрж░рж╕рзЗрж╕ ржбрж╛рзЯрж╛ржЧрзНрж░рж╛ржо

```pgsql
Incoming HTTP Request
        |
        v
[URL Resolver]
    тЖТ ржХрзЛржи View class ржПрж░ рж╕рж╛ржерзЗ ржорзНржпрж╛ржЪ ржХрж░ржмрзЗ рж╕рзЗржЯрж╛ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзЗ
        |
        v
ViewClass.as_view()
    тЖТ View instance рждрзИрж░рж┐ ржХрж░рзЗ
    тЖТ ржарж┐ржХ __call__() dunder ржорзЗржержбрзЗрж░ ржорждрзЛ behave ржХрж░рзЗ
    тЖТ View class ржХрзЗ callable function ржП ржХржиржнрж╛рж░рзНржЯ ржХрж░рзЗ
    тЖТ dispatch() method ржХрзЗ return ржХрж░рзЗ
        |
        v
dispatch(request, *args, **kwargs)   <-- ржПржЦрж╛ржирзЗ ржврзЛржХрзЗ
        |
        |-- DRF: perform_authentication()
        |       тЖТ request.user ржПржмржВ request.auth рж╕рзЗржЯ ржХрж░рзЗ
        |
        |-- DRF: check_permissions()
        |       тЖТ Permission denied рж╣рж▓рзЗ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ Response ржлрзЗрж░ржд ржжрзЗрзЯ
        |
        |-- DRF: check_throttles()
        |       тЖТ API call rate limit enforce ржХрж░рзЗ
        |
        |-- HTTP Method ржЕржирзБржпрж╛рзЯрзА рж╕ржарж┐ржХ ржорзЗржержб ржХрж▓
        |       тЖТ GET рж╣рж▓рзЗ get()
        |       тЖТ POST рж╣рж▓рзЗ post()
        |       тЖТ ржЗрждрзНржпрж╛ржжрж┐...
        |
        v
Response Object рждрзИрж░рж┐ тЖТ Middleware (response phase) тЖТ Client ржП ржкрж╛ржарж╛ржирзЛ



```

- as_view() тЖТ ржЧрзЗржЯ ржЦрзЛрж▓рзЗ (class ржХрзЗ callable ржмрж╛ржирж╛рзЯ)
- dispatch() тЖТ ржЯрзНрж░рж╛ржлрж┐ржХ ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░ (method ржарж┐ржХ ржХрж░рзЗ ржжрзЗрзЯ, DRF ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ authentication/permission ржЖржЧрзЗ
  ржЪрзЗржХ рж╣рзЯ)
- dispatch() ржЕржирзЗржХржЯрж╛ middleware ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ ржХрзНрж▓рж╛рж╕ base view ржПред

### 9я╕ПтГг ржХрзАржнрж╛ржмрзЗ Token ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржкрзНрж░ржЯрзЗржХрзНржЯрзЗржб API ржХрж▓ ржХрж░ржм?

**Header:**

```
Authorization: Token e52ad8f945cf...
```

**ржХрзЗржи ржХрж░рж▓рж╛ржо?**

- API ржирж┐рж░рж╛ржкржж рж░рж╛ржЦрждрзЗ ржкрзНрж░рждрж┐ржЯрж┐ request ржПрж░ рж╕рж╛ржерзЗ ржЯрзЛржХрзЗржи ржкрж╛ржарж╛рждрзЗ рж╣ржмрзЗред
- Backend token ржжрзЗржЦрзЗ ржЗржЙржЬрж╛рж░ржХрзЗ ржЪрж┐ржиржмрзЗред

---

### ЁЯФЯ рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк

- **Register API** тЖТ User рждрзИрж░рж┐ + Password Hash
- **Login API** тЖТ Credential ржпрж╛ржЪрж╛ржЗ + Token рждрзИрж░рж┐
- **TokenAuthentication** тЖТ ржкрзНрж░рждрж┐ржЯрж┐ request ржП user verify
- **Django Default User Model** тЖТ Time-saving + built-in security
- **Password Hashing** тЖТ Plain text ржкрж╛рж╕ржУрзЯрж╛рж░рзНржбрзЗрж░ ржЭрзБржБржХрж┐ ржХржорж╛ржирзЛ

---

тЬЕ **Key Point:** ржПржЗ рж╕рж┐рж╕рзНржЯрзЗржо ржмрж╛ржирж╛ржирзЛрж░ рж╕ржорзЯ **Security** рж╕ржмрж╕ржорзЯ ржорж╛ржерж╛рзЯ рж░рж╛ржЦрждрзЗ рж╣ржмрзЗ тАФ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб hash ржХрж░рждрзЗ
рж╣ржмрзЗ, ржЯрзЛржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗ, error ржорзЗрж╕рзЗржЬрзЗ ржмрзЗрж╢рж┐ рждржерзНржп ржирж╛ ржжрж┐рждрзЗ рж╣ржмрзЗред

---

## тЬЕ Day 20: JWT Authentication

### 0я╕ПтГг JWT ржХрзЗржи рж▓рж╛ржЧржмрзЗ?

- **BasicAuthentication** тЖТ ржкрзНрж░рждрж┐ржмрж╛рж░ Request ржП ржЗржЙржЬрж╛рж░ржирзЗржо+ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржкрж╛ржарж╛рждрзЗ рж╣рзЯ (Insecure & Slow)
- **SessionAuthentication** тЖТ рж╢рзБржзрзБ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржХрж╛ржЬ ржХрж░рзЗ (Server memory ржзрж░рзЗ рж░рж╛ржЦрзЗ, scalable ржирж╛)
- **TokenAuthentication** тЖТ Server-side database ржП token рж╕ржВрж░ржХрзНрж╖ржг рж╣рзЯ (ржкрзНрж░рждрж┐ржЯрж┐ user ржПрж░ ржЬржирзНржп token
  table ржП ржерж╛ржХрзЗ) ржкрзНрж░рждрж┐ржмрж╛рж░ DB hit рж╣рзЯ тЖТ ржХрж┐ржЫрзБржЯрж╛ slow Token leak рж╣рж▓рзЗ ржпрждржХрзНрж╖ржг ржирж╛ server-side ржерзЗржХрзЗ revoke
  ржХрж░рж╛ рж╣рзЯ, рждрждржХрзНрж╖ржг valid ржерж╛ржХрзЗ
- **JWT (JSON Web Token)** тЖТ Stateless, Mobile + SPA (React, Vue, Angular) ржП Perfect, Server ржП рж╕рзЗрж╢ржи
  рж░рж╛ржЦрждрзЗ рж╣рзЯ ржирж╛, ржПржХржмрж╛рж░ Login ржХрж░рж▓рзЗ Access Token ржжрж┐рзЯрзЗ ржХрж╛ржЬ ржЪрж▓рзЗредdb create рж╣рзЯ ржирж╛ рждрж╛ржЗ DB query рж▓рж╛ржЧрзЗ ржирж╛
  (token verify server-side secret key ржжрж┐рзЯрзЗржЗ рж╣рзЯ)

> рждрж╛ржЗ **JWT Authentication** ржкрзНрж░ржЬрзЗржХрзНржЯрзЗ рж▓рж╛ржЧржмрзЗ ржпржЦржи API ржХрзЗ Mobile App ржмрж╛ SPA ржП ржЗржЙржЬ ржХрж░ржмрзЛ ржЖрж░ Server ржП
> рж╕рзЗрж╢ржи ржорзЗржЗржиржЯрзЗржЗржи ржХрж░рждрзЗ ржЪрж╛ржЗ ржирж╛ред

## `note` _ржпрзЗ ржХрзЛржи ржЕржерзЗржиржЯрж┐ржХрзЗрж╢ржи ржПрж░ ржХрж╛ржЬ рж╣рж▓рзЛ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржП ржерж╛ржХрж╛ рж╣рзЗржбрж╛рж░ ржжрзЗржЦрзЗ рждрж╛рж░ ржорждрзЛ ржХрж░рзЗ рждрж╛рж░ ржХрж╛ржЩрзНржХрж┐ржд рж╣рзЗржбрж╛рж░ ржжрж┐рзЯрж╛ ржЗржЙрж╕рж╛рж░ detect ржХрж░рж╛ ржПрж░ржкрж░ рж╕рзЗржЗ ржЗржЙрж╕рж╛рж░ instance request.user ржП рж╕рзЗржЯ ржХрж░рж╛_

### 1я╕ПтГг JWT ржПрж░ ржорзВрж▓ ржзрж╛рж░ржгрж╛

JWT = **Header.Payload.Signature** (ржбржЯ ржжрж┐рзЯрзЗ ржЖрж▓рж╛ржжрж╛)

- **Header** тЖТ Algorithm + Token type (ржпрзЗржоржи HS256, JWT)
- **Payload** тЖТ Data (ржпрзЗржоржи user id, email, expiry time)
- **Signature** тЖТ Verify ржХрж░рзЗ ржбрж╛ржЯрж╛ ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯржирж┐ ржХрж┐ржирж╛

---

### 2я╕ПтГг SimpleJWT ржЗржирж╕рзНржЯрж▓ ржУ ржХржиржлрж┐ржЧ

**Step 1: Install**

```bash
pip install djangorestframework-simplejwt
```

ЁЯФ╣ ржХрзЗржи? тАФ Django REST Framework ржП JWT рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржжрж░ржХрж╛рж░ред

---

**Step 2: settings.py ржП ржХржиржлрж┐ржЧ**

```python
INSTALLED_APPS = [
    'rest_framework',
    'rest_framework_simplejwt.token_blacklist',  # Token blacklist support
]

REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    )
}
```

ЁЯФ╣ ржХрзЗржи? тАФ `DEFAULT_AUTHENTICATION_CLASSES` ржП JWT рж╕рзЗржЯ ржХрж░рж▓рзЗ DRF ржмрзБржЭржмрзЗ ржпрзЗ API рждрзЗ JWT Auth ржмрзНржпржмрж╣рж╛рж░
рж╣ржЪрзНржЫрзЗред ЁЯФ╣ ржирж╛ ржХрж░рж▓рзЗ? тАФ DRF ржбрж┐ржлрж▓рзНржЯ рж╣рж┐рж╕рзЗржмрзЗ SessionAuth ржмрж╛ BasicAuth ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

---

**Step 3: urls.py ржП JWT ржПрж░ URL ржпрзЛржЧ ржХрж░рж╛**

```python
from django.urls import path
from rest_framework_simplejwt.views import (
    TokenObtainPairView,  # Access + Refresh token рждрзИрж░рж┐
    TokenRefreshView,     # Refresh token ржжрж┐рзЯрзЗ ржирждрзБржи Access token
    TokenBlacklistView,   # Token blacklist (logout)
)

urlpatterns = [
    path('api/token/', TokenObtainPairView.as_view(), name='token_obtain_pair'),
    path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
    path('api/token/blacklist/', TokenBlacklistView.as_view(), name='token_blacklist'),
]
```

ЁЯФ╣ ржХрзЗржи? тАФ ржЗржЙржЬрж╛рж░ржХрзЗ рж▓ржЧржЗржи ржХрж░рж╛рждрзЗ, рж░рж┐ржлрзНрж░рзЗрж╢ ржХрж░рж╛рждрзЗ, ржЖрж░ рж▓ржЧржЖржЙржЯ ржХрж░рждрзЗ ржПржЗ рзйржЯрж╛ ржПржирзНржбржкрзЯрзЗржирзНржЯ рж▓рж╛ржЧржмрзЗред

---

**Step 4: Access & Refresh Token ржмрзНржпрж╛ржЦрзНржпрж╛**

- **Access Token** тЖТ ржЕрж▓рзНржк рж╕ржорзЯрзЗрж░ ржЬржирзНржп Valid (ржпрзЗржоржи 5 ржорж┐ржирж┐ржЯ) тЖТ API рждрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ
- **Refresh Token** тЖТ ржмрзЬ рж╕ржорзЯрзЗрж░ ржЬржирзНржп Valid (ржпрзЗржоржи 1 ржжрж┐ржи) тЖТ ржирждрзБржи Access Token ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рждрзЗ рж▓рж╛ржЧрзЗ
- **Blacklist** тЖТ рж▓ржЧржЖржЙржЯ ржХрж░рж▓рзЗ Refresh Token ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рзЗ ржжрзЗрзЯ, ржпрж╛рждрзЗ ржнржмрж┐рж╖рзНржпрждрзЗ ржХрзЗржЙ ржЗржЙржЬ ржирж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗред
  secuerity рж╕рзНржЯрзНрж░ржВ ржХрж░рж╛рж░ ржЬржирзНржпред

---

**Step 5: ржЯрзЛржХрзЗржи рждрзИрж░рж┐ (Login)** POST тЖТ `/api/token/`

```json
{
  "username": "mostakin",
  "password": "1234"
}
```

Response:

```json
{
  "access": "eyJ0eXAiOiJKV1QiLCJhbGciOiJI...",
  "refresh": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

ЁЯФ╣ ржХрзЗржи? тАФ Access token API request ржП ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм, Refresh token ржирждрзБржи Access token ржкрж╛ржУрзЯрж╛рж░ ржЬржирзНржпред

---

**Step 6: API ржП JWT Token ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛** Request Header ржП:

```
Authorization: Bearer <access_token>
```

ЁЯФ╣ ржирж╛ ржжрж┐рж▓рзЗ? тАФ API ржмрж▓ржмрзЗ `"Authentication credentials were not provided."`

---

**Step 7: Refresh Token ржмрзНржпржмрж╣рж╛рж░** POST тЖТ `/api/token/refresh/`

```json
{
  "refresh": "<refresh_token>"
}
```

Response:

```json
{
  "access": "<new_access_token>"
}
```

---

**Step 8: Logout (Blacklist)** POST тЖТ `/api/token/blacklist/`

```json
{
  "refresh": "<refresh_token>"
}
```

ЁЯФ╣ ржХрзЗржи? тАФ Logout ржХрж░рж▓рзЗ ржЯрзЛржХрзЗржи ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ, ржирж╛ ржХрж░рж▓рзЗ ржкрзБрж░ржирзЛ ржЯрзЛржХрзЗржи ржПржЦржирзЛ ржХрж╛ржЬ ржХрж░ржмрзЗредржпрзЗржЗ ржЯрзЛржХрзЗржи ржПрж░
ржорж╛ржжрзНржзржорзЗ ржЗржЙрж╕рж╛рж░ ржХрзЛрзЯрзЗрж░рж┐ ржЪрж╛рж▓рж╛ржЪрзНржЫрж┐рж▓ ржПржмржВ logout ржХрж░рж▓рзЛ рж╕рзЗржЗ ржЯрзЛржХрзЗржи ржПржЦржирзЛ ржХрж╛ржЬ ржХрж░ржмрзЗредржпрждржХрзНрж╖ржг ржирж╛ expire рж╣ржЪрзНржЪрзЗ ржЯрзЛржХрзЗржиред

---

### 3я╕ПтГг BasicAuthentication vs SessionAuthentication vs JWTAuthentication

| Feature      | BasicAuth                         | SessionAuth                     | JWTAuth                           |
| ------------ | --------------------------------- | ------------------------------- | --------------------------------- |
| Login Method | Username+Password ржкрзНрж░рждрж┐ржмрж╛рж░ ржкрж╛ржарж╛ржирзЛ | ржПржХржмрж╛рж░ Login тЖТ Session ID Cookie | ржПржХржмрж╛рж░ Login тЖТ JWT Token           |
| Storage      | No storage (Stateless)            | Server memory                   | Client-side (localStorage/cookie) |
| Best for     | Quick API test                    | Web apps (Django Template)      | SPA / Mobile apps                 |
| Drawback     | ржкрзНрж░рждрж┐ржмрж╛рж░ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржкрж╛ржарж╛ржирзЛ рж▓рж╛ржЧрзЗ    | Server load ржмрзЗрж╢рж┐                | ржЯрзЛржХрзЗржи expire рж╣рж▓рзЗ refresh ржХрж░рждрзЗ рж╣рзЯ  |

---

### ЁЯФН TokenAuthentication vs JWT Authentication

| ржмрж┐рж╖рзЯ              | TokenAuthentication                                                               | JWT Authentication                                                                    |
| ----------------- | --------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- |
| **Token storage** | Server-side database ржП token рж╕ржВрж░ржХрзНрж╖ржг рж╣рзЯ (ржкрзНрж░рждрж┐ржЯрж┐ user ржПрж░ ржЬржирзНржп token table ржП ржерж╛ржХрзЗ) | Server ржХрзЛржирзЛ token store ржХрж░рзЗ ржирж╛ (Stateless) тАФ token ржПрж░ ржнрзЗрждрж░рзЗржЗ рж╕ржм рждржерзНржп ржерж╛ржХрзЗ             |
| **Scalability**   | ржХржо scalable, ржХрж╛рж░ржг ржкрзНрж░рждрж┐ржмрж╛рж░ request ржП server ржХрзЗ DB ржЪрзЗржХ ржХрж░рждрзЗ рж╣рзЯ                     | Highly scalable, ржХрж╛рж░ржг DB query рж▓рж╛ржЧрзЗ ржирж╛ (token verify server-side secret key ржжрж┐рзЯрзЗржЗ рж╣рзЯ) |
| **Logout**        | Server ржерзЗржХрзЗ token delete ржХрж░рж▓рзЗ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗржЗ logout ржХрж░рж╛ ржпрж╛рзЯ                           | Logout ржХрж░рж╛рж░ ржЬржирзНржп token blacklist system рж▓рж╛ржЧржмрзЗ (ржиржЗрж▓рзЗ expiry ржкрж░рзНржпржирзНржд valid ржерж╛ржХржмрзЗ)       |
| **Security**      | Token leak рж╣рж▓рзЗ ржпрждржХрзНрж╖ржг ржирж╛ server-side ржерзЗржХрзЗ revoke ржХрж░рж╛ рж╣рзЯ, рждрждржХрзНрж╖ржг valid ржерж╛ржХрзЗ        | Token leak рж╣рж▓рзЗ expiry ржкрж░рзНржпржирзНржд valid тАФ рждржмрзЗ expiry ржЫрзЛржЯ ржХрж░рзЗ рж░рж╛ржЦрж╛ ржпрж╛рзЯ                     |
| **Performance**   | ржкрзНрж░рждрж┐ржмрж╛рж░ DB hit рж╣рзЯ тЖТ ржХрж┐ржЫрзБржЯрж╛ slow                                                  | DB hit рж▓рж╛ржЧрзЗ ржирж╛ тЖТ faster                                                               |
| **Use case**      | ржЫрзЛржЯ project, ржХржо API call, server ржПрж░ рж╕рж╛ржерзЗ рж╕ржмрж╕ржорзЯ connection ржЖржЫрзЗ                     | Large scale API, Mobile App, SPA (React, Vue, Angular)                                |

### 4я╕ПтГг Authentication Flow Diagram

#### ЁЯФ╣ BasicAuthentication Flow

```
Client тЖТ [username+password] тЖТ Server тЖТ Verify user тЖТ Response
```

(ржкрзНрж░рждрж┐ржмрж╛рж░ request ржП username+password ржпрж╛рзЯ)

---

#### ЁЯФ╣ SessionAuthentication Flow

```
Login Request тЖТ Server тЖТ Create Session тЖТ Cookie рж╕рзЗржЯ
ржкрж░рзЗрж░ request тЖТ Cookie (Session ID) ржжрж┐рзЯрзЗ Server verify
```

(рж╢рзБржзрзБ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржнрж╛рж▓рзЛ ржХрж╛ржЬ ржХрж░рзЗ)

---

#### ЁЯФ╣ JWTAuthentication Flow

```
Login тЖТ Server тЖТ Access + Refresh token issue
API request тЖТ Access token ржжрж┐рзЯрзЗ verify #by using server side secret key
Access expire тЖТ Refresh token ржжрж┐рзЯрзЗ ржирждрзБржи Access
Logout тЖТ Refresh token blacklist
```

---

### 5я╕ПтГг ржХржмрзЗ ржХрзЛржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм?

- **BasicAuth** тЖТ рж╢рзБржзрзБ ржЯрзЗрж╕рзНржЯ ржХрж░рж╛рж░ рж╕ржорзЯ ржмрж╛ ржЦрзБржм ржЫрзЛржЯ API ржПрж░ ржЬржирзНржп (ржкрзНрж░рзЛржбрж╛ржХрж╢ржирзЗ ржирж╛)
- **SessionAuth** тЖТ Django Template ржнрж┐рждрзНрждрж┐ржХ ржУрзЯрзЗржм ржЕрзНржпрж╛ржкрзЗрж░ ржЬржирзНржп
- **JWTAuth** тЖТ SPA (React/Vue/Angular) ржмрж╛ Mobile app + scalable API ржПрж░ ржЬржирзНржп

---

### 6я╕ПтГг ржпржжрж┐ ржирж╛ ржХрж░рждрж╛ржо?

- **JWT ржЫрж╛рзЬрж╛** тЖТ Mobile app ржП рж╕рж┐ржХрж┐ржЙрж░ржнрж╛ржмрзЗ Auth ржХрж░рж╛ ржХржарж┐ржи
- **Blacklist ржЫрж╛рзЬрж╛** тЖТ Logout ржХрж░рж▓рзЗржУ ржкрзБрж░ржирзЛ ржЯрзЛржХрзЗржи ржжрж┐рзЯрзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржкрж╛ржУрзЯрж╛ ржпрзЗржд
- **Refresh token ржЫрж╛рзЬрж╛** тЖТ Access expire рж╣рзЯрзЗ ржЧрзЗрж▓рзЗ ржЗржЙржЬрж╛рж░ржХрзЗ ржмрж╛рж░ржмрж╛рж░ Login ржХрж░рждрзЗ рж╣ржд

---

## тЬЕ Day 21: JWT Advanced & Security (Django + DRF + SimpleJWT)

- Token expiry setup, refresh endpoint
- Token from headers
- Login/logout with JWT

### 1 ) Token lifetime & SIMPLE_JWT config (security options)

`settings.py` ржП ржХрж┐ржЫрзБ recommended settings:

```python
from datetime import timedelta

SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=5),
    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),
    'ROTATE_REFRESH_TOKENS': True,
    'BLACKLIST_AFTER_ROTATION': True,
    'ALGORITHM': 'HS256',
    'SIGNING_KEY': SECRET_KEY,  # production ржП alernative: private key for RS256
    'VERIFYING_KEY': None,
    'AUTH_HEADER_TYPES': ('Bearer',),
    'AUTH_HEADER_NAME': 'HTTP_AUTHORIZATION',
    'USER_ID_FIELD': 'id',
    'USER_ID_CLAIM': 'user_id',
    'UPDATE_LAST_LOGIN': False,
}
```

**ржмрзНржпрж╛ржЦрзНржпрж╛ (step-by-step)**

- `ACCESS_TOKEN_LIFETIME`: ржЫрзЛржЯ ржХрж░рзЗ рж░рж╛ржЦрзЛ (5тАУ15 ржорж┐ржирж┐ржЯ)ред ржпржжрж┐ ржХрж┐ржЫрзБ ржмрзЗрж╢рж┐ security ржжрж░ржХрж╛рж░ тЖТ ржХржо рж░рж╛ржЦрзЛред
- `REFRESH_TOKEN_LIFETIME`: ржЗржЙржЬрж╛рж░ржХрзЗ ржмрж╛рж░ржмрж╛рж░ рж▓ржЧржЗржи ржирж╛ ржХрж░рж╛рждрзЗ ржПржХржЯрзБ ржмрзЬ (рзйтАУрззрзк ржжрж┐ржи) ржХрж░рж╛ ржпрж╛рзЯред
- `ROTATE_REFRESH_TOKENS`: True ржХрж░рж▓рзЗ refresh use ржХрж░рж▓рзЗ ржирждрзБржи refresh ржЗрж╕рзНржпрзБ рж╣ржмрзЗред ржкрзБрж░ржирзЛ token blacklist
  ржХрж░рж▓рзЗ reuse detect ржХрж░рж╛ ржпрж╛ржмрзЗред
- `BLACKLIST_AFTER_ROTATION`: True рж╣рж▓рзЗ ржкрзБрж░ржирзЛ refresh token ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рж╛ рж╣ржмрзЗред
- `ALGORITHM`: HS256 рж╕рж╛ржзрж╛рж░ржг; production ржП microservice architecture ржерж╛ржХрж▓рзЗ RS256 (asymmetric) use ржХрж░рж╛
  ржЙрждрзНрждржо тАФ рждржЦржи ржПржХржЯрж┐ private key ржжрж┐рзЯрзЗ sign ржУ public key ржжрж┐рзЯрзЗ verify ржХрж░рж╛ ржпрж╛рзЯред
- `AUTH_HEADER_TYPES`: default ('Bearer',) -> Authorization: Bearer <token>

---

### 2 ) Endpoint ржУ view тАФ SignUp, Login, Refresh, Logout

#### 2.1 SignUp (User create)

**serializer.py**

```python
from rest_framework import serializers
from django.contrib.auth import get_user_model

User = get_user_model()
 # jodi register er maddhome direct login er dorkar hoy
        '''
        from rest_framework_simplejwt.tokens import RefreshToken
       from rest_framework_simplejwt.exceptions import  AuthenticationFailed

def get_tokens_for_user(user):
    if not user.is_active:
      raise AuthenticationFailed("User is not active")

    refresh = RefreshToken.for_user(user)

    return {
        'refresh': str(refresh),
        'access': str(refresh.access_token),
    }
        '''

class RegisterSerializer(serializers.ModelSerializer):
    password = serializers.CharField(write_only=True, min_length=8)

    class Meta:
        model = User
        fields = ('id', 'username', 'email', 'password')

    def create(self, validated_data):
        user = User.objects.create_user(
            username=validated_data['username'],
            email=validated_data.get('email'),
            password=validated_data['password']
        )
       tokens=get_tokens_for_user(user)  # jodi register er maddhome direct login er dorkar hoy
        return {'user':user,'tokens':tokens}
```

**ржХрзЗржи?** тАФ `create_user` Django built-in ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб рж╣рзНржпрж╛рж╢рж┐ржВ ржХрж░рзЗ ржжрзЗрзЯ, рж╕рж░рж╛рж╕рж░рж┐ `User.objects.create()`
ржирж╛ ржХрж░рзЗред

**view\.py**

```python
from rest_framework.generics import CreateAPIView
from .serializers import RegisterSerializer

class RegisterView(CreateAPIView):
    serializer_class = RegisterSerializer
```

**urls.py**

```python
from django.urls import path
from .views import RegisterView

urlpatterns = [
    path('api/auth/register/', RegisterView.as_view(), name='register'),
]
```

### 2.2 Login тАФ TokenObtainPair (customize to include user info)

SimpleJWT ржПрж░ `TokenObtainPairView` ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм, ржХрж┐ржирзНрждрзБ response ржП user info ржпрзЛржЧ ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗ custom
serializer рждрзИрж░рж┐ ржХрж░ржмред

```python
# serializers.py
from rest_framework_simplejwt.serializers import TokenObtainPairSerializer

class MyTokenObtainPairSerializer(TokenObtainPairSerializer):
    @classmethod
    def get_token(cls, user):
        token = super().get_token(user)
        # ржПржЦрж╛ржирзЗ additional claims ржпрзЛржЧ ржХрж░рж╛ ржпрж╛ржмрзЗ
        token['username'] = user.username
        return token

    def validate(self, attrs):
        data = super().validate(attrs)
        data.update({'user': {
            'id': self.user.id,
            'username': self.user.username,
            'email': self.user.email,
        }})
        return data
```

```python
# views.py
from rest_framework_simplejwt.views import TokenObtainPairView
from .serializers import MyTokenObtainPairSerializer

class MyTokenObtainPairView(TokenObtainPairView):
    serializer_class = MyTokenObtainPairSerializer
```

**urls.py**

```python
from rest_framework_simplejwt.views import TokenRefreshView
from .views import MyTokenObtainPairView

urlpatterns += [
    path('api/auth/token/', MyTokenObtainPairView.as_view(), name='token_obtain_pair'),
    path('api/auth/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
]
```

**ржЕржержмрж╛ ржорзНржпрж╛ржирзБрзЯрж╛рж▓ create ржХрж░рзЗ рж▓ржЧржЗржи**

```python
#serializer.py
from rest_framework import serializers
from account.models import User
from django.utils.encoding import smart_str, force_bytes, DjangoUnicodeDecodeError
from django.utils.http import urlsafe_base64_decode, urlsafe_base64_encode
from django.contrib.auth.tokens import PasswordResetTokenGenerator
from account.utils import Util

class UserLoginSerializer(serializers.ModelSerializer):
  email = serializers.EmailField(max_length=255)
  class Meta:
    model = User
    fields = ['email', 'password']


#view.py
from rest_framework.response import Response
from rest_framework import status
from rest_framework.views import APIView
from account.serializers import SendPasswordResetEmailSerializer, UserChangePasswordSerializer, UserLoginSerializer, UserPasswordResetSerializer, UserProfileSerializer, UserRegistrationSerializer
from django.contrib.auth import authenticate
from account.renderers import UserRenderer
from rest_framework_simplejwt.tokens import RefreshToken
from rest_framework.permissions import IsAuthenticated

# Generate Token Manually
def get_tokens_for_user(user):
  refresh = RefreshToken.for_user(user)
  return {
      'refresh': str(refresh),
      'access': str(refresh.access_token),
  }

class UserLoginView(APIView):
  def post(self, request, format=None):
    serializer = UserLoginSerializer(data=request.data)
    serializer.is_valid(raise_exception=True)
    email = serializer.data.get('email')
    password = serializer.data.get('password')
    user = authenticate(email=email, password=password)
    if user is not None:
      token = get_tokens_for_user(user)
      return Response({'token':token, 'msg':'Login Success'}, status=status.HTTP_200_OK)
    else:
      return Response({'errors':{'non_field_errors':['Email or Password is not Valid']}}, status=status.HTTP_404_NOT_FOUND)

**urls.py**
urlpatterns += [
     path('login/', UserLoginView.as_view(), name='login'),
]
```

### 2.3 Logout тАФ blacklist

```python
# auth_app/serializers.py
from rest_framework import serializers
from rest_framework_simplejwt.tokens import RefreshToken
from rest_framework.exceptions import ValidationError

class LogoutSerializer(serializers.Serializer):
    refresh = serializers.CharField()

    def validate(self, attrs):
        self.token = attrs.get("refresh")
        return attrs

    def save(self, **kwargs):
        try:
            token = RefreshToken(self.token)
            token.blacklist()
        except Exception:
            raise ValidationError("Invalid or expired token!")

# auth_app/views.py
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from .serializers import LogoutSerializer
from rest_framework.permissions import IsAuthenticated

class LogoutView(APIView):
    permission_classes = [IsAuthenticated]  # Access token рж▓рж╛ржЧржмрзЗ

    def post(self, request):
        serializer = LogoutSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        serializer.save()
        return Response({"message": "Logged out successfully"}, status=status.HTTP_205_RESET_CONTENT)


# auth_app/urls.py
from django.urls import path
from .views import LogoutView

urlpatterns = [
    path("logout/", LogoutView.as_view(), name="logout"),
]

```

**ржХрзЗржи?** тАФ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рж╛ ржирж╛ ржерж╛ржХрж▓рзЗ Refresh token ржжрж┐рзЯрзЗ ржЖржмрж╛рж░ Access ржкрзЗрзЯрзЗ ржпрж╛ржУржпрж╝рж╛ ржпрж╛ржмрзЗред

---

#### 3) Token from Headers vs Cookie тАФ ржХрзЛржерж╛рзЯ token рж░рж╛ржЦржм, ржХрж┐ржнрж╛ржмрзЗ ржирж┐ржмрзЛ

##### 3.1 Default (Headers)

**Header format:**

```
Authorization: Bearer <access_token>
```

**curl example:**

```bash
curl -H "Authorization: Bearer $ACCESS" http://localhost:8000/api/protected/
```

**ржХрзЗржи?** тАФ рж╕рж╣ржЬ ржУ рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржбред ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ (frontend/mobile) ржПржЗ header ржжрж┐рзЯрзЗ ржкрж╛ржарж╛рзЯред

#### 3.2 Cookie-based approach (safer against XSS if done right)

**ржмрзЗрж╕рзНржЯ ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕:**

- `refresh` token рж░рж╛ржЦрзЛ **HttpOnly cookie**-рждрзЗ (JavaScript ржерзЗржХрзЗ ржирж╛ ржкрзЬрж╛ ржпрж╛рзЯ) тАФ XSS рж╣рж▓рзЗ attacker JS
  ржжрж┐рзЯрзЗ cookie ржирж┐рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ред
- `access` token рж░рж╛ржЦрзЛ memory (JS variable) ржмрж╛ short-lived HttpOnly cookieред
- Use CSRF protection on refresh endpoint if refresh token in cookie.

**Login view (cookie-set) ржЙржжрж╛рж╣рж░ржг:**

```python
class CookieTokenObtainPairView(TokenObtainPairView):
    serializer_class = MyTokenObtainPairSerializer

    def post(self, request, *args, **kwargs):
        response = super().post(request, *args, **kwargs)
        # response.data has 'access' and 'refresh'
        refresh = response.data.get('refresh')
        access = response.data.get('access')
        # set HttpOnly secure cookie for refresh
        response.set_cookie(
            key='refresh',
            value=refresh,
            httponly=True,
            secure=True,      # production: True
            samesite='Lax',
            max_age=7*24*3600,
        )
        # optionally set access token too (or keep in JS memory)
        # remove refresh from JSON body so JS can't read it
        response.data.pop('refresh', None)
        return response
```

**Custom authentication to read token from cookie (if you want access token from cookie):**

```python
from rest_framework_simplejwt.authentication import JWTAuthentication

class CookieJWTAuthentication(JWTAuthentication):
    def authenticate(self, request):
        # First try default header
        header = self.get_header(request)
      if header is None:
        # header ржирж╛ ржерж╛ржХрж▓рзЗ ржПржЦрж╛ржирзЗ ржХрзБржХрж┐ ржерзЗржХрзЗ ржЯрзЛржХрзЗржи ржирзЗржУрзЯрж╛ рж╣ржмрзЗ
         raw_token = request.COOKIES.get('access') or request.COOKIES.get('refresh')
         if raw_token is None:
           return None  # ржХрзБржХрж┐рждрзЗржУ ржирж╛ ржерж╛ржХрж▓рзЗ ржХрзЛржирзЛ ржЕржерзЗржирзНржЯрж┐ржХрзЗрж╢ржи рж╣ржмрзЗ ржирж╛
         validated_token = self.get_validated_token(raw_token)
         return self.get_user(validated_token), validated_token
       # ржпржжрж┐ header ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржбрж┐ржлрж▓рзНржЯ JWTAuthentication ржПрж░ authenticate  ржорзЗржержб ржХрж▓ рж╣ржмрзЗ
      return super().authenticate(request)

```

**ржХрзЗржи cookie?** тАФ HttpOnly cookie рж╣рж▓рзЗ XSS ржерзЗржХрзЗ ржирж┐рж░рж╛ржкржж; ржХрж┐ржирзНрждрзБ cookie ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ CSRF ржПрж░ ржмрзНржпрж╛ржкрж╛рж░рзЗ
рж╕рждрж░рзНржХ ржерж╛ржХрждрзЗ рж╣ржмрзЗред CSRF mitigate ржХрж░рж╛рж░ ржЬржирзНржп refresh endpoint-ржП CSRF token check рж░рж╛ржЦрж╛ ржкрзНрж░рзЯрзЛржЬржи (or use
double submit cookie pattern)ред

**рж╕рж┐ржжрзНржзрж╛ржирзНрждрзЗрж░ ржирж┐рзЯржо (rule of thumb)**

- High security: Refresh token in HttpOnly cookie + short access token in memory.
- Simpler SPAs: access in memory/local variable, refresh in secure HttpOnly cookie.
- Avoid storing JWT in localStorage (XSS ржЭрзБржБржХрж┐ ржЖржЫрзЗ)ред

---

### 4) Change password API (detailed)

**Purpose:** Logged-in user password ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ред

```python
# serializers.py
from rest_framework import serializers

class ChangePasswordSerializer(serializers.Serializer):
    old_password = serializers.CharField(required=True)
    new_password = serializers.CharField(required=True, min_length=8)

# views.py
from rest_framework.permissions import IsAuthenticated
from rest_framework import status
from rest_framework.response import Response
from rest_framework.views import APIView

class ChangePasswordView(APIView):
    permission_classes = (IsAuthenticated,)

    def post(self, request):
        serializer = ChangePasswordSerializer(data=request.data)
        if serializer.is_valid():
            user = request.user
            if not user.check_password(serializer.validated_data['old_password']):
                return Response({'old_password': 'Wrong password.'}, status=status.HTTP_400_BAD_REQUEST)
            user.set_password(serializer.validated_data['new_password'])
            user.save()
            return Response({'detail': 'Password updated successfully.'}, status=status.HTTP_200_OK)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
```

**ржХрзЗржи?**

- `check_password` ржирж╛ ржХрж░рж▓рзЗ ржХрзЗржЙ ржнрзБрж▓ ржХрж░рзЗ ржЕржирзНржп ржХрзЗржЙ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржмржжрж▓рж╛ржмрзЗ
- `set_password` Django ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб рж╣рзНржпрж╛рж╢рж┐ржВ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ

---

### 5) Forgot password / Reset password (API) тАФ step by step

**High level:**

1. User email ржкрж╛ржарж╛рзЯ `/password-reset/` тЖТ server UID+token ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рзЗ ржЗржорзЗржЗрж▓ ржкрж╛ржарж╛рзЯ (link containing
   uid & token)
2. User ржХрзНрж▓рж┐ржХ ржХрж░рзЗ frontend page (ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржирждрзБржи рж╕рзЗржЯ ржХрж░рж╛рж░ form) тЖТ form submit ржХрж░рзЗ
   `/password-reset-confirm/<uid>/<token>/` API ржП
3. Server token verify ржХрж░рзЗ ржирждрзБржи ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб рж╕рзЗржЯ ржХрж░рзЗ

**рзз) Password reset request view**

```python
# views.py
from django.contrib.auth.tokens import default_token_generator
from django.utils.http import urlsafe_base64_encode
from django.utils.encoding import force_bytes
from django.contrib.auth import get_user_model
from django.core.mail import send_mail
from rest_framework.views import APIView
from rest_framework.response import Response

User = get_user_model()

class PasswordResetRequestView(APIView):
    def post(self, request):
        email = request.data.get('email')
        user = User.objects.filter(email=email).first()
        if user:
            uid = urlsafe_base64_encode(force_bytes(user.pk))
            token = default_token_generator.make_token(user)
            # build frontend url where user will set new password
            frontend_url = 'https://your-frontend.com/reset-password'
            reset_link = f"{frontend_url}/{uid}/{token}/"
            send_mail(
                subject='Password reset',
                message=f'Use this link to reset your password: {reset_link}',
                from_email='no-reply@example.com',
                recipient_list=[user.email],
            )
        # security: always return success message to avoid email enumeration
        return Response({'detail': 'If an account with that email exists, a reset link has been sent.'})
```

**рзи) Password reset confirm view**

```python
from django.utils.http import urlsafe_base64_decode
from django.utils.encoding import force_str
from django.contrib.auth.tokens import default_token_generator

class PasswordResetConfirmView(APIView):
    def post(self, request, uidb64, token):
        try:
            uid = force_str(urlsafe_base64_decode(uidb64))
            user = User.objects.get(pk=uid)
        except Exception:
            return Response({'detail': 'Invalid link.'}, status=400)

        if not default_token_generator.check_token(user, token):
            return Response({'detail': 'Invalid or expired token.'}, status=400)

        new_password = request.data.get('new_password')
        if not new_password or len(new_password) < 8:
            return Response({'detail': 'Password too short.'}, status=400)

        user.set_password(new_password)
        user.save()
        return Response({'detail': 'Password has been reset successfully.'})
```

**ржХрзЗржи?**

- Token + uid base64 ржжрзНржмрж╛рж░рж╛ user verify ржХрж░рж╛ рж╣рзЯ, ржПржмржВ token expiry/one-time ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛ рж╣рзЯ
- ржЗржорзЗрж▓ ржЕржмржЬрзЗржХрж╢ржи ржерзЗржХрзЗ рж░ржХрзНрж╖рж╛ ржкрзЗрждрзЗ success message рж╕ржмрж╕ржорзЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛ рж╣рзЯ

---

### 6) Token revocation & refresh rotation тАФ Deep dive

**Problem:** Refresh token рж▓рж┐ржХ рж╣рж▓рзЗ attacker ржжрзАрж░рзНржШ рж╕ржорзЯ ржзрж░рзЗ ржирждрзБржи Access ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред

**Solution options:**

1. Short refresh lifetime (ржХржо ржжрж┐ржи)
2. Refresh rotation: ржкрзНрж░рждрж┐ refresh use ржП ржирждрзБржи refresh ржЗрж╕рзНржпрзБ рж╣рзЯ ржПржмржВ ржкрзБрж░ржирзЛ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ рж╣рзЯ
3. Blacklist database: revoked tokenржЧрзБрж▓рзЛ рж╕рж╛рж░рзНржнрж╛рж░рзЗ рж░рж╛ржЦрж╛
4. Detect reuse: ржпржжрж┐ ржЖржЧрзЗржЗ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рж╛ token reuse ржХрж░рж╛ рж╣рзЯ тЖТ possible compromise тЖТ invalidate all
   sessions

**SimpleJWT config (recap)**

```python
SIMPLE_JWT.update({
    'ROTATE_REFRESH_TOKENS': True,
    'BLACKLIST_AFTER_ROTATION': True,
})
```

**ржХрзЗржи?**

- ROTATE_REFRESH_TOKENS=True ржХрж░рж▓рзЗ refresh use ржХрж░рж▓рзЗ ржирждрзБржи refresh+access ржжрж┐ржмрзЗ ржПржмржВ ржкрзБрж░ржирзЗрж╛ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ
  рж╣ржмрзЗ (ржпржжрж┐ BLACKLIST_AFTER_ROTATION=True ржерж╛ржХрзЗ)ред

**Logout flow (best practice)**

- Client calls logout API, server blacklists refresh token
- Server optionally rotate refresh on each refresh so stolen refresh cannot be reused

---

### 7) Advanced security best-practices checklist (A to Z)

- Always use HTTPS in production
- Keep ACCESS_TOKEN short (minutes)
- Use REFRESH_TOKEN rotation + blacklist
- Store refresh token in HttpOnly cookie (reduce XSS risk)
- Don't store tokens in localStorage (XSS)
- For cookies set `Secure`, `HttpOnly`, `SameSite=Lax/Strict` as needed
- Use RS256 with private/public keys if you have microservices and need verifiability without
  sharing secret
- Limit scopes/claims in token (minimal privilege)
- Monitor login/refresh events and detect anomalies
- Implement brute force protection (rate-limit login endpoint)
- Revoke tokens on password change (consider update_last_login or force revocation)
- Consider device-based tokens (store device id with refresh token) for better revocation

---

### 8) Flow diagrams (ASCII) тАФ Quick mental maps

**Login (header based)**

```
[Client] --POST /auth/token (username+password)--> [Server]
    Server validate -> issue {access, refresh}
[Client stores access (in memory) & refresh (HttpOnly cookie or safe store)]

API call:
[Client] --GET /api/protected with header Authorization: Bearer <access>--> [Server verifies access]

Access expired ->
[Client] --POST /auth/token/refresh with refresh--> [Server verifies refresh -> issue new access (and maybe refresh if rotate)]
```

**Logout with blacklist**

```
[Client] --POST /auth/logout {refresh}--> [Server blacklists refresh]
Result: future token refresh attempts fail
```

**Password reset**

```
[Client] --POST /auth/password-reset {email}--> [Server sends email (uid, token link)]
User clicks link -> frontend form -> POST /auth/password-reset-confirm/{uid}/{token} with new password -> Server validate token -> set_password
```

---

### Quick FAQ (short answers)

**Q: Token ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖрж╕ржмрзЗ?** A: Normally `Authorization: Bearer <token>` header ржерзЗржХрзЗред ржХрж┐ржирзНрждрзБ ржпржжрж┐
cookie ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржУ, custom authentication class рж▓рж┐ржЦрзЗ cookie ржерзЗржХрзЗ token validate ржХрж░рждрзЗ ржкрж╛рж░рзЛред

**Q: ржХрзЗржи refresh token blacklist ржХрж░рж╛ рж▓рж╛ржЧржмрзЗ?** A: ржпржжрж┐ ржХрзЗржЙ refresh token ржЪрзБрж░рж┐ ржХрж░рзЗ, ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржирж╛
ржерж╛ржХрж▓рзЗ рж╕рзЗржЗ someone ржирждрзБржи access ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред

**Q: RS256 vs HS256?** A: HS256 symmetric (shared secret). RS256 asymmetric (private-public) тАФ
microservices ржП verification рж╕рж╣ржЬ (ржкрзНрж░рждрзНржпрзЗржХ service ржХрзЗ public key ржжрж┐рждрзЗ ржкрж╛рж░ржмрзЗ)ред

---

### рж╢рзЗрж╖ ржХржерж╛ тАФ ржХрж┐ ржХрж░рж╛ ржЙржЪрж┐ржд ржПржЦржиржЗ (practical TODOs)

1. `pip install djangorestframework-simplejwt`
2. settings.py ржП `REST_FRAMEWORK` ржУ `SIMPLE_JWT` ржХржиржлрж┐ржЧ ржХрж░рзЗ ржирж╛ржУ
3. `token_blacklist` migration ржЪрж╛рж▓рж╛ржУ: `python manage.py migrate`
4. Register, TokenObtainPair, TokenRefresh, Logout, ChangePassword, PasswordReset endpoints ржмрж╛ржирж╛ржУ
   (ржЙржкрж░рзЗ ржжрзЗржУрзЯрж╛ ржХрзЛржб copy-paste ржХрж░рзЗ ржЪрж▓рзЗ)
5. Local development ржП HTTPS ржирж╛ ржерж╛ржХрж▓рзЗ cookie `secure=True` ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ тАФ production ржП ржЕржмрж╢рзНржпржЗ HTTPS
   ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ

---

## тЬЕ Day 22: File Upload API

- ImageField upload

- media config

- File upload via API

---

### рж╕рж╛рж░ржорж░рзНржо (What you'll learn)

- `settings.py` ржП media ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи
- `models.ImageField` / `FileField` ржПржмржВ `upload_to` callable
- DRF-ржП ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржбрзЗрж░ ржЬржирзНржп `parser_classes` (MultiPartParser, FormParser)
- Serializer + ModelViewSet / APIView ржЙржжрж╛рж╣рж░ржг
- ржорзЗржорзЛрж░рж┐, ржирзЗржоржХржиржлрзНрж▓рж┐ржХрзНржЯ, ржирж┐рж░рж╛ржкрждрзНрждрж╛ (validation) ржУ рж╕рзНржЯрзЛрж░рзЗржЬ ржмрзНржпрж╛ржХржПржирзНржб (local vs S3)
- JWT authentication ржХрзЗржи ржжрж░ржХрж╛рж░ ржПржмржВ рж╕рзЗржЯржЖржк (SimpleJWT) тАФ step-by-step
- Postman / curl ржжрж┐рзЯрзЗ ржкрж░рзАржХрзНрж╖рж╛ ржПржмржВ ржЗржЙржирж┐ржЯ ржЯрзЗрж╕рзНржЯ ржХрж░рж╛рж░ ржЯрж┐ржкрж╕
- рж╕рж╛ржзрж╛рж░ржг рж╕ржорж╕рзНржпрж╛ ржУ debugging ржХрзМрж╢рж▓

---

### 0) ржкрзВрж░рзНржмрж╢рж░рзНржд

- Python (рзй.рзо+)
- Django (рзй.рзи+ ржнрж╛рж▓рзЛ)
- djangorestframework
- Pillow (ImageField ржЪрж╛рж▓рж╛рждрзЗ) # by deafalt thake
- (ржРржЪрзНржЫрж┐ржХ) djangorestframework-simplejwt (JWT) ржПржмржВ django-storages + boto3 (S3 ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ)

ржЗржирж╕рзНржЯрж▓ ржЙржжрж╛рж╣рж░ржг:

```bash
pip install django djangorestframework pillow djangorestframework-simplejwt
# optional for S3
pip install django-storages boto3
```

---

### 1) settings.py тАФ MEDIA ржХржиржлрж┐ржЧрж╛рж░

**ржХрзЗржи:** Django-ржХрзЗ ржЬрж╛ржирж╛ржирзЛ ржпрзЗ ржорж┐ржбрж┐рзЯрж╛ ржлрж╛ржЗрж▓ ржХрзЛржерж╛рзЯ рж░рж╛ржЦрж╛ рж╣ржмрзЗ ржПржмржВ ржХрзАржнрж╛ржмрзЗ URL рж╣ржмрзЗред

```python
# settings.py
import os
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')

INSTALLED_APPS += [
    'rest_framework',
    # ржпржжрж┐ JWT ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ:
    'rest_framework_simplejwt',
]

REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
        # 'rest_framework.authentication.SessionAuthentication',
    ),
    'DEFAULT_PERMISSION_CLASSES': (
        'rest_framework.permissions.IsAuthenticated',
    ),
}

# ржпржжрж┐ S3 ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржУ (optional)
# DEFAULT_FILE_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'
```

## **ржирзЛржЯ:** development ржП `DEBUG=True` ржерж╛ржХрж▓рзЗ `django.conf.urls.static.static()` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ media рж╕рж╛рж░рзНржн ржХрж░рж╛ ржЙржЪрж┐рждред production ржП ржУрзЯрзЗржм рж╕рж╛рж░рзНржнрж╛рж░ (nginx, apache) ржжрж┐рзЯрзЗ рж╕рж╛рж░рзНржн ржХрж░рзЛред

### 2) urls.py тАФ development ржП media рж╕рж╛рж░рзНржн

```python
# project/urls.py
from django.conf import settings
from django.conf.urls.static import static
from django.urls import path, include

urlpatterns = [
    path('api/', include('myapp.urls')),
]

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

**ржХрзЗржи:** development server (runserver) ржжрж┐рзЯрзЗ ржЫржмрж┐/ржлрж╛ржЗрж▓ ржжрзЗржЦрж╛ ржпрж╛рзЯред production ржП ржкрзНрж░ржХрзГржд рж╕рж╛рж░рзНржнрж╛рж░ ржжрж┐рзЯрзЗ
serve ржХрж░ржмрзЗред

---

### 3) models.py тАФ FileField / ImageField ржПржмржВ upload_to

**ржХрзЗржи:** ржирж┐рж░рж╛ржкржж ржирж╛ржо, ржирзЗржо ржХржиржлрзНрж▓рж┐ржХрзНржЯ ржПрзЬрж╛ржирзЛ ржУ рж▓ржЬрж┐ржХ ржЖрж▓рж╛ржжрж╛ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп `upload_to` callable ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛
ржнрж╛рж▓ред

```python
# myapp/models.py
import os
import uuid
from datetime import datetime
from django.db import models
from django.conf import settings


def upload_to_uuid_path(instance, filename):
    """ржлрж╛ржЗрж▓ ржирж╛ржорзЗ uuid ржпрзЛржЧ ржХрж░рзЗ, date-based folder ржП рж░рж╛ржЦрзЗред ржПржЗржнрж╛ржмрзЗ ржирж╛ржо ржХржиржлрзНрж▓рж┐ржХрзНржЯ ржПрзЬрж╛ржирзЛ ржпрж╛рзЯред"""
    ext = filename.split('.')[-1]
    filename = f"{uuid.uuid4().hex}.{ext}"
    # path: uploads/2025/08/11/uuid.jpg
    return os.path.join('uploads', datetime.now().strftime('%Y/%m/%d'), filename)


class Photo(models.Model):
    title = models.CharField(max_length=255, blank=True)
    image = models.ImageField(upload_to=upload_to_uuid_path)
    owner = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    uploaded_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"Photo({self.id})"
```

**ржХрзЗржи ржПржЗржнрж╛ржмрзЗ?**

- `uuid` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржирж╛ржо ржХржиржлрзНрж▓рж┐ржХрзНржЯ ржкрзНрж░рж╛рзЯ ржЪрж┐рж░рждрж░рзЗ рж╢рзЗрж╖ред
- Date-based folder рж╣рж▓рзЗ ржлрж╛ржЗрж▓ ржорзНржпрж╛ржирзЗржЬ ржХрж░рж╛ рж╕рж╣ржЬ рж╣рзЯред
- Django ржПрж░ FileField / ImageField-ржП upload_to ржжрзБржЗржнрж╛ржмрзЗ ржжрзЗрзЯрж╛ ржпрж╛рзЯ: `1` string path: "uploads/images/"
  `2` callable function: upload_to=your_function
  > `note` Callable рж╣рж▓рзЗ Django save ржХрж░рж╛рж░ рж╕ржорзЯ:

```python
final_path = upload_to(instance, original_filename)
```

ржПржЗржЦрж╛ржирзЗ:

instance тЖТ model-ржПрж░ рж╕рзЗржЗ object ржпрзЗржЯрж╛ save рж╣ржЪрзНржЫрзЗ

filename тЖТ user ржпрзЗржЯрж╛ ржЖржкрж▓рзЛржб ржХрж░рзЗржЫрзЗ рждрж╛рж░ ржЖрж╕рж▓ ржирж╛ржо

##### ЁЯУМ ржХрзЗржи function ржжрж┐ржЪрзНржЫрж┐?

ржХрж╛рж░ржг ржПржЦрж╛ржирзЗ ржЖржорж┐ ржЪрж╛ржЗ dynamic path + unique filenameред String ржжрж┐рж▓рзЗ рж╕ржм ржлрж╛ржЗрж▓ ржПржХ ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржЬржорж╛ рж╣ржмрзЗ, conflict
рж╣ржмрзЗред

- `upload_to` callable ржжрж┐рж▓рзЗ filename logic ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рж╛ ржпрж╛рзЯ (e.g., user-id subfolder, hashing
  ржЗрждрзНржпрж╛ржжрж┐)ред

**ржмрж┐ржХрж▓рзНржк:** ржпржжрж┐ рждрзБржорж┐ ржЪрж╛ржирзЛ ржлрж╛ржЗрж▓рзЗрж░ ржирж╛ржоржЗ рж░рж╛ржЦрж╛ рж╣рзЛржХ, рждрж╛рж╣рж▓рзЗ `upload_to='uploads/originals/'` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ
ржкрж╛рж░рзЛ тАФ ржХрж┐ржирзНрждрзБ ржирзЗржо ржХржиржлрзНрж▓рж┐ржХрзНржЯ ржУ ржЭрзБржБржХрж┐ ржерж╛ржХржмрзЗред

---

### 3.1 ЁЯОпmulticase off upload_to

#### ЁЯФ╣ 1. ржпржжрж┐ ржЖржорж░рж╛ upload_to = 'uploads/' string ржжрж┐ржЗ

рждрж╛рж╣рж▓рзЗ Django ржПржоржиржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ:

```
image = models.ImageField(upload_to='uploads/')
```

ржПрж░ ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ:

- ржЖржкрж▓рзЛржб ржХрж░рж╛ ржлрж╛ржЗрж▓ тАМтЖТ MEDIA_ROOT/uploads/ ржбрж┐рж░рзЗржХрзНржЯрж░рж┐рж░ ржоржзрзНржпрзЗ ржпрж╛ржмрзЗ

- ржлрж╛ржЗрж▓рзЗрж░ original ржирж╛ржо ъ╖╕ыМАыбЬ рж░рж╛ржЦрж╛ рж╣ржмрзЗ (ржпрзЗржоржи photo.jpg)

- ржпржжрж┐ ржПржХржЗ ржирж╛ржорзЗрж░ ржлрж╛ржЗрж▓ ржЖржЧрзЗржЗ ржерж╛ржХрзЗ, Django ржирждрзБржи ржирж╛ржо ржмрж╛ржирж┐рзЯрзЗ ржпрзЗржоржи photo_1.jpg ржжрж┐рзЯрзЗ рж╕рзЗржЗ ржлрж╛ржЗрж▓ рж░рзЗржЦрзЗ ржжрзЗрзЯ
  (naming conflict avoid ржХрж░рждрзЗ)

ЁЯУМ ржПржЯрж╛ Django-ржПрж░ default behavior тАФ internally ржПржХржЯрж╛ get_available_name() method ржжрж┐рзЯрзЗ ржЪрзЗржХ ржХрж░рзЗ ржлрж╛ржЗрж▓
ржЖржЧрзЗ ржЖржЫрзЗ ржХрж┐ржирж╛ред

тЭЧ рж╕ржорж╕рзНржпрж╛:

- ржПржХржЗ ржлрж╛ржЗрж▓ ржирж╛ржо ржерж╛ржХрж▓рзЗ conflict рж╣рждрзЗ ржкрж╛рж░рзЗ

- ржХрзЗржЙ ржпржжрж┐ malicious ржирж╛ржорзЗ ржлрж╛ржЗрж▓ ржкрж╛ржарж╛рзЯ (../ or special chars), рждржЦржи security issue рж╣рждрзЗ ржкрж╛рж░рзЗ

#### ЁЯФ╣ 2. ржпржжрж┐ ржЖржорж░рж╛ upload_to = callable function ржжрж┐ржЗ (ржпрзЗржоржи upload_to_uuid_path)

```python
def upload_to_uuid_path(instance, filename):
    ext = filename.split('.')[-1]
    filename = f"{uuid.uuid4().hex}.{ext}"

    return os.path.join('uploads', datetime.now().strftime('%Y/%m/%d'), filename)   """ date_parts = datetime.now().strftime('%Y/%m/%d').split("/")
path = os.path.join('uploads', *date_parts, 'filename.jpg')
 """  #best practise karon cross flatform hoy date wise folder hoye oikhane file thake ami nirdisto diner file pete pari

```

ржПрж░ ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ:

Django ржкрзНрж░рждрж┐ржЯрж┐ ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржбрзЗрж░ рж╕ржорзЯ upload_to_uuid_path() function-ржЯрж┐ call ржХрж░рзЗ

- ржПржЯрж╛ instance (model instance) ржПржмржВ filename (original file name) ржжрзБржЗржЯрж╛ржХрзЗ argument рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛рзЯ

- function ржПрж░ return value рж╣рзЯ relative path (e.g. uploads/2025/08/11/0abac34de1.jpg)

ржПржЦржи ржлрж╛ржЗрж▓ ржпрж╛ржмрзЗ ржПржЦрж╛ржирзЗ:

```python
MEDIA_ROOT/uploads/2025/08/11/<uuid>.jpg
```

ЁЯУМ ржПржЦрж╛ржирзЗржУ Django рж╢рзЗрж╖рзЗ check ржХрж░рзЗ ржпржжрж┐ ржлрж╛ржЗрж▓ржЯрж╛ ржЖржЧрзЗржЗ ржерзЗржХрзЗ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржЖржмрж╛рж░ rename ржХрж░рзЗ тАФ ржХрж┐ржирзНрждрзБ uuid ржерж╛ржХрж╛рзЯ
conflict chance ржХржоред

#### тЬЕ Bottom Line:

| Upload To             | File Path Logic                                | Filename Behavior            | Conflict Avoiding                            |
| --------------------- | ---------------------------------------------- | ---------------------------- | -------------------------------------------- |
| `'uploads/'` (string) | MEDIA_ROOT/uploads/original_name.jpg           | original name used           | Django `_1`, `_2` ржжрж┐рзЯрзЗ rename ржХрж░рзЗ            |
| callable function     | Return value: e.g. uploads/2025/08/11/uuid.jpg | custom logic ржжрж┐рзЯрзЗ ржмрж╛ржирж╛ржирзЛ ржирж╛ржо | uuid ржжрж┐рж▓рзЗ conflict ржХржо, ржХрж┐ржирзНрждрзБ ржПржЦржирзЛ check ржХрж░рзЗ |

### 3.2 ЁЯОп uuid ржХрзАржнрж╛ржмрзЗ, ржХржЦржи, ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ

uuid тЖТ Universally Unique Identifierред uuid.uuid4().hex тЖТ random, unique 32-character stringред

- uuid рж╣рж▓рзЛ Python-ржПрж░ built-in module тАФ Universally Unique Identifier generate ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред

- uuid.uuid4() тЖТ ржПржХржЯрж╛ random UUID object рждрзИрж░рж┐ ржХрж░рзЗред ржПржЯрж╛ UUID version 4 (random)ред
- uuid4() рж╣рж▓рзЛ function, тАФ ржПржЯрж╛ uuid.UUID object ржПрж░ ржПржХржЯрж╛ object return ржХрж░рзЗ ржпрж╛рж░ **str** ржП рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛
  ржЖржЫрзЗ

```python
def __str__(self):
    return str(self.hex_formatted_with_hyphens)

```

рждрж╛ржЗ ржЖржорж░рж╛ ржПржЯрж╛ ржЕржмржЬрзЗржХрзНржЯ рж╣рзЯ рж╕рж░рзНрждрзЗржУ ржбрж╛ржЗрж░рзЗржХрзНржЯ ржкрзНрж░рж┐ржирзНржЯ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред

- hex рж╣рж▓рзЛ рж╕рзЗржЗ object-ржПрж░ ржПржХржЯрж╛ property тЖТ UUID-ржПрж░ hyphen-less hexadecimal string

- uuid.uuid4().hex тЖТ рж╕рзЗржЗ UUID-ржПрж░ 32-character hexadecimal string ржжрзЗрзЯ (hyphen ржЫрж╛рзЬрж╛)ред

```python
import uuid

u = uuid.uuid4()
print(u)           # Example: 3f1a3e7b-7647-4d70-8cfd-d72f53d9d49c  тЖР standard UUID (36 char with hyphens)
print(u.hex)       # Example: 3f1a3e7b76474d708cfdd72f53d9d49c       тЖР 32-char hex (no hyphens)
```

#### ржХрзЗржи ржжрж░ржХрж╛рж░:

- ржПржХржЗ ржирж╛ржорзЗрж░ ржлрж╛ржЗрж▓ overwriting ржПржбрж╝рж╛рждрзЗред

- URL guessing ржарзЗржХрж╛рждрзЗ (security)ред

#### ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ:

- Public uploads ржпрзЗржЦрж╛ржирзЗ ржЕржирзЗржХ ржЗржЙржЬрж╛рж░ ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржб ржХрж░ржмрзЗред

- ржПржоржи storage ржпрзЗржЦрж╛ржирзЗ ржПржХржЗ ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржЕржирзЗржХ ржлрж╛ржЗрж▓ ржЬржорж╛ рж╣ржмрзЗред

### 3.3 ЁЯОпos.path.join() ржХрзА ржПржмржВ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ

ржХрж╛ржЬ: Platform-independent ржлрж╛ржЗрж▓ path ржмрж╛ржирж╛рзЯ (Windows ржП \, Linux/Mac ржП / ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ)ред ржПржХрж╛ржзрж┐ржХ ржирзЗрж╕рзНржЯрзЗржб
ржлрж╛ржЗрж▓ ржкрж╛рже ржХрзЗ merge ржХрж░рзЗ cross platform ржПрж░ ржЬржирзНржпред **os.path.join()** рж╣рж▓ Python-ржПрж░ built-in os module-ржПрж░
ржПржХржЯрж╛ function, ржпрзЗржЯрж╛ ржПржХрж╛ржзрж┐ржХ path segment (folder, subfolder, file) ржХрзЗ рж╕ржарж┐ржХржнрж╛ржмрзЗ ржЬрзЛрзЬрж╛ рж▓рж╛ржЧрж╛рзЯ (join ржХрж░рзЗ),
ржпрж╛рждрзЗ рж╕рзЗржЯрж╛ тЬЕ platform-independent рж╣рзЯред

```python
os.path.join(path1, path2, ...)
```

ржмрзНржпржмрж╣рж╛рж░:

```python
os.path.join('uploads', '2025', '08', '11', 'file.jpg')
# Linux ржП: uploads/2025/08/11/file.jpg
# Windows ржП: uploads\2025\08\11\file.jpg
```

ЁЯУМ ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ: Hardcoded / ржирж╛ рж▓рж┐ржЦрзЗ cross-platform path ржмрж╛ржирж╛ржирзЛрж░ ржЬржирзНржпред

### 3.4 ЁЯОпdatetime.now() + strftime() ржПрж░ ржХрж╛ржЬ

- datetime.now() тЖТ ржмрж░рзНрждржорж╛ржи рждрж╛рж░рж┐ржЦ ржУ рж╕ржорзЯ ржжрзЗрзЯред

- strftime(format) тЖТ рж╕рзЗржЗ рждрж╛рж░рж┐ржЦ/рж╕ржорзЯ ржХрзЗ format ржХрж░рзЗ string ржмрж╛ржирж╛рзЯред

```python
from datetime import datetime

now = datetime.now()
print(now)  # 2025-08-11 14:35:10 (standard format)

date_path = now.strftime('%Y/%m/%d')
print(date_path)  # '2025/08/11' (customise_format) jade ata subfolder er moto kaj kore jn protidin er image gula oi date er namer folder e thake ... %Y = year,%m = month ,%d=date
```

ЁЯУМ ржмрзНржпржмрж╣рж╛рж░: ржлрж╛ржЗрж▓ date-based folder ржП рж░рж╛ржЦрж╛рж░ ржЬржирзНржпред

#### ЁЯФз strftime Format Codes:

| Format | ржорж╛ржирзЗ                      | Example |
| ------ | ------------------------- | ------- |
| `%Y`   | ржкрзВрж░рзНржг рж╕рж╛рж▓ (year)          | `2025`  |
| `%m`   | ржорж╛рж╕ (2 digit)             | `08`    |
| `%d`   | ржжрж┐ржи                       | `11`    |
| `%H`   | ржШржгрзНржЯрж╛ (24 ржШржирзНржЯрж╛ ржлрж░ржорзНржпрж╛ржЯрзЗ) | `14`    |
| `%M`   | ржорж┐ржирж┐ржЯ                     | `35`    |
| `%S`   | рж╕рзЗржХрзЗржирзНржб                   | `10`    |

## 4) Serializer тАФ ModelSerializer ржУ validation

**ржХрзЗржи:** Serializer рж╣рж▓ API-ржП ржбрж╛ржЯрж╛ ржнрзЗрж░рж┐ржлрж╛ржЗ ржХрж░рж╛рж░ ржЬрж╛рзЯржЧрж╛ред ржлрж╛ржЗрж▓рзЗрж░ рж╕рж╛ржЗржЬ, ржЯрж╛ржЗржк ржЗрждрзНржпрж╛ржжрж┐ ржПржЦрж╛ржирзЗ validate ржХрж░рж╛
ржЙржЪрж┐рждред

```python
# myapp/serializers.py
from rest_framework import serializers
from .models import Photo
from django.core.exceptions import ValidationError


def validate_image_file(image):
    # size check (рзи MB limit ржЙржжрж╛рж╣рж░ржг) by deafalt image.size  byte akare thake.
    max_size = 2 * 1024 * 1024
    if image.size > max_size:
        raise ValidationError('Image too large. max 2MB allowed.')

    # content-type check (DRF UploadedFile ржП content_type ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ)
    if hasattr(image, 'content_type'):
        if not image.content_type.startswith('image'):
            raise ValidationError('Uploaded file is not an image.')


class PhotoSerializer(serializers.ModelSerializer):
    image = serializers.ImageField()

    class Meta:
        model = Photo
        fields = ['id', 'title', 'image', 'uploaded_at', 'owner']
        read_only_fields = ['id', 'uploaded_at', 'owner']

    def validate_image(self, value):
        validate_image_file(value)
        return value

    def create(self, validated_data):
        # caller (view) ржерзЗржХрзЗ owner ржкрж╛ржарж╛ржи: serializer.save(owner=request.user)
        return Photo.objects.create(**validated_data)
```

**ржирзЛржЯ:** `validate_image` ржмрж╛ `validate()` ржП рждрзЛржорж╛рж░ рж╕ржм ржХрж╛рж╕рзНржЯржо ржЪрзЗржХ рж░рж╛ржЦрзЛ тАФ рж╣рзНржпрж╛ржХрж╛рж░рж░рж╛ file extension ржХржП
ржмрж╛ржзрж╛ржЗ ржлрзЗрж▓рзЗ рждрж╛ржЗ content-based validation ржУ ржкрзНрж░рзЯрзЛржЧ ржХрж░рж╛ ржЙржЪрж┐рждред

---

### 5) Views тАФ APIView vs ViewSet

**ржХрзЗржи:** `APIView` ржЧрзЗрж▓рзЗ рждрзБржорж┐ ржкрзБрж░рзЛ ржХржирзНржЯрзНрж░рзЛрж▓ ржирзЗржмрзЗ; `ModelViewSet` ржжрж┐рж▓рзЗ ржмрзЗрж╢рж┐ automation
(list/retrieve/create) ржорж┐рж▓рзЗред ржХрзЗржи `parser_classes` рж▓рж╛ржЧрзЗ? ржХрж╛рж░ржг DRF ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ JSON parser ржкржЫржирзНржж ржХрж░рзЗ;
ржлрж╛ржЗрж▓ ржкрж╛ржарж╛рждрзЗ рж╣рж▓рзЗ `multipart/form-data` ржкрзНрж░рзЯрзЛржЬржиред

**APIView ржЙржжрж╛рж╣рж░ржг:**

```python
# myapp/views.py
from rest_framework.views import APIView
from rest_framework.parsers import MultiPartParser, FormParser
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import IsAuthenticated
from rest_framework_simplejwt.authentication import JWTAuthentication
from .serializers import PhotoSerializer


class PhotoUploadView(APIView):
    parser_classes = [MultiPartParser, FormParser]
    permission_classes = [IsAuthenticated]
    authentication_classes = [JWTAuthentication]

    def post(self, request, format=None):
        # request.data will include form fields; file will be in request.FILES
        serializer = PhotoSerializer(data=request.data, context={'request': request})
        if serializer.is_valid():
            serializer.save(owner=request.user)
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
```

**ModelViewSet ржЙржжрж╛рж╣рж░ржг:**

```python
from rest_framework import viewsets

class PhotoViewSet(viewsets.ModelViewSet):
    queryset = Photo.objects.all()
    serializer_class = PhotoSerializer
    parser_classes = [MultiPartParser, FormParser]
    permission_classes = [IsAuthenticated]
    authentication_classes = [JWTAuthentication]

    def perform_create(self, serializer):
        serializer.save(owner=self.request.user)
```

**ржХрзЗржи context={'request': request}?**

- Serializer ржПрж░ ImageField ржпржжрж┐ `use_url=True` (ржбрж┐ржлрж▓рзНржЯ) рж╣рзЯ, рждрж╛рж╣рж▓рзЗ full URL (scheme+host) ржкрзЗрждрзЗ
  `request` context ржжрж░ржХрж╛рж░ред

### 5.1 ЁЯОп parser_classes

**parser_classes ржХрзА?:**

parser_classes рж╣ржЪрзНржЫрзЗ DRF-ржП ржПржоржи ржПржХржЯрж╛ рж▓рж┐рж╕рзНржЯ ржпрзЗржЦрж╛ржирзЗ ржЖржорж░рж╛ ржмрж▓рзЗ ржжрзЗржЗ тАФ "ржПржЗ view-ржПрж░ incoming request data
ржХрзЛржи ржХрзЛржи format-ржП ржЖрж╕рждрзЗ ржкрж╛рж░рзЗ, ржЖрж░ рж╕рзЗржЧрзБрж▓рзЛ parse ржХрж░рж╛рж░ ржЬржирзНржп ржХрзЛржи ржХрзЛржи parser ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗ"ред

ЁЯУМ DRF default parser list:

```python
'DEFAULT_PARSER_CLASSES': [
    'rest_framework.parsers.JSONParser',
    'rest_framework.parsers.FormParser',
    'rest_framework.parsers.MultiPartParser',
]
```

ржХрж┐ржирзНрждрзБ file upload-ржПрж░ рж╕ржорзЯ MultiPartParser рж▓рж╛ржЧржмрзЗржЗред

#### ржХржЦржи parser_classes call рж╣рзЯ?

Flow (APIView ржерзЗржХрзЗ рж╢рзБрж░рзБ):

1.Client request ржкрж╛ржарж╛рзЯ (ржпрзЗржоржи multipart/form-data)ред

2.Django view dispatch тЖТ DRF ржПрж░ APIView.dispatch() тЖТ initialize_request()ред

3.initialize_request() request object ржмрж╛ржирж╛ржирзЛрж░ рж╕ржорзЯ ржмрж▓рзЗ:

```python
request.parsers = [parser() for parser in self.get_parsers()]
```

**4** .get_parsers() method тЖТ

- ржкрзНрж░ржержорзЗ ржжрзЗржЦрзЗ view-ржП parser_classes рж╕рзЗржЯ ржХрж░рж╛ ржЖржЫрзЗ ржХрж┐ржирж╛ред

- ржерж╛ржХрж▓рзЗ рж╕рзЗржЯрж╛ ржирзЗрзЯ, ржирж╛ ржерж╛ржХрж▓рзЗ settings ржПрж░ DEFAULT_PARSER_CLASSES ржирзЗрзЯред **5**. DRF ржкрж░рзЗ request.data
  ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛рж░ рж╕ржорзЯ:

- ржкрзНрж░ржержорзЗ content-type ржЪрзЗржХ ржХрж░рзЗ (ржпрзЗржоржи multipart/form-data)ред

- ржорж┐рж▓ ржкрж╛ржУрзЯрж╛ parser-ржПрж░ .parse() ржорзЗржержб call рж╣рзЯред

- Parser raw stream (request.body) ржерзЗржХрзЗ data ржкрзЬрзЗ Python dict ржмрж╛ржирж╛рзЯред **6** - MultiPartParser ржХрзАржнрж╛ржмрзЗ
  internally ржХрж╛ржЬ ржХрж░рзЗ?

```python
class MultiPartParser(BaseParser):
    media_type = 'multipart/form-data'

    def parse(self, stream, media_type, parser_context):
        # 1. Parse the boundary from Content-Type header
        # 2. Use django.http.multipartparser.MultiPartParser
        #    to split form fields & files
        data, files = parser.parse()
        return DataAndFiles(data, files)

```

- ржПржЯрж╛ Django-ржПрж░ MultiPartParser (lower-level) ржХрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

- Boundary ржжрж┐рзЯрзЗ request body ржХрзЗржЯрзЗ form fields vs file parts ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗред

- Files ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗ UploadedFile ржЕржмржЬрзЗржХрзНржЯрзЗ рж░рж╛ржЦрзЗ, ржпрзЗржЯрж╛ ржкрж░рзЗ serializer ржкрж╛рзЯред

**7** ржХрзЛржерж╛рзЯ parser_classes ржжрж░ржХрж╛рж░?

- File upload (ImageField, FileField)

- HTML form POST/PUT/PATCH ржпрзЗржЯрж╛ JSON ржирзЯ

- Multiple content-type support (e.g., JSON + multipart ржПржХржЗ endpoint)

ЁЯУМ ржпржжрж┐ parser_classes ржирж╛ ржжрж╛ржУ тЖТ DRF JSONParser ржжрж┐рзЯрзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЗ тЖТ multipart parse ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ тЖТ
request.data ржлрж╛ржБржХрж╛ ржЖрж╕ржмрзЗред

#### ЁЯФН Visual flow diagram

```pgsql
 Client (multipart/form-data)
       |
       v
APIView.dispatch()
       |
       v
initialize_request()
       |
       v
get_parsers() -> [MultiPartParser(), FormParser()]
       |
       v
request.data ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж▓рзЗ:
       |
       +--> Content-Type check (multipart/form-data)
       |
       +--> MultiPartParser.parse()
                |
                +--> django.multipartparser
                |
                +--> data + files return
       |
       v
Serializer receives:
   data = {...}
   files = { 'file_field': UploadedFile(...) }

```

---

### 6) urls.py тАФ router + token endpoints

```python
# myapp/urls.py
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from .views import PhotoViewSet, PhotoUploadView
from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView

router = DefaultRouter()
router.register('photos', PhotoViewSet, basename='photos')

urlpatterns = [
    path('', include(router.urls)),
    path('upload/', PhotoUploadView.as_view(), name='photo-upload'),

    # JWT token endpoints
    path('token/', TokenObtainPairView.as_view(), name='token_obtain_pair'),
    path('token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
]
```

**ржХрзЗржи JWT endpoints?**

- Client ржкрзНрж░ржержорзЗ `/api/token/` ржП username/password ржжрж┐ржпрж╝рзЗ POST ржХрж░рзЗ Access + Refresh token ржкрж╛ржмрзЗред
- ржкрж░рзЗ ржкрзНрж░рждрзНржпрзЗржХрж┐ ржЕржирзБрж░рзЛржзрзЗ `Authorization: Bearer <access_token>` рж╣рзЗржбрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

---

### 7) Multiple files ржПржХрж╕рж╛ржерзЗ ржЖржкрж▓рзЛржб

**ржкрзНржпрж╛ржЯрж╛рж░рзНржи рзз тАФ separate model (recommended):**

- `Attachment` model рждрзИрж░рж┐ ржХрж░ ржпрзЗржЦрж╛ржирзЗ FileField ржерж╛ржХрзЗ ржПржмржВ parent model-ржПрж░ рж╕рж╛ржерзЗ ForeignKeyред
- Client `files[]` ржирж╛ржо ржжрж┐рзЯрзЗ multiple files ржкрж╛ржарж╛рзЯ; view ржП `request.FILES.getlist('files')` ржЗ ржмрзНржпржмрж╣рж╛рж░
  рж╣ржмрзЗред

```python
# view handling multiple files
files = request.FILES.getlist('files')
for f in files:
    MyAttachment.objects.create(parent=parent_obj, file=f, owner=request.user)
```

**ржкрзНржпрж╛ржЯрж╛рж░рзНржи рзи тАФ Serializer ListField (non-model):**

```python
class MultiUploadSerializer(serializers.Serializer):
    files = serializers.ListField(child=serializers.FileField())
```

---

### 8) Naming conflict (ржПржХрзЛржЗ ржирж╛ржо multiple uploads) тАФ ржХрзЗржи ржУ ржХрзАржнрж╛ржмрзЗ handle ржХрж░ржм

**рж╕ржорж╕рзНржпрж╛:** ржжрзБржЗржЬржи ржЗржЙржЬрж╛рж░ ржПржХржЗ ржирж╛ржорзЗрж░ ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржб ржХрж░рж▓рзЗ ржлрж╛ржЗрж▓ ржУржнрж╛рж░рж░рж╛ржЗржЯ ржмрж╛ ржХржиржлрзНрж▓рж┐ржХрзНржЯ рж╣рждрзЗ ржкрж╛рж░рзЗред

**рж╕ржорж╛ржзрж╛ржиржЧрзБрж▓рзЛ:**

1. **upload_to callable + uuid** (ржЖржорж░рж╛ ржЙржкрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржЫрж┐) тАФ рж╕ржмржЪрзЗрзЯрзЗ рж╕рж╣ржЬ ржУ рж╕рж╛ржзрж╛рж░ржг рж╕ржорж╛ржзрж╛ржиред
2. **custom storage** тАФ `DEFAULT_FILE_STORAGE` ржХрж╛рж╕рзНржЯржо ржХрж░рзЗ `get_available_name()` ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рж╛ред
3. **db-backed unique filename** тАФ ржлрж╛ржЗрж▓ ржирж╛ржо DB рждрзЗ рж╕рзНржЯрзЛрж░ ржХрж░рзЗ unique constraint ржкрзНрж░рзЯрзЛржЧ ржХрж░рзЗред

**ржХрзЗржи uuid ржнрж╛рж▓рзЛ:** ржирж╛ржо ржЗржЙржирж┐ржХ рж╣рзЯ, ржХржиржлрзНрж▓рж┐ржХрзНржЯ ржирзЗржЗ, рж╕рж╣ржЬрзЗ ржлрж╛ржЗрж▓ рж░рж┐ржЯрзНрж░рж╛ржЗржн ржХрж░рж╛ ржпрж╛рзЯред

---

### 9) ржирж┐рж░рж╛ржкрждрзНрждрж╛ (Security Checklist)

- **Pillow** ржжрж┐рзЯрзЗ image validation: `Image.open()` ржХрж░рзЗ verify() ржХрж░рждрзЗ ржкрж╛рж░рзЛ ржпрж╛рждрзЗ corrupted ржмрж╛
  non-image ржлрж╛ржЗрж▓ ржзрж░рж╛ ржпрж╛рзЯред
- **File size limit**: `validate_image_file` ржП ржЪрзЗржХ рж░рж╛ржЦрзЛ ржПржмржВ server/webserver (nginx) ржП limit ржХржиржлрж┐ржЧрж╛рж░
  ржХрж░рзЛред
- **Content-type ржУ magic-bytes ржЪрзЗржХ**: extension ржирзЯ, file signature ржЪрзЗржХ ржХрж░рзЛ (Pillow helps)ред
- **Serve media via CDN / protected domain**: sensitive files рж╣рж▓рзЗ S3 ржПрж░ presigned URLs ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ
  ржкрж╛рж░рзЛред
- **Don't store uploaded files inside STATIC_ROOT** тАФ separate MEDIA_ROOT ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред
- **Permissions**: media directory-рж░ permission ржарж┐ржХ рж░рж╛ржЦрзЛ ржпрж╛рждрзЗ public execution ржирж╛ рж╣рзЯ (e.g., .py ржлрж╛ржЗрж▓
  ржПржХрзНрж╕рж┐ржХрж┐ржЙрж╢ржи)ред

---

### 10) Common pitfalls & debugging

- `request.data` ржЦрж╛рж▓рж┐ ржЖрж╕рзЗ: ржнрзБрж▓ parser_classes (ржирж┐рж╢рзНржЪрж┐ржд ржХрж░ MultiPartParser ржЖржЫрзЗ)
- ImageField error: `PIL`/`Pillow` ржирж╛ржЗ тАФ `pip install Pillow`
- Serializer.data рждрзЗ URL ржирж╛ ржЖрж╕рзЗ: serializer context missing тАФ
  `serializer = Serializer(instance, context={'request': request})`
- 413 Request Entity Too Large: nginx/uwsgi/gunicorn ржПрж░ config adjust ржХрж░рзЛ (e.g.,
  `client_max_body_size`)
- Development-ржП image serve ржирж╛ рж╣рж▓рзЗ: `urlpatterns += static(...)` ржЖржЫрзЗ рждрзЛ? ржПржмржВ DEBUG=True?

---

### 11) Testing (Unit tests)

```python
from django.test import TestCase
from django.core.files.uploadedfile import SimpleUploadedFile

class UploadTest(TestCase):
    def test_upload(self):
        small_gif = (
            b'\x47\x49\x46\x38\x39\x61\x01\x00\x01\x00\x80\x00\x00\x00\x00\x00'
            b"\xff\xff\xff\x21\xf9\x04\x00\x00\x00\x00\x00\x2c\x00\x00\x00\x00\x01\x00"
            b"\x01\x00\x00\x02\x02\x4c\x01\x00\x3b"
        )
        uploaded = SimpleUploadedFile('small.gif', small_gif, content_type='image/gif')
        resp = self.client.post('/api/upload/', {'title': 't', 'image': uploaded})
        self.assertEqual(resp.status_code, 201)
```

---

### 12) Advanced: S3 (django-storages) рж╕ржВржХрзНрж╖рзЗржкрзЗ

**ржХрждржЯрж╛ ржнрж┐ржирзНржи:** local filesystem ржмрж╛ржж ржжрж┐рзЯрзЗ `DEFAULT_FILE_STORAGE` S3 backend ржХрж░рж▓рзЗ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ S3 ржП ржпрж╛ржмрзЗред

**settings (рж╕ржВржХрзНрж╖рзЗржкрзЗ):**

```python
# install: pip install django-storages boto3
INSTALLED_APPS += ['storages']
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'
AWS_ACCESS_KEY_ID = '...'
AWS_SECRET_ACCESS_KEY = '...'
AWS_STORAGE_BUCKET_NAME = 'your-bucket'
AWS_S3_REGION_NAME = 'ap-south-1'
```

**ржкрзНрж░рж╛рзЯ рж╕ржм рж▓ржЬрж┐ржХ ржПржХржЗ ржерж╛ржХрзЗ** тАФ ржХрж┐ржирзНрждрзБ рждрзБржорж┐ `upload_to` ржжрж┐рзЯрзЗ path ржмрж╛ржирж╛рждрзЗ ржкрж╛рж░рзЛ, ржПржмржВ filename conflict ржЖрж░
local FS ржирж┐рзЯрзЗ ржнрж╛ржмрждрзЗ рж╣ржмрзЗ ржирж╛ (S3 auto-unique path/keys)ред

---

### 13) рж╕рж╣ржЬрзЗ ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп Cheatsheet (Revision-ready checklist)

- [ ] `MEDIA_ROOT` ржУ `MEDIA_URL` рж╕рзЗржЯ ржХрж░рж╛ ржЖржЫрзЗ?
- [ ] `Pillow` ржЗржирж╕рзНржЯрж▓ ржХрж░рж╛ ржЖржЫрзЗ?
- [ ] Model ржП `ImageField(upload_to=...)` тАФ uuid ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ conflict ржирзЗржЗ
- [ ] Serializer ржП `validate_image()` ржЖржЫрзЗ? file size + content_type ржЪрзЗржХ ржХрж░
- [ ] View-ржП `parser_classes = [MultiPartParser, FormParser]` ржЖржЫрзЗ?
- [ ] Serializer ржП `context={'request': request}` ржкрж╛рж╕ ржХрж░рж▓рзЗ image URL ржХрж╛ржЬ ржХрж░ржмрзЗ
- [ ] JWT: token endpoints ржпрзБржХрзНржд ржЖржЫрзЗ? `Authorization: Bearer <token>` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ
- [ ] Nginx / production: `client_max_body_size` & media serving ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рж╛ ржЖржЫрзЗ

---

### 14) ржЫрзЛржЯрзНржЯ ржХрж╛ржЬрзЗрж░ ржкрзНрж░ржмрж╛рж╣ (Process diagram тАФ ASCII)

```
Client (app/browser)
   тФФтФА POST /api/token/ (username/password) -> access_token
   тФФтФА POST /api/upload/ (multipart/form-data + Authorization: Bearer <token>)
        -> DRF View (MultiPartParser)
             -> Serializer (validate_image -> create)
                 -> Model.save() -> Storage (local/S3)
                     -> DB ржП рж░рзЗржХрж░рзНржб
        <- Response: serialized data (image URL)
```

---

### 15) ржЕрждрж┐рж░рж┐ржХрзНржд ржЯрж┐ржкрж╕ ржУ ржмрзЗрж╕рзНржЯ-ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕

- `upload_to` callable ржжрж┐рзЯрзЗ ржлрж╛ржЗрж▓рзЗрж░ ржирж╛ржо ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рзЛ (uuid + date). ржПржЯрж╛ рж╕ржмржЪрзЗрзЯрзЗ рж╕рж╣ржЬ ржУ ржирж┐рж░рж╛ржкржжред
- sensitive/files рж╣рж▓рзЗ public URL ржжрзЗржУрзЯрж╛рж░ ржЖржЧрзЗ permission ржЪрзЗржХ ржХрж░рзЛ тАФ ржкрзНрж░рзЯрзЛржЬржирзЗ presigned URL ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред
- production ржП media serve ржХрж░рж╛рж░ ржжрж╛рзЯрж┐рждрзНржм ржУрзЯрзЗржм рж╕рж╛рж░рзНржнрж╛рж░/ CDN ржХрзЗ ржжрж╛ржУ; Django рж╢рзБржзрзБржЗ ржЕрзНржпрж╛ржк рж▓ржЬрж┐ржХрзЗрж░ ржЬржирзНржп
  ржерж╛ржХржмрзЗред
- large file uploads рж╣рж▓рзЗ resumable upload (tus, chunk uploads) consider ржХрж░рзЛ; ржирзЯрждрзЛ nginx/gunicorn
  timeout рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗред

---

## тЬЕDay 23: Nested Serializer

### 1. **Nested Serializer ржХрзА?**

- **Definition:** DRF-ржП Nested Serializer ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ, ржПржХржЯрж┐ Serializer-ржПрж░ ржоржзрзНржпрзЗ ржЖрж░рзЗржХржЯрж┐ Serializer
  ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ред
- **Purpose:** ржпржЦржи Model-ржПрж░ ржоржзрзНржпрзЗ ForeignKey / OneToMany / ManyToMany Relation ржерж╛ржХрзЗ, рждржЦржи related
  data ржПржХрж╕рж╛ржерзЗ serialize ржХрж░рж╛рж░ ржЬржирзНржп nested serializer ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред

---

### 2. **Example Scenario**

**User тЖТ Orders тЖТ Food**

- **User Model**: ржЗржЙржЬрж╛рж░рзЗрж░ рж╕рж╛ржзрж╛рж░ржг рждржерзНржп
- **Order Model**: ржХрзЛржи ржЗржЙржЬрж╛рж░ ржХрзЛржи ржЕрж░рзНржбрж╛рж░ ржжрж┐рзЯрзЗржЫрзЗ
- **Food Model**: ржЕрж░рзНржбрж╛рж░рзЗрж░ ржоржзрзНржпрзЗ ржХрзЛржи ржХрзЛржи ржЦрж╛ржмрж╛рж░ ржЖржЫрзЗ

Relation:

```
User 1 -----> Many Orders -----> Each Order has Many Foods
```

---

#### 3. **Models**

```python
# models.py
from django.db import models

class User(models.Model):
    name = models.CharField(max_length=100)
    email = models.EmailField(unique=True)

class Food(models.Model):
    name = models.CharField(max_length=100)
    price = models.DecimalField(max_digits=6, decimal_places=2)

class Order(models.Model):
    user = models.ForeignKey(User, related_name='orders', on_delete=models.CASCADE)
    foods = models.ManyToManyField(Food, related_name='orders')
    created_at = models.DateTimeField(auto_now_add=True)
```

ЁЯТб **Why related_name ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рж╛ржо?**

- related_name ржжрж┐рзЯрзЗ reverse relation рж╕рж╣ржЬ рж╣рзЯред
- ржирж╛ ржжрж┐рж▓рзЗ `user.order_set.all()` ржПрж░ ржорждрзЛ ржбрж┐ржлрж▓рзНржЯ ржирж╛ржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣рждрзЛред
- related_name ржжрж┐рж▓рзЗ `user.orders.all()` ржПрж░ ржорждрзЛ readable рж╣рзЯред

---

### 4. **Serializers**

```python
# serializers.py
from rest_framework import serializers
from .models import User, Order, Food

class FoodSerializer(serializers.ModelSerializer):
    class Meta:
        model = Food
        fields = ['id', 'name', 'price']

class OrderSerializer(serializers.ModelSerializer):
    foods = FoodSerializer(many=True)  # Nested serializer
    class Meta:
        model = Order
        fields = ['id', 'created_at', 'foods']

class UserSerializer(serializers.ModelSerializer):
    orders = OrderSerializer(many=True)  # Nested serializer
    class Meta:
        model = User
        fields = ['id', 'name', 'email', 'orders']
```

ЁЯТб **Why Nested Serializer?**

- ржпржжрж┐ рж╢рзБржзрзБ `OrderSerializer` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрж╛ржо, рждржмрзЗ foods ржПрж░ ржнрзЗрждрж░рзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ id ржЖрж╕рждред Nested ржжрж┐рзЯрзЗ
  foods-ржПрж░ ржмрж┐рж╕рзНрждрж╛рж░рж┐рждржУ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯред
- ржирж╛ ржжрж┐рж▓рзЗ related data ржкрзЗрждрзЗ ржЖрж▓рж╛ржжрж╛ query рж▓рж╛ржЧржд (extra API call)ред

---

### 5. **Views**

```python
# views.py
from rest_framework.response import Response
from rest_framework.views import APIView
from .models import User
from .serializers import UserSerializer

class UserOrdersView(APIView):
    def get(self, request):
        users = User.objects.all()
        serializer = UserSerializer(users, many=True)
        return Response(serializer.data)
```

---

### 6. **Output Example**

```json
[
  {
    "id": 1,
    "name": "Mostakin",
    "email": "mostakin@example.com",
    "orders": [
      {
        "id": 10,
        "created_at": "2025-08-11T12:30:00Z",
        "foods": [
          { "id": 1, "name": "Pizza", "price": "500.00" },
          { "id": 2, "name": "Burger", "price": "250.00" }
        ]
      }
    ]
  }
]
```

---

### 7. **Important Notes**

- **read_only=True** ржжрж┐рж▓рзЗ nested data ржХрзЗржмрж▓ ржжрзЗржЦрж╛ржмрзЗ, create/update рж╣ржмрзЗ ржирж╛ред
- **many=True** ржмрж▓рждрзЗ ржмрзЛржЭрж╛рзЯ multiple related objectsред
- Nested Serializer heavy data рж╣рж▓рзЗ performance slow рж╣рждрзЗ ржкрж╛рж░рзЗ тАФ рждржЦржи `select_related` /
  `prefetch_related` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржЙржЪрж┐рждред

---
